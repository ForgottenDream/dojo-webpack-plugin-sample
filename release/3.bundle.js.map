{"version":3,"sources":["webpack:///3.bundle.js","webpack:///C:/Users/Chuck/git/dijit/Editor.js","webpack:///C:/Users/Chuck/git/dijit/Toolbar.js","webpack:///C:/Users/Chuck/git/dijit/ToolbarSeparator.js","webpack:///C:/Users/Chuck/git/dijit/_editor/_Plugin.js","webpack:///C:/Users/Chuck/git/dijit/_editor/plugins/EnterKeyHandling.js","webpack:///C:/Users/Chuck/git/dijit/_editor/RichText.js","webpack:///C:/Users/Chuck/git/dojo/_base/unload.js","webpack:///C:/Users/Chuck/git/dijit/selection.js","webpack:///C:/Users/Chuck/git/dijit/_editor/range.js","webpack:///C:/Users/Chuck/git/dijit/_editor/html.js","webpack:///C:/Users/Chuck/git/dijit/_editor/nls/commands.js?3bed","webpack:///C:/Users/Chuck/git/dijit/_editor/nls/commands.js"],"names":["webpackJsonp","registerAbsMids","dijit/Editor","dijit/Toolbar","dijit/ToolbarSeparator","dijit/_editor/_Plugin","dijit/_editor/plugins/EnterKeyHandling","dijit/_editor/RichText","dojo/_base/unload","dijit/selection","dijit/_editor/range","dijit/_editor/html","dojo/i18n!dijit/_editor/nls/commands","dijit/_editor/nls/commands","149","module","exports","__webpack_require__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","dj","c","require","array","declare","Deferred","i18n","domAttr","domClass","domGeometry","domStyle","keys","lang","has","string","topic","_Container","Toolbar","ToolbarSeparator","_LayoutWidget","ToggleButton","_Plugin","EnterKeyHandling","html","rangeapi","RichText","dijit","simplePluginFactory","args","command","name","togglePluginFactory","buttonClass","Editor","plugins","extraPlugins","constructor","isArray","this","_plugins","_editInterval","editActionInterval","events","push","postMixInProperties","setValueDeferred","inherited","arguments","postCreate","_steps","slice","_undoedSteps","concat","commands","getLocalization","set","domNode","startup","toolbar","ownerDocument","dir","aria-label","id","header","appendChild","forEach","addPlugin","resolve","add","iframe","parentNode","onNormalizedDisplayChanged","destroy","p","destroyRecursive","plugin","index","isString","isFunction","ctor","setEditor","o","editor","registry","publish","_scopeName","pc","getObject","e","Error","length","setToolbar","resize","size","prototype","apply","layout","areaHeight","_contentBox","h","getHeaderHeight","getFooterHeight","getPadBorderExtents","getMarginExtents","editingArea","style","height","_layoutMode","_onIEMouseDown","outsideClientArea","b","document","body","clientWidth","clientHeight","clientLeft","offsetWidth","offsetHeight","offsetLeft","test","x","y","_cursorToStart","_savedSelection","target","tagName","defer","onBeforeActivate","_restoreSelection","onBeforeDeactivate","customUndo","endEditing","_saveSelection","beginEditing","cmd","_inEditing","_beginEditing","_editTimer","remove","execCommand","r","_endEditing","_pasteImpl","_clipboardCommand","_cutImpl","_copyImpl","code","sub","substitute","accel","cut","copy","paste","alert","systemShortcut","queryCommandEnabled","_moveToBookmark","sNode","eNode","sel","bookmark","mark","col","isCollapsed","n","getNode","editNode","selection","moveToBookmark","startContainer","endContainer","getSelection","window","removeAllRanges","create","setStart","startOffset","setEnd","endOffset","addRange","_changeToStep","from","to","setValue","text","undo","ret","_undoRedoActive","s","pop","focus","onDisplayChanged","redo","ignore_caret","_getBookmark","getBookmark","tmp","getIndex","range","rangeCount","getRangeAt","cloneRange","getChildrenHtml","v","onKeyDown","keyCode","TAB","tabIndent","k","ctrlKey","shiftKey","altKey","stopPropagation","preventDefault","ENTER","BACKSPACE","DELETE","metaKey","F1","F15","ALT","UP_ARROW","DOWN_ARROW","LEFT_ARROW","RIGHT_ARROW","HOME","END","PAGE_UP","PAGE_DOWN","CTRL","SHIFT","_onBlur","onClick","replaceValue","isClosed","_setDisabledAttr","value","then","hitch","disabled","_buttonEnabledPlugins","_setStateClass","get","mixin","insertOrderedList","insertUnorderedList","indent","outdent","justifyCenter","justifyFull","justifyLeft","justifyRight","delete","selectAll","removeFormat","unlink","insertHorizontalRule","bold","italic","underline","strikethrough","subscript","superscript","|","button","undefined","150","ready","_Widget","_KeyNavContainer","_TemplatedMixin","requires","templateString","baseClass","_onLeftArrow","focusPrev","_onRightArrow","focusNext","151","dom","buildRendering","setSelectable","isFocusable","152","connect","Destroyable","Button","params","_attrPairNames","iconClassPrefix","useDefaultCommand","getLabel","key","_initButton","label","className","charAt","toUpperCase","substr","props","showLabel","iconClass","dropDown","tabIndex","f","tf","own","updateState","checked","enabled","isLoaded","queryCommandState","console","log","queryCommandAvailable","on","commandArg","display","addChild","names","_getAttrNames","result","Array","call","_set","g","apn","uc","153","domConstruct","win","winUtils","blockNodeForEnter","onLoadDeferred","d","ne","handleEnterKey","setTimeout","createRange","move","select","addKeyHandler","onKeyPressed","_checkListLater","liparent","getAncestorElement","nodeName","fc","firstChild","nodeType","insertBefore","createTextNode","newrange","block","innerHTML","bogusHtmlContent","error","_pressedEnterInBlock","previousSibling","removeTrailingBr","blockNodes","startNode","endNode","brNode","br","rs","txt","doc","parent","getParentElement","getAncestor","collapsed","deleteContents","atBeginningOfContainer","createElement","setStartAfter","atEndOfContainer","nodeValue","substring","place","lastChild","offset","_adjustNodeAndOffset","node","collapse","targetNode","childNodes","_letBrowserHandle","getBlockAncestor","blockNode","e2","blockContainer","textContent","replace","newblock","scrollIntoView","nextSibling","cssText","firstNodeMoved","nodeToMove","tNode","parentC","tg","newTg","color","face","nodeForCursor","innerMostFirstNodeMoved","container","para","getParentOfType","154","config","kernel","query","domReady","unload","_Url","_CssStateMixin","selectionapi","htmlapi","contentPreFilters","contentPostFilters","contentDomPreFilters","contentDomPostFilters","editingAreaStyleSheets","_keyHandlers","inheritWidth","focusOnLoad","styleSheets","minHeight","_SEPARATOR","_NAME_CONTENT_SEP","isTabIndent","disableSpellCheck","toLowerCase","warn","trim","_normalizeFontStyle","_removeMozBogus","_removeWebkitBogus","open","setupDefaultShortcuts","exec","arg","ctrlKeyHandlers","i","u","a","save","m","1","2","3","4","\\","Z","captureEvents","_editorCommandsLocalized","_localizeEditorCommands","_local2NativeFormatNames","_native2LocalFormatNames","format","formats","localhtml","position","top","zIndex","opacity","div","ownerDocumentBody","inject","selectElement","nativename","queryCommandValue","element","fired","close","dn","ta","textarea","setAttribute","removeAttribute","tmpFunc","__overflow","overflow","form","resetValue","reset","current","getValue","footer","saveTextarea","byId","dat","datas","split","data","splice","join","_globalSaveHandler","addOnUnload","ifr","editorObject","border","width","frameBorder","_loadFunc","w","SelectionManager","onLoad","src","_getIframeDocTxt","domain","marginTop","_cs","getComputedStyle","font","fontWeight","fontSize","fontFamily","lineHeight","indexOf","parseFloat","userStyle","self","match","sC","title","isLeftToRight","_applyEditingAreaStyleSheets","files","url","ownerWindow","abstring","location","toString","addStyleSheet","uri","host","createStyleSheet","head","getElementsByTagName","stylesheet","rel","type","href","removeStyleSheet","orphan","_mozSettingProps","styleWithCSS","preventIEfocus","unselectable","contentEditable","ps","hasOwnProperty","_disabledOK","__registeredWindow","_iframeRegHandle","registerIframe","_this","beforeIframeNode","afterIframeNode","onfocus","focusNode","ap","map","item","zoom","_webkitListener","t","setContent","isFulfilled","updateInterval","META","scrollHeight","handlers","some","shift","ctrl","handler","onKeyUp","setDisabled","deprecated","_setValueAttr","_setDisableSpellCheckAttr","charCodeAt","focused","curNode","newValue","onChange","_onFocus","blur","documentElement","fireEvent","createEventObject","_updateTimer","_normalizeCommand","argument","_qcaCache","ca","_queryCommandAvailable","isSupportedBy","browsers","ie","Boolean","mozilla","webkit","opera","supportedBy","returnValue","implFunc","_browserQueryCommandEnabled","oldValue","_sCall","placeCursorAtStart","isvalid","first","selectElementChildren","placeCursorAtEnd","last","nonDestructive","_postFilterContent","_getValueAttr","_preFilterContent","_preDomFilterContent","ec","ef","clone","_saveContent","escapeXml","str","noSingleQuotes","getNodeHtml","getNodeChildrenHtml","interval","clearInterval","left","_frameElement","_preFixUrlAttributes","elem","_createlinkEnabledImpl","_unlinkEnabledImpl","hasAncestorElement","_inserttableEnabledImpl","_cutEnabledImpl","_copyEnabledImpl","_pasteEnabledImpl","_inserthorizontalruleImpl","_inserthtmlImpl","_unlinkImpl","_hilitecolorImpl","isApplied","_handleTextColorOrProperties","_backcolorImpl","_forecolorImpl","rv","insertRange","outerHTML","pasteHTML","lastNode","createDocumentFragment","insertNode","_boldImpl","applied","_adaptIESelection","_adaptIEFormatAreaAndExec","_italicImpl","_underlineImpl","_strikethroughImpl","_superscriptImpl","_subscriptImpl","_fontnameImpl","_fontsizeImpl","_insertorderedlistImpl","_adaptIEList","_insertunorderedlistImpl","_getNodeChildrenHeight","_isNodeEmpty","_removeStartingRangeFromRange","firstNode","breaker","nNames","_tagNamesForCommand","fs","topNode","tName","endText","tagData","tagList","newContTag","newTgNode","sc","lType","list","li","extraSpan","removeChild","_stripBreakerNodes","_stripTrailingEmptyNodes","isEmpty","children","innerText","_setTextDirAttr","155","dojo","addOnWindowUnload","obj","functionName","windowUnloaded","156","baseWindow","getType","oSel","stype","oRange","getSelectedText","getSelectedHtml","frag","cloneContents","htmlText","getSelectedElement","anchorNode","anchorOffset","parentElement","isTag","tags","_nlc","_tlc","String","beginning","collapseToStart","collapseToEnd","deleteFromDocument","clear","nochangefocus","selectAllChildren","createTextRange","moveToElementText","selectNode","createControlRange","addElement","inSelection","newRange","compareBoundaryPoints","START_TO_END","compareEndPoints","bm","rg","cf","start","selectionStart","end","selectionEnd","pRange","len","157","pnode","retR","onode","unshift","every","getCommonAncestor","n1","n2","root","getAncestors","as","n1as","n2as","Math","min","com","regex","BlockTagNames","atBeginning","offsetAtBeginning","cnode","atEnd","offsetAtEnd","adjacentNoneTextNode","startnode","next","prop","W3CRange","ignoreUpdate","_getCurrentSelection","cachedSelection","_ranges","internal","_select","_initCurrentRange","decomposeControlRange","decomposeTextRange","firstnode","lastnode","getEndPoint","atmrange","duplicate","cmpstr","calOffset","prevnode","prevnodeobj","lenoffset","setEndPoint","nextnode","tempNode","tmpary","setRange","commonAncestorContainer","_updateInternal","parseInt","_cachedBookmark","_setPoint","setStartBefore","setEndAfter","setEndBefore","what","ext","_getIERange","_body","detach","setObject","158","escape","output","getNodeHtmlHelper","lName","attr","attrarray","attrhash","attributes","specified","getAttribute","cloneNode","rgxp_attrsMatch","attrSplit","idx","val","sort","j","hasChildNodes","getChildrenHtmlHelper","nodes","checkParent","159","160","createLink","toggleDir","insertImage","insertTable","toggleTableBorder","deleteTable","tableProp","htmlToggle","foreColor","hiliteColor","plainFormatBlock","formatBlock","fontName","fullScreen","viewSource","print","newPage","appleKey","zh","zh-tw","uk","tr","th","sv","sl","sk","ru","ro","pt","pt-pt","pl","nl","nb","ko","kk","ja","it","hu","hr","he","fr","fi","es","el","de","da","cs","bg","az","ar"],"mappings":"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","file":"3.bundle.js","sourcesContent":["webpackJsonp.registerAbsMids({\n\t'dijit/Editor':149,\n\t'dijit/Toolbar':150,\n\t'dijit/ToolbarSeparator':151,\n\t'dijit/_editor/_Plugin':152,\n\t'dijit/_editor/plugins/EnterKeyHandling':153,\n\t'dijit/_editor/RichText':154,\n\t'dojo/_base/unload':155,\n\t'dijit/selection':156,\n\t'dijit/_editor/range':157,\n\t'dijit/_editor/html':158,\n\t'dojo/i18n!dijit/_editor/nls/commands':159,\n\t'dijit/_editor/nls/commands':160\n});\nwebpackJsonp([3],{\n\n/***/ 149:\n/*!******************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/Editor.js ***!\n  \\******************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__.dj.c(/*! dijit/Editor */ 149),\n\t\t__webpack_require__(/*! dojo/_base/array */ 13), // array.forEach\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/Deferred */ 18), // Deferred\n\t\t__webpack_require__(/*! dojo/i18n */ 97), // i18n.getLocalization\n\t\t__webpack_require__(/*! dojo/dom-attr */ 40), // domAttr.set\n\t\t__webpack_require__(/*! dojo/dom-class */ 35), // domClass.add\n\t\t__webpack_require__(/*! dojo/dom-geometry */ 36),\n\t\t__webpack_require__(/*! dojo/dom-style */ 37), // domStyle.set, get\n\t\t__webpack_require__(/*! dojo/keys */ 47), // keys.F1 keys.F15 keys.TAB\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9), // lang.getObject lang.hitch\n\t\t__webpack_require__(/*! dojo/sniff */ 10), // has(\"ie\") has(\"mac\") has(\"webkit\")\n\t\t__webpack_require__(/*! dojo/string */ 84), // string.substitute\n\t\t__webpack_require__(/*! dojo/topic */ 43), // topic.publish()\n\t\t__webpack_require__(/*! ./_Container */ 68),\n\t\t__webpack_require__(/*! ./Toolbar */ 150),\n\t\t__webpack_require__(/*! ./ToolbarSeparator */ 151),\n\t\t__webpack_require__(/*! ./layout/_LayoutWidget */ 56),\n\t\t__webpack_require__(/*! ./form/ToggleButton */ 89),\n\t\t__webpack_require__(/*! ./_editor/_Plugin */ 152),\n\t\t__webpack_require__(/*! ./_editor/plugins/EnterKeyHandling */ 153),\n\t\t__webpack_require__(/*! ./_editor/html */ 158),\n\t\t__webpack_require__(/*! ./_editor/range */ 157),\n\t\t__webpack_require__(/*! ./_editor/RichText */ 154),\n\t\t__webpack_require__(/*! ./main */ 51), // dijit._scopeName\n\t\t__webpack_require__(/*! dojo/i18n!./_editor/nls/commands */ 159)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(require, array, declare, Deferred, i18n, domAttr, domClass, domGeometry, domStyle,\n\t\t\t\tkeys, lang, has, string, topic,\n\t\t\t\t_Container, Toolbar, ToolbarSeparator, _LayoutWidget, ToggleButton,\n\t\t\t\t_Plugin, EnterKeyHandling, html, rangeapi, RichText, dijit){\n\t\n\t\t// module:\n\t\t//\t\tdijit/Editor\n\t\n\t\tvar Editor = declare(\"dijit.Editor\", RichText, {\n\t\t\t// summary:\n\t\t\t//\t\tA rich text Editing widget\n\t\t\t//\n\t\t\t// description:\n\t\t\t//\t\tThis widget provides basic WYSIWYG editing features, based on the browser's\n\t\t\t//\t\tunderlying rich text editing capability, accompanied by a toolbar (`dijit.Toolbar`).\n\t\t\t//\t\tA plugin model is available to extend the editor's capabilities as well as the\n\t\t\t//\t\tthe options available in the toolbar.  Content generation may vary across\n\t\t\t//\t\tbrowsers, and clipboard operations may have different results, to name\n\t\t\t//\t\ta few limitations.  Note: this widget should not be used with the HTML\n\t\t\t//\t\t&lt;TEXTAREA&gt; tag -- see dijit/_editor/RichText for details.\n\t\n\t\t\t// plugins: [const] Object[]\n\t\t\t//\t\tA list of plugin names (as strings) or instances (as objects)\n\t\t\t//\t\tfor this widget.\n\t\t\t//\n\t\t\t//\t\tWhen declared in markup, it might look like:\n\t\t\t//\t|\tplugins=\"['bold',{name:'dijit._editor.plugins.FontChoice', command:'fontName', generic:true}]\"\n\t\t\tplugins: null,\n\t\n\t\t\t// extraPlugins: [const] Object[]\n\t\t\t//\t\tA list of extra plugin names which will be appended to plugins array\n\t\t\textraPlugins: null,\n\t\n\t\t\tconstructor: function(/*===== params, srcNodeRef =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCreate the widget.\n\t\t\t\t// params: Object|null\n\t\t\t\t//\t\tInitial settings for any of the attributes, except readonly attributes.\n\t\t\t\t// srcNodeRef: DOMNode\n\t\t\t\t//\t\tThe editor replaces the specified DOMNode.\n\t\n\t\t\t\tif(!lang.isArray(this.plugins)){\n\t\t\t\t\tthis.plugins = [\"undo\", \"redo\", \"|\", \"cut\", \"copy\", \"paste\", \"|\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"|\",\n\t\t\t\t\t\t\"insertOrderedList\", \"insertUnorderedList\", \"indent\", \"outdent\", \"|\", \"justifyLeft\", \"justifyRight\", \"justifyCenter\", \"justifyFull\",\n\t\t\t\t\t\tEnterKeyHandling /*, \"createLink\"*/];\n\t\t\t\t}\n\t\n\t\t\t\tthis._plugins = [];\n\t\t\t\tthis._editInterval = this.editActionInterval * 1000;\n\t\n\t\t\t\t//IE will always lose focus when other element gets focus, while for FF and safari,\n\t\t\t\t//when no iframe is used, focus will be lost whenever another element gets focus.\n\t\t\t\t//For IE, we can connect to onBeforeDeactivate, which will be called right before\n\t\t\t\t//the focus is lost, so we can obtain the selected range. For other browsers,\n\t\t\t\t//no equivalent of onBeforeDeactivate, so we need to do two things to make sure\n\t\t\t\t//selection is properly saved before focus is lost: 1) when user clicks another\n\t\t\t\t//element in the page, in which case we listen to mousedown on the entire page and\n\t\t\t\t//see whether user clicks out of a focus editor, if so, save selection (focus will\n\t\t\t\t//only lost after onmousedown event is fired, so we can obtain correct caret pos.)\n\t\t\t\t//2) when user tabs away from the editor, which is handled in onKeyDown below.\n\t\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\t\tthis.events.push(\"onBeforeDeactivate\");\n\t\t\t\t\tthis.events.push(\"onBeforeActivate\");\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tpostMixInProperties: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\tExtension to make sure a deferred is in place before certain functions\n\t\t\t\t//\texecute, like making sure all the plugins are properly inserted.\n\t\n\t\t\t\t// Set up a deferred so that the value isn't applied to the editor\n\t\t\t\t// until all the plugins load, needed to avoid timing condition\n\t\t\t\t// reported in #10537.\n\t\t\t\tthis.setValueDeferred = new Deferred();\n\t\t\t\tthis.inherited(arguments);\n\t\t\t},\n\t\n\t\t\tpostCreate: function(){\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\t//for custom undo/redo, if enabled.\n\t\t\t\tthis._steps = this._steps.slice(0);\n\t\t\t\tthis._undoedSteps = this._undoedSteps.slice(0);\n\t\n\t\t\t\tif(lang.isArray(this.extraPlugins)){\n\t\t\t\t\tthis.plugins = this.plugins.concat(this.extraPlugins);\n\t\t\t\t}\n\t\n\t\t\t\tthis.commands = i18n.getLocalization(\"dijit._editor\", \"commands\", this.lang);\n\t\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t// Disable selecting the entire editor by inadvertent double-clicks.\n\t\t\t\t\t// on buttons, title bar, etc.  Otherwise clicking too fast on\n\t\t\t\t\t// a button such as undo/redo selects the entire editor.\n\t\t\t\t\tdomStyle.set(this.domNode, \"KhtmlUserSelect\", \"none\");\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tstartup: function(){\n\t\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\tif(!this.toolbar){\n\t\t\t\t\t// if we haven't been assigned a toolbar, create one\n\t\t\t\t\tthis.toolbar = new Toolbar({\n\t\t\t\t\t\townerDocument: this.ownerDocument,\n\t\t\t\t\t\tdir: this.dir,\n\t\t\t\t\t\tlang: this.lang,\n\t\t\t\t\t\t\"aria-label\": this.id\n\t\t\t\t\t});\n\t\t\t\t\tthis.header.appendChild(this.toolbar.domNode);\n\t\t\t\t}\n\t\n\t\t\t\tarray.forEach(this.plugins, this.addPlugin, this);\n\t\n\t\t\t\t// Okay, denote the value can now be set.\n\t\t\t\tthis.setValueDeferred.resolve(true);\n\t\n\t\t\t\tdomClass.add(this.iframe.parentNode, \"dijitEditorIFrameContainer\");\n\t\t\t\tdomClass.add(this.iframe, \"dijitEditorIFrame\");\n\t\t\t\tdomAttr.set(this.iframe, \"allowTransparency\", true);\n\t\n\t\t\t\tthis.toolbar.startup();\n\t\t\t\tthis.onNormalizedDisplayChanged(); //update toolbar button status\n\t\t\t},\n\t\n\t\t\tdestroy: function(){\n\t\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\t\tif(p && p.destroy){\n\t\t\t\t\t\tp.destroy();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._plugins = [];\n\t\t\t\tthis.toolbar.destroyRecursive();\n\t\t\t\tdelete this.toolbar;\n\t\t\t\tthis.inherited(arguments);\n\t\t\t},\n\t\t\taddPlugin: function(/*String||Object||Function*/ plugin, /*Integer?*/ index){\n\t\t\t\t// summary:\n\t\t\t\t//\t\ttakes a plugin name as a string or a plugin instance and\n\t\t\t\t//\t\tadds it to the toolbar and associates it with this editor\n\t\t\t\t//\t\tinstance. The resulting plugin is added to the Editor's\n\t\t\t\t//\t\tplugins array. If index is passed, it's placed in the plugins\n\t\t\t\t//\t\tarray at that index. No big magic, but a nice helper for\n\t\t\t\t//\t\tpassing in plugin names via markup.\n\t\t\t\t// plugin:\n\t\t\t\t//\t\tString, args object, plugin instance, or plugin constructor\n\t\t\t\t// args:\n\t\t\t\t//\t\tThis object will be passed to the plugin constructor\n\t\t\t\t// index:\n\t\t\t\t//\t\tUsed when creating an instance from\n\t\t\t\t//\t\tsomething already in this.plugins. Ensures that the new\n\t\t\t\t//\t\tinstance is assigned to this.plugins at that index.\n\t\t\t\tvar args = lang.isString(plugin) ? {name: plugin} : lang.isFunction(plugin) ? {ctor: plugin} : plugin;\n\t\t\t\tif(!args.setEditor){\n\t\t\t\t\tvar o = {\"args\": args, \"plugin\": null, \"editor\": this};\n\t\t\t\t\tif(args.name){\n\t\t\t\t\t\t// search registry for a plugin factory matching args.name, if it's not there then\n\t\t\t\t\t\t// fallback to 1.0 API:\n\t\t\t\t\t\t// ask all loaded plugin modules to fill in o.plugin if they can (ie, if they implement args.name)\n\t\t\t\t\t\t// remove fallback for 2.0.\n\t\t\t\t\t\tif(_Plugin.registry[args.name]){\n\t\t\t\t\t\t\to.plugin = _Plugin.registry[args.name](args);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttopic.publish(dijit._scopeName + \".Editor.getPlugin\", o);\t// publish\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!o.plugin){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t// TODO: remove lang.getObject() call in 2.0\n\t\t\t\t\t\t\tvar pc = args.ctor || lang.getObject(args.name) || require(args.name);\n\t\t\t\t\t\t\tif(pc){\n\t\t\t\t\t\t\t\to.plugin = new pc(args);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tthrow new Error(this.id + \": cannot find plugin [\" + args.name + \"]\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!o.plugin){\n\t\t\t\t\t\tthrow new Error(this.id + \": cannot find plugin [\" + args.name + \"]\");\n\t\t\t\t\t}\n\t\t\t\t\tplugin = o.plugin;\n\t\t\t\t}\n\t\t\t\tif(arguments.length > 1){\n\t\t\t\t\tthis._plugins[index] = plugin;\n\t\t\t\t}else{\n\t\t\t\t\tthis._plugins.push(plugin);\n\t\t\t\t}\n\t\t\t\tplugin.setEditor(this);\n\t\t\t\tif(lang.isFunction(plugin.setToolbar)){\n\t\t\t\t\tplugin.setToolbar(this.toolbar);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t//the following 2 functions are required to make the editor play nice under a layout widget, see #4070\n\t\n\t\t\tresize: function(size){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tResize the editor to the specified size, see `dijit/layout/_LayoutWidget.resize()`\n\t\t\t\tif(size){\n\t\t\t\t\t// we've been given a height/width for the entire editor (toolbar + contents), calls layout()\n\t\t\t\t\t// to split the allocated size between the toolbar and the contents\n\t\t\t\t\t_LayoutWidget.prototype.resize.apply(this, arguments);\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\t else{\n\t\t\t\t // do nothing, the editor is already laid out correctly.   The user has probably specified\n\t\t\t\t // the height parameter, which was used to set a size on the iframe\n\t\t\t\t }\n\t\t\t\t */\n\t\t\t},\n\t\t\tlayout: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled from `dijit/layout/_LayoutWidget.resize()`.  This shouldn't be called directly\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\t// Converts the iframe (or rather the <div> surrounding it) to take all the available space\n\t\t\t\t// except what's needed for the header (toolbars) and footer (breadcrumbs, etc).\n\t\t\t\t// A class was added to the iframe container and some themes style it, so we have to\n\t\t\t\t// calc off the added margins and padding too. See tracker: #10662\n\t\t\t\tvar areaHeight = (this._contentBox.h -\n\t\t\t\t\t(this.getHeaderHeight() + this.getFooterHeight() +\n\t\t\t\t\t\tdomGeometry.getPadBorderExtents(this.iframe.parentNode).h +\n\t\t\t\t\t\tdomGeometry.getMarginExtents(this.iframe.parentNode).h));\n\t\t\t\tthis.editingArea.style.height = areaHeight + \"px\";\n\t\t\t\tif(this.iframe){\n\t\t\t\t\tthis.iframe.style.height = \"100%\";\n\t\t\t\t}\n\t\t\t\tthis._layoutMode = true;\n\t\t\t},\n\t\n\t\t\t_onIEMouseDown: function(/*Event*/ e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tIE only to prevent 2 clicks to focus\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar outsideClientArea;\n\t\t\t\t// IE 8's componentFromPoint is broken, which is a shame since it\n\t\t\t\t// was smaller code, but oh well.  We have to do this brute force\n\t\t\t\t// to detect if the click was scroller or not.\n\t\t\t\tvar b = this.document.body;\n\t\t\t\tvar clientWidth = b.clientWidth;\n\t\t\t\tvar clientHeight = b.clientHeight;\n\t\t\t\tvar clientLeft = b.clientLeft;\n\t\t\t\tvar offsetWidth = b.offsetWidth;\n\t\t\t\tvar offsetHeight = b.offsetHeight;\n\t\t\t\tvar offsetLeft = b.offsetLeft;\n\t\n\t\t\t\t//Check for vertical scroller click.\n\t\t\t\tif(/^rtl$/i.test(b.dir || \"\")){\n\t\t\t\t\tif(clientWidth < offsetWidth && e.x > clientWidth && e.x < offsetWidth){\n\t\t\t\t\t\t// Check the click was between width and offset width, if so, scroller\n\t\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// RTL mode, we have to go by the left offsets.\n\t\t\t\t\tif(e.x < clientLeft && e.x > offsetLeft){\n\t\t\t\t\t\t// Check the click was between width and offset width, if so, scroller\n\t\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!outsideClientArea){\n\t\t\t\t\t// Okay, might be horiz scroller, check that.\n\t\t\t\t\tif(clientHeight < offsetHeight && e.y > clientHeight && e.y < offsetHeight){\n\t\t\t\t\t\t// Horizontal scroller.\n\t\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!outsideClientArea){\n\t\t\t\t\tdelete this._cursorToStart; // Remove the force to cursor to start position.\n\t\t\t\t\tdelete this._savedSelection; // new mouse position overrides old selection\n\t\t\t\t\tif(e.target.tagName == \"BODY\"){\n\t\t\t\t\t\tthis.defer(\"placeCursorAtEnd\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.inherited(arguments);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonBeforeActivate: function(){\n\t\t\t\tthis._restoreSelection();\n\t\t\t},\n\t\t\tonBeforeDeactivate: function(e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled on IE right before focus is lost.   Saves the selected range.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this.customUndo){\n\t\t\t\t\tthis.endEditing(true);\n\t\t\t\t}\n\t\t\t\t//in IE, the selection will be lost when other elements get focus,\n\t\t\t\t//let's save focus before the editor is deactivated\n\t\t\t\tif(e.target.tagName != \"BODY\"){\n\t\t\t\t\tthis._saveSelection();\n\t\t\t\t}\n\t\t\t\t//console.log('onBeforeDeactivate',this);\n\t\t\t},\n\t\n\t\t\t/* beginning of custom undo/redo support */\n\t\n\t\t\t// customUndo: Boolean\n\t\t\t//\t\tWhether we shall use custom undo/redo support instead of the native\n\t\t\t//\t\tbrowser support. By default, we now use custom undo.  It works better\n\t\t\t//\t\tthan native browser support and provides a consistent behavior across\n\t\t\t//\t\tbrowsers with a minimal performance hit.  We already had the hit on\n\t\t\t//\t\tthe slowest browser, IE, anyway.\n\t\t\tcustomUndo: true,\n\t\n\t\t\t// editActionInterval: Integer\n\t\t\t//\t\tWhen using customUndo, not every keystroke will be saved as a step.\n\t\t\t//\t\tInstead typing (including delete) will be grouped together: after\n\t\t\t//\t\ta user stops typing for editActionInterval seconds, a step will be\n\t\t\t//\t\tsaved; if a user resume typing within editActionInterval seconds,\n\t\t\t//\t\tthe timeout will be restarted. By default, editActionInterval is 3\n\t\t\t//\t\tseconds.\n\t\t\teditActionInterval: 3,\n\t\n\t\t\tbeginEditing: function(cmd){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled to note that the user has started typing alphanumeric characters, if it's not already noted.\n\t\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(!this._inEditing){\n\t\t\t\t\tthis._inEditing = true;\n\t\t\t\t\tthis._beginEditing(cmd);\n\t\t\t\t}\n\t\t\t\tif(this.editActionInterval > 0){\n\t\t\t\t\tif(this._editTimer){\n\t\t\t\t\t\tthis._editTimer.remove();\n\t\t\t\t\t}\n\t\t\t\t\tthis._editTimer = this.defer(\"endEditing\", this._editInterval);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t// TODO: declaring these in the prototype is meaningless, just create in the constructor/postCreate\n\t\t\t_steps: [],\n\t\t\t_undoedSteps: [],\n\t\n\t\t\texecCommand: function(cmd){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tMain handler for executing any commands to the editor, like paste, bold, etc.\n\t\t\t\t//\t\tCalled by plugins, but not meant to be called by end users.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(this.customUndo && (cmd == 'undo' || cmd == 'redo')){\n\t\t\t\t\treturn this[cmd]();\n\t\t\t\t}else{\n\t\t\t\t\tif(this.customUndo){\n\t\t\t\t\t\tthis.endEditing();\n\t\t\t\t\t\tthis._beginEditing();\n\t\t\t\t\t}\n\t\t\t\t\tvar r = this.inherited(arguments);\n\t\t\t\t\tif(this.customUndo){\n\t\t\t\t\t\tthis._endEditing();\n\t\t\t\t\t}\n\t\t\t\t\treturn r;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_pasteImpl: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tOver-ride of paste command control to make execCommand cleaner\n\t\t\t\t// tags:\n\t\t\t\t//\t\tProtected\n\t\t\t\treturn this._clipboardCommand(\"paste\");\n\t\t\t},\n\t\n\t\t\t_cutImpl: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tOver-ride of cut command control to make execCommand cleaner\n\t\t\t\t// tags:\n\t\t\t\t//\t\tProtected\n\t\t\t\treturn this._clipboardCommand(\"cut\");\n\t\t\t},\n\t\n\t\t\t_copyImpl: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tOver-ride of copy command control to make execCommand cleaner\n\t\t\t\t// tags:\n\t\t\t\t//\t\tProtected\n\t\t\t\treturn this._clipboardCommand(\"copy\");\n\t\t\t},\n\t\n\t\t\t_clipboardCommand: function(cmd){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to handle processing clipboard commands (or at least try to).\n\t\t\t\t// tags:\n\t\t\t\t//\t\tPrivate\n\t\t\t\tvar r;\n\t\t\t\ttry{\n\t\t\t\t\t// Try to exec the superclass exec-command and see if it works.\n\t\t\t\t\tr = this.document.execCommand(cmd, false, null);\n\t\t\t\t\tif(has(\"webkit\") && !r){ //see #4598: webkit does not guarantee clipboard support from js\n\t\t\t\t\t\tthrow { code: 1011 }; // throw an object like Mozilla's error\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\t//TODO: when else might we get an exception?  Do we need the Mozilla test below?\n\t\t\t\t\tif(e.code == 1011 /* Mozilla: service denied */ ||\n\t\t\t\t\t\t(e.code == 9 && has(\"opera\") /* Opera not supported */)){\n\t\t\t\t\t\t// Warn user of platform limitation.  Cannot programmatically access clipboard. See ticket #4136\n\t\t\t\t\t\tvar sub = string.substitute,\n\t\t\t\t\t\t\taccel = {cut: 'X', copy: 'C', paste: 'V'};\n\t\t\t\t\t\talert(sub(this.commands.systemShortcut,\n\t\t\t\t\t\t\t[this.commands[cmd], sub(this.commands[has(\"mac\") ? 'appleKey' : 'ctrlKey'], [accel[cmd]])]));\n\t\t\t\t\t}\n\t\t\t\t\tr = false;\n\t\t\t\t}\n\t\t\t\treturn r;\n\t\t\t},\n\t\n\t\t\tqueryCommandEnabled: function(cmd){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturns true if specified editor command is enabled.\n\t\t\t\t//\t\tUsed by the plugins to know when to highlight/not highlight buttons.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(this.customUndo && (cmd == 'undo' || cmd == 'redo')){\n\t\t\t\t\treturn cmd == 'undo' ? (this._steps.length > 1) : (this._undoedSteps.length > 0);\n\t\t\t\t}else{\n\t\t\t\t\treturn this.inherited(arguments);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_moveToBookmark: function(b){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSelects the text specified in bookmark b\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar bookmark = b.mark;\n\t\t\t\tvar mark = b.mark;\n\t\t\t\tvar col = b.isCollapsed;\n\t\t\t\tvar r, sNode, eNode, sel;\n\t\t\t\tif(mark){\n\t\t\t\t\tif(has(\"ie\") < 9 || (has(\"ie\") === 9 && has(\"quirks\"))){\n\t\t\t\t\t\tif(lang.isArray(mark)){\n\t\t\t\t\t\t\t// IE CONTROL, have to use the native bookmark.\n\t\t\t\t\t\t\tbookmark = [];\n\t\t\t\t\t\t\tarray.forEach(mark, function(n){\n\t\t\t\t\t\t\t\tbookmark.push(rangeapi.getNode(n, this.editNode));\n\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\tthis.selection.moveToBookmark({mark: bookmark, isCollapsed: col});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(mark.startContainer && mark.endContainer){\n\t\t\t\t\t\t\t\t// Use the pseudo WC3 range API.  This works better for positions\n\t\t\t\t\t\t\t\t// than the IE native bookmark code.\n\t\t\t\t\t\t\t\tsel = rangeapi.getSelection(this.window);\n\t\t\t\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\t\t\tr = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\t\tsNode = rangeapi.getNode(mark.startContainer, this.editNode);\n\t\t\t\t\t\t\t\t\teNode = rangeapi.getNode(mark.endContainer, this.editNode);\n\t\t\t\t\t\t\t\t\tif(sNode && eNode){\n\t\t\t\t\t\t\t\t\t\t// Okay, we believe we found the position, so add it into the selection\n\t\t\t\t\t\t\t\t\t\t// There are cases where it may not be found, particularly in undo/redo, when\n\t\t\t\t\t\t\t\t\t\t// IE changes the underlying DOM on us (wraps text in a <p> tag or similar.\n\t\t\t\t\t\t\t\t\t\t// So, in those cases, don't bother restoring selection.\n\t\t\t\t\t\t\t\t\t\tr.setStart(sNode, mark.startOffset);\n\t\t\t\t\t\t\t\t\t\tr.setEnd(eNode, mark.endOffset);\n\t\t\t\t\t\t\t\t\t\tsel.addRange(r);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{//w3c range\n\t\t\t\t\t\tsel = rangeapi.getSelection(this.window);\n\t\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\tr = rangeapi.create(this.window);\n\t\t\t\t\t\t\tsNode = rangeapi.getNode(mark.startContainer, this.editNode);\n\t\t\t\t\t\t\teNode = rangeapi.getNode(mark.endContainer, this.editNode);\n\t\t\t\t\t\t\tif(sNode && eNode){\n\t\t\t\t\t\t\t\t// Okay, we believe we found the position, so add it into the selection\n\t\t\t\t\t\t\t\t// There are cases where it may not be found, particularly in undo/redo, when\n\t\t\t\t\t\t\t\t// formatting as been done and so on, so don't restore selection then.\n\t\t\t\t\t\t\t\tr.setStart(sNode, mark.startOffset);\n\t\t\t\t\t\t\t\tr.setEnd(eNode, mark.endOffset);\n\t\t\t\t\t\t\t\tsel.addRange(r);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t_changeToStep: function(from, to){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReverts editor to \"to\" setting, from the undo stack.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tthis.setValue(to.text);\n\t\t\t\tvar b = to.bookmark;\n\t\t\t\tif(!b){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._moveToBookmark(b);\n\t\t\t},\n\t\t\tundo: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for editor undo (ex: ctrl-z) operation\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar ret = false;\n\t\t\t\tif(!this._undoRedoActive){\n\t\t\t\t\tthis._undoRedoActive = true;\n\t\t\t\t\tthis.endEditing(true);\n\t\t\t\t\tvar s = this._steps.pop();\n\t\t\t\t\tif(s && this._steps.length > 0){\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\tthis._changeToStep(s, this._steps[this._steps.length - 1]);\n\t\t\t\t\t\tthis._undoedSteps.push(s);\n\t\t\t\t\t\tthis.onDisplayChanged();\n\t\t\t\t\t\tdelete this._undoRedoActive;\n\t\t\t\t\t\tret = true;\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._undoRedoActive;\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t},\n\t\t\tredo: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for editor redo (ex: ctrl-y) operation\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar ret = false;\n\t\t\t\tif(!this._undoRedoActive){\n\t\t\t\t\tthis._undoRedoActive = true;\n\t\t\t\t\tthis.endEditing(true);\n\t\t\t\t\tvar s = this._undoedSteps.pop();\n\t\t\t\t\tif(s && this._steps.length > 0){\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\tthis._changeToStep(this._steps[this._steps.length - 1], s);\n\t\t\t\t\t\tthis._steps.push(s);\n\t\t\t\t\t\tthis.onDisplayChanged();\n\t\t\t\t\t\tret = true;\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._undoRedoActive;\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t},\n\t\t\tendEditing: function(ignore_caret){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled to note that the user has stopped typing alphanumeric characters, if it's not already noted.\n\t\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this._editTimer){\n\t\t\t\t\tthis._editTimer = this._editTimer.remove();\n\t\t\t\t}\n\t\t\t\tif(this._inEditing){\n\t\t\t\t\tthis._endEditing(ignore_caret);\n\t\t\t\t\tthis._inEditing = false;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_getBookmark: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tGet the currently selected text\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar b = this.selection.getBookmark();\n\t\t\t\tvar tmp = [];\n\t\t\t\tif(b && b.mark){\n\t\t\t\t\tvar mark = b.mark;\n\t\t\t\t\tif(has(\"ie\") < 9 || (has(\"ie\") === 9 && has(\"quirks\"))){\n\t\t\t\t\t\t// Try to use the pseudo range API on IE for better accuracy.\n\t\t\t\t\t\tvar sel = rangeapi.getSelection(this.window);\n\t\t\t\t\t\tif(!lang.isArray(mark)){\n\t\t\t\t\t\t\tif(sel){\n\t\t\t\t\t\t\t\tvar range;\n\t\t\t\t\t\t\t\tif(sel.rangeCount){\n\t\t\t\t\t\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(range){\n\t\t\t\t\t\t\t\t\tb.mark = range.cloneRange();\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tb.mark = this.selection.getBookmark();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// Control ranges (img, table, etc), handle differently.\n\t\t\t\t\t\t\tarray.forEach(b.mark, function(n){\n\t\t\t\t\t\t\t\ttmp.push(rangeapi.getIndex(n, this.editNode).o);\n\t\t\t\t\t\t\t}, this);\n\t\t\t\t\t\t\tb.mark = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif(b.mark && b.mark.startContainer){\n\t\t\t\t\t\t\ttmp = rangeapi.getIndex(b.mark.startContainer, this.editNode).o;\n\t\t\t\t\t\t\tb.mark = {startContainer: tmp,\n\t\t\t\t\t\t\t\tstartOffset: b.mark.startOffset,\n\t\t\t\t\t\t\t\tendContainer: b.mark.endContainer === b.mark.startContainer ? tmp : rangeapi.getIndex(b.mark.endContainer, this.editNode).o,\n\t\t\t\t\t\t\t\tendOffset: b.mark.endOffset};\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tb.mark = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn b;\n\t\t\t},\n\t\t\t_beginEditing: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled when the user starts typing alphanumeric characters.\n\t\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this._steps.length === 0){\n\t\t\t\t\t// You want to use the editor content without post filtering\n\t\t\t\t\t// to make sure selection restores right for the 'initial' state.\n\t\t\t\t\t// and undo is called.  So not using this.value, as it was 'processed'\n\t\t\t\t\t// and the line-up for selections may have been altered.\n\t\t\t\t\tthis._steps.push({'text': html.getChildrenHtml(this.editNode), 'bookmark': this._getBookmark()});\n\t\t\t\t}\n\t\t\t},\n\t\t\t_endEditing: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled when the user stops typing alphanumeric characters.\n\t\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\t// Avoid filtering to make sure selections restore.\n\t\t\t\tvar v = html.getChildrenHtml(this.editNode);\n\t\n\t\t\t\tthis._undoedSteps = [];//clear undoed steps\n\t\t\t\tthis._steps.push({text: v, bookmark: this._getBookmark()});\n\t\t\t},\n\t\t\tonKeyDown: function(e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for onkeydown event.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\t//We need to save selection if the user TAB away from this editor\n\t\t\t\t//no need to call _saveSelection for IE, as that will be taken care of in onBeforeDeactivate\n\t\t\t\tif(!has(\"ie\") && !this.iframe && e.keyCode == keys.TAB && !this.tabIndent){\n\t\t\t\t\tthis._saveSelection();\n\t\t\t\t}\n\t\t\t\tif(!this.customUndo){\n\t\t\t\t\tthis.inherited(arguments);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar k = e.keyCode;\n\t\t\t\tif(e.ctrlKey && !e.shiftKey && !e.altKey){//undo and redo only if the special right Alt + z/y are not pressed #5892\n\t\t\t\t\tif(k == 90 || k == 122){ //z, but also F11 key\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.undo();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}else if(k == 89 || k == 121){ //y\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.redo();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\tswitch(k){\n\t\t\t\t\tcase keys.ENTER:\n\t\t\t\t\tcase keys.BACKSPACE:\n\t\t\t\t\tcase keys.DELETE:\n\t\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 88: //x\n\t\t\t\t\tcase 86: //v\n\t\t\t\t\t\tif(e.ctrlKey && !e.altKey && !e.metaKey){\n\t\t\t\t\t\t\tthis.endEditing();//end current typing step if any\n\t\t\t\t\t\t\tif(e.keyCode == 88){\n\t\t\t\t\t\t\t\tthis.beginEditing('cut');\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.beginEditing('paste');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//use timeout to trigger after the paste is complete\n\t\t\t\t\t\t\tthis.defer(\"endEditing\", 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t//pass through\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!e.ctrlKey && !e.altKey && !e.metaKey && (e.keyCode < keys.F1 || e.keyCode > keys.F15)){\n\t\t\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t//pass through\n\t\t\t\t\tcase keys.ALT:\n\t\t\t\t\t\tthis.endEditing();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase keys.UP_ARROW:\n\t\t\t\t\tcase keys.DOWN_ARROW:\n\t\t\t\t\tcase keys.LEFT_ARROW:\n\t\t\t\t\tcase keys.RIGHT_ARROW:\n\t\t\t\t\tcase keys.HOME:\n\t\t\t\t\tcase keys.END:\n\t\t\t\t\tcase keys.PAGE_UP:\n\t\t\t\t\tcase keys.PAGE_DOWN:\n\t\t\t\t\t\tthis.endEditing(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//maybe ctrl+backspace/delete, so don't endEditing when ctrl is pressed\n\t\t\t\t\tcase keys.CTRL:\n\t\t\t\t\tcase keys.SHIFT:\n\t\t\t\t\tcase keys.TAB:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onBlur: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled from focus manager when focus has moved away from this editor\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\t//this._saveSelection();\n\t\t\t\tthis.inherited(arguments);\n\t\t\t\tthis.endEditing(true);\n\t\t\t},\n\t\t\t_saveSelection: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSave the currently selected text in _savedSelection attribute\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\ttry{\n\t\t\t\t\tthis._savedSelection = this._getBookmark();\n\t\t\t\t}catch(e){ /* Squelch any errors that occur if selection save occurs due to being hidden simultaneously. */\n\t\t\t\t}\n\t\t\t},\n\t\t\t_restoreSelection: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tRe-select the text specified in _savedSelection attribute;\n\t\t\t\t//\t\tsee _saveSelection().\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this._savedSelection){\n\t\t\t\t\t// Clear off cursor to start, we're deliberately going to a selection.\n\t\t\t\t\tdelete this._cursorToStart;\n\t\t\t\t\t// only restore the selection if the current range is collapsed\n\t\t\t\t\t// if not collapsed, then it means the editor does not lose\n\t\t\t\t\t// selection and there is no need to restore it\n\t\t\t\t\tif(this.selection.isCollapsed()){\n\t\t\t\t\t\tthis._moveToBookmark(this._savedSelection);\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._savedSelection;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tonClick: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for when editor is clicked\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tthis.endEditing(true);\n\t\t\t\tthis.inherited(arguments);\n\t\t\t},\n\t\n\t\t\treplaceValue: function(/*String*/ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tover-ride of replaceValue to support custom undo and stack maintenance.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(!this.customUndo){\n\t\t\t\t\tthis.inherited(arguments);\n\t\t\t\t}else{\n\t\t\t\t\tif(this.isClosed){\n\t\t\t\t\t\tthis.setValue(html);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\t\tif(!html){\n\t\t\t\t\t\t\thtml = \"&#160;\";\t// &nbsp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setValue(html);\n\t\t\t\t\t\tthis.endEditing();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_setDisabledAttr: function(/*Boolean*/ value){\n\t\t\t\tthis.setValueDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\tif((!this.disabled && value) || (!this._buttonEnabledPlugins && value)){\n\t\t\t\t\t\t// Disable editor: disable all enabled buttons and remember that list\n\t\t\t\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\t\t\t\tp.set(\"disabled\", true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else if(this.disabled && !value){\n\t\t\t\t\t\t// Restore plugins to being active.\n\t\t\t\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\t\t\t\tp.set(\"disabled\", false);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tthis.inherited(arguments);\n\t\t\t},\n\t\n\t\t\t_setStateClass: function(){\n\t\t\t\ttry{\n\t\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\t\t// Let theme set the editor's text color based on editor enabled/disabled state.\n\t\t\t\t\t// We need to jump through hoops because the main document (where the theme CSS is)\n\t\t\t\t\t// is separate from the iframe's document.\n\t\t\t\t\tif(this.document && this.document.body){\n\t\t\t\t\t\tdomStyle.set(this.document.body, \"color\", domStyle.get(this.iframe, \"color\"));\n\t\t\t\t\t}\n\t\t\t\t}catch(e){ /* Squelch any errors caused by focus change if hidden during a state change */\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// Register the \"default plugins\", ie, the built-in editor commands\n\t\tfunction simplePluginFactory(args){\n\t\t\treturn new _Plugin({ command: args.name });\n\t\t}\n\t\n\t\tfunction togglePluginFactory(args){\n\t\t\treturn new _Plugin({ buttonClass: ToggleButton, command: args.name });\n\t\t}\n\t\n\t\tlang.mixin(_Plugin.registry, {\n\t\t\t\"undo\": simplePluginFactory,\n\t\t\t\"redo\": simplePluginFactory,\n\t\t\t\"cut\": simplePluginFactory,\n\t\t\t\"copy\": simplePluginFactory,\n\t\t\t\"paste\": simplePluginFactory,\n\t\t\t\"insertOrderedList\": simplePluginFactory,\n\t\t\t\"insertUnorderedList\": simplePluginFactory,\n\t\t\t\"indent\": simplePluginFactory,\n\t\t\t\"outdent\": simplePluginFactory,\n\t\t\t\"justifyCenter\": simplePluginFactory,\n\t\t\t\"justifyFull\": simplePluginFactory,\n\t\t\t\"justifyLeft\": simplePluginFactory,\n\t\t\t\"justifyRight\": simplePluginFactory,\n\t\t\t\"delete\": simplePluginFactory,\n\t\t\t\"selectAll\": simplePluginFactory,\n\t\t\t\"removeFormat\": simplePluginFactory,\n\t\t\t\"unlink\": simplePluginFactory,\n\t\t\t\"insertHorizontalRule\": simplePluginFactory,\n\t\n\t\t\t\"bold\": togglePluginFactory,\n\t\t\t\"italic\": togglePluginFactory,\n\t\t\t\"underline\": togglePluginFactory,\n\t\t\t\"strikethrough\": togglePluginFactory,\n\t\t\t\"subscript\": togglePluginFactory,\n\t\t\t\"superscript\": togglePluginFactory,\n\t\n\t\t\t\"|\": function(){\n\t\t\t\treturn new _Plugin({\n\t\t\t\t\tsetEditor: function(editor){\n\t\t\t\t\t\tthis.editor = editor;\n\t\t\t\t\t\tthis.button = new ToolbarSeparator({ownerDocument: editor.ownerDocument});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\n\t\treturn Editor;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 150:\n/*!*******************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/Toolbar.js ***!\n  \\*******************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__.dj.c(/*! dijit/Toolbar */ 150),\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/has */ 5),\n\t\t__webpack_require__(/*! dojo/keys */ 47), // keys.LEFT_ARROW keys.RIGHT_ARROW\n\t\t__webpack_require__(/*! dojo/ready */ 3),\n\t\t__webpack_require__(/*! ./_Widget */ 57),\n\t\t__webpack_require__(/*! ./_KeyNavContainer */ 109),\n\t\t__webpack_require__(/*! ./_TemplatedMixin */ 72)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(require, declare, has, keys, ready, _Widget, _KeyNavContainer, _TemplatedMixin){\n\t\n\t\t// module:\n\t\t//\t\tdijit/Toolbar\n\t\n\t\n\t\t// Back compat w/1.6, remove for 2.0\n\t\tif(has(\"dijit-legacy-requires\")){\n\t\t\tready(0, function(){\n\t\t\t\tvar requires = [\"dijit/ToolbarSeparator\"];\n\t\t\t\trequire(requires);\t// use indirection so modules not rolled into a build\n\t\t\t});\n\t\t}\n\t\n\t\treturn declare(\"dijit.Toolbar\", [_Widget, _TemplatedMixin, _KeyNavContainer], {\n\t\t\t// summary:\n\t\t\t//\t\tA Toolbar widget, used to hold things like `dijit/Editor` buttons\n\t\n\t\t\ttemplateString:\n\t\t\t\t'<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">' +\n\t\t\t\t'</div>',\n\t\n\t\t\tbaseClass: \"dijitToolbar\",\n\t\n\t\t\t_onLeftArrow: function(){\n\t\t\t\tthis.focusPrev();\n\t\t\t},\n\t\n\t\t\t_onRightArrow: function(){\n\t\t\t\tthis.focusNext();\n\t\t\t}\n\t\t});\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 151:\n/*!****************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/ToolbarSeparator.js ***!\n  \\****************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/dom */ 14), // dom.setSelectable\n\t\t__webpack_require__(/*! ./_Widget */ 57),\n\t\t__webpack_require__(/*! ./_TemplatedMixin */ 72)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(declare, dom, _Widget, _TemplatedMixin){\n\t\n\t\t// module:\n\t\t//\t\tdijit/ToolbarSeparator\n\t\n\t\n\t\treturn declare(\"dijit.ToolbarSeparator\", [_Widget, _TemplatedMixin], {\n\t\t\t// summary:\n\t\t\t//\t\tA spacer between two `dijit.Toolbar` items\n\t\n\t\t\ttemplateString: '<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>',\n\t\n\t\t\tbuildRendering: function(){\n\t\t\t\tthis.inherited(arguments);\n\t\t\t\tdom.setSelectable(this.domNode, false);\n\t\t\t},\n\t\n\t\t\tisFocusable: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis widget isn't focusable, so pass along that fact.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 152:\n/*!***************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/_Plugin.js ***!\n  \\***************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/connect */ 42), // connect.connect\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9), // lang.mixin, lang.hitch\n\t\t__webpack_require__(/*! ../Destroyable */ 54),\n\t\t__webpack_require__(/*! ../form/Button */ 90)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(connect, declare, lang, Destroyable, Button){\n\t\n\t\t// module:\n\t\t//\t\tdijit/_editor/_Plugin\n\t\n\t\tvar _Plugin = declare(\"dijit._editor._Plugin\", Destroyable, {\n\t\t\t// summary:\n\t\t\t//\t\tBase class for a \"plugin\" to the editor, which is usually\n\t\t\t//\t\ta single button on the Toolbar and some associated code\n\t\n\t\t\tconstructor: function(args){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCreate the plugin.\n\t\t\t\t// args: Object?\n\t\t\t\t//\t\tInitial settings for any of the attributes.\n\t\n\t\t\t\tthis.params = args || {};\n\t\t\t\tlang.mixin(this, this.params);\n\t\t\t\tthis._attrPairNames = {};\n\t\t\t},\n\t\n\t\t\t// editor: [const] dijit.Editor\n\t\t\t//\t\tPoints to the parent editor\n\t\t\teditor: null,\n\t\n\t\t\t// iconClassPrefix: [const] String\n\t\t\t//\t\tThe CSS class name for the button node is formed from `iconClassPrefix` and `command`\n\t\t\ticonClassPrefix: \"dijitEditorIcon\",\n\t\n\t\t\t// button: dijit/_WidgetBase?\n\t\t\t//\t\tPointer to `dijit/form/Button` or other widget (ex: `dijit/form/FilteringSelect`)\n\t\t\t//\t\tthat is added to the toolbar to control this plugin.\n\t\t\t//\t\tIf not specified, will be created on initialization according to `buttonClass`\n\t\t\tbutton: null,\n\t\n\t\t\t// command: String\n\t\t\t//\t\tString like \"insertUnorderedList\", \"outdent\", \"justifyCenter\", etc. that represents an editor command.\n\t\t\t//\t\tPassed to editor.execCommand() if `useDefaultCommand` is true.\n\t\t\tcommand: \"\",\n\t\n\t\t\t// useDefaultCommand: Boolean\n\t\t\t//\t\tIf true, this plugin executes by calling Editor.execCommand() with the argument specified in `command`.\n\t\t\tuseDefaultCommand: true,\n\t\n\t\t\t// buttonClass: Widget Class\n\t\t\t//\t\tClass of widget (ex: dijit.form.Button or dijit/form/FilteringSelect)\n\t\t\t//\t\tthat is added to the toolbar to control this plugin.\n\t\t\t//\t\tThis is used to instantiate the button, unless `button` itself is specified directly.\n\t\t\tbuttonClass: Button,\n\t\n\t\t\t// disabled: Boolean\n\t\t\t//\t\tFlag to indicate if this plugin has been disabled and should do nothing\n\t\t\t//\t\thelps control button state, among other things.  Set via the setter api.\n\t\t\tdisabled: false,\n\t\n\t\t\tgetLabel: function(/*String*/key){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturns the label to use for the button\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\treturn this.editor.commands[key];\t\t// String\n\t\t\t},\n\t\n\t\t\t_initButton: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tInitialize the button or other widget that will control this plugin.\n\t\t\t\t//\t\tThis code only works for plugins controlling built-in commands in the editor.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected extension\n\t\t\t\tif(this.command.length){\n\t\t\t\t\tvar label = this.getLabel(this.command),\n\t\t\t\t\t\teditor = this.editor,\n\t\t\t\t\t\tclassName = this.iconClassPrefix + \" \" + this.iconClassPrefix + this.command.charAt(0).toUpperCase() + this.command.substr(1);\n\t\t\t\t\tif(!this.button){\n\t\t\t\t\t\tvar props = lang.mixin({\n\t\t\t\t\t\t\tlabel: label,\n\t\t\t\t\t\t\townerDocument: editor.ownerDocument,\n\t\t\t\t\t\t\tdir: editor.dir,\n\t\t\t\t\t\t\tlang: editor.lang,\n\t\t\t\t\t\t\tshowLabel: false,\n\t\t\t\t\t\t\ticonClass: className,\n\t\t\t\t\t\t\tdropDown: this.dropDown,\n\t\t\t\t\t\t\ttabIndex: \"-1\"\n\t\t\t\t\t\t}, this.params || {});\n\t\n\t\t\t\t\t\t// Avoid creating Button with a name like \"dijit/editor/_plugins/ToggleDir\", since that name becomes\n\t\t\t\t\t\t// a global object, and then if the ToggleDir plugin is referenced again, _Plugin.js will\n\t\t\t\t\t\t// find the <input> rather than the ToggleDir module.\n\t\t\t\t\t\t// Not necessary in 2.0 once the getObject() call is removed from _Plugin.js.\n\t\t\t\t\t\tdelete props.name;\n\t\n\t\t\t\t\t\tthis.button = new this.buttonClass(props);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(this.get(\"disabled\") && this.button){\n\t\t\t\t\tthis.button.set(\"disabled\", this.get(\"disabled\"));\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tdestroy: function(){\n\t\t\t\tif(this.dropDown){\n\t\t\t\t\tthis.dropDown.destroyRecursive();\n\t\t\t\t}\n\t\n\t\t\t\tthis.inherited(arguments);\n\t\t\t},\n\t\n\t\t\tconnect: function(o, f, tf){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tDeprecated.  Use this.own() with dojo/on or dojo/aspect.instead.\n\t\t\t\t//\n\t\t\t\t//\t\tMake a connect.connect() that is automatically disconnected when this plugin is destroyed.\n\t\t\t\t//\t\tSimilar to `dijit/_Widget.connect()`.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected deprecated\n\t\n\t\t\t\tthis.own(connect.connect(o, f, this, tf));\n\t\t\t},\n\t\n\t\t\tupdateState: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tChange state of the plugin to respond to events in the editor.\n\t\t\t\t// description:\n\t\t\t\t//\t\tThis is called on meaningful events in the editor, such as change of selection\n\t\t\t\t//\t\tor caret position (but not simple typing of alphanumeric keys).   It gives the\n\t\t\t\t//\t\tplugin a chance to update the CSS of its button.\n\t\t\t\t//\n\t\t\t\t//\t\tFor example, the \"bold\" plugin will highlight/unhighlight the bold button depending on whether the\n\t\t\t\t//\t\tcharacters next to the caret are bold or not.\n\t\t\t\t//\n\t\t\t\t//\t\tOnly makes sense when `useDefaultCommand` is true, as it calls Editor.queryCommandEnabled(`command`).\n\t\t\t\tvar e = this.editor,\n\t\t\t\t\tc = this.command,\n\t\t\t\t\tchecked, enabled;\n\t\t\t\tif(!e || !e.isLoaded || !c.length){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar disabled = this.get(\"disabled\");\n\t\t\t\tif(this.button){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tenabled = !disabled && e.queryCommandEnabled(c);\n\t\t\t\t\t\tif(this.enabled !== enabled){\n\t\t\t\t\t\t\tthis.enabled = enabled;\n\t\t\t\t\t\t\tthis.button.set('disabled', !enabled);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(enabled){\n\t\t\t\t\t\t\tif(typeof this.button.checked == 'boolean'){\n\t\t\t\t\t\t\t\tchecked = e.queryCommandState(c);\n\t\t\t\t\t\t\t\tif(this.checked !== checked){\n\t\t\t\t\t\t\t\t\tthis.checked = checked;\n\t\t\t\t\t\t\t\t\tthis.button.set('checked', e.queryCommandState(c));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tconsole.log(e); // FIXME: we shouldn't have debug statements in our code.  Log as an error?\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tsetEditor: function(/*dijit/Editor*/ editor){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tTell the plugin which Editor it is associated with.\n\t\n\t\t\t\t// TODO: refactor code to just pass editor to constructor.\n\t\n\t\t\t\t// FIXME: detach from previous editor!!\n\t\t\t\tthis.editor = editor;\n\t\n\t\t\t\t// FIXME: prevent creating this if we don't need to (i.e., editor can't handle our command)\n\t\t\t\tthis._initButton();\n\t\n\t\t\t\t// Processing for buttons that execute by calling editor.execCommand()\n\t\t\t\tif(this.button && this.useDefaultCommand){\n\t\t\t\t\tif(this.editor.queryCommandAvailable(this.command)){\n\t\t\t\t\t\tthis.own(this.button.on(\"click\",\n\t\t\t\t\t\t\tlang.hitch(this.editor, \"execCommand\", this.command, this.commandArg)\n\t\t\t\t\t\t));\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// hide button because editor doesn't support command (due to browser limitations)\n\t\t\t\t\t\tthis.button.domNode.style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.own(this.editor.on(\"NormalizedDisplayChanged\", lang.hitch(this, \"updateState\")));\n\t\t\t},\n\t\n\t\t\tsetToolbar: function(/*dijit/Toolbar*/ toolbar){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tTell the plugin to add it's controller widget (often a button)\n\t\t\t\t//\t\tto the toolbar.  Does nothing if there is no controller widget.\n\t\n\t\t\t\t// TODO: refactor code to just pass toolbar to constructor.\n\t\n\t\t\t\tif(this.button){\n\t\t\t\t\ttoolbar.addChild(this.button);\n\t\t\t\t}\n\t\t\t\t// console.debug(\"adding\", this.button, \"to:\", toolbar);\n\t\t\t},\n\t\n\t\t\tset: function(/* attribute */ name, /* anything */ value){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSet a property on a plugin\n\t\t\t\t// name:\n\t\t\t\t//\t\tThe property to set.\n\t\t\t\t// value:\n\t\t\t\t//\t\tThe value to set in the property.\n\t\t\t\t// description:\n\t\t\t\t//\t\tSets named properties on a plugin which may potentially be handled by a\n\t\t\t\t//\t\tsetter in the plugin.\n\t\t\t\t//\t\tFor example, if the plugin has a properties \"foo\"\n\t\t\t\t//\t\tand \"bar\" and a method named \"_setFooAttr\", calling:\n\t\t\t\t//\t|\tplugin.set(\"foo\", \"Howdy!\");\n\t\t\t\t//\t\twould be equivalent to writing:\n\t\t\t\t//\t|\tplugin._setFooAttr(\"Howdy!\");\n\t\t\t\t//\t\tand:\n\t\t\t\t//\t|\tplugin.set(\"bar\", 3);\n\t\t\t\t//\t\twould be equivalent to writing:\n\t\t\t\t//\t|\tplugin.bar = 3;\n\t\t\t\t//\n\t\t\t\t//\t\tset() may also be called with a hash of name/value pairs, ex:\n\t\t\t\t//\t|\tplugin.set({\n\t\t\t\t//\t|\t\tfoo: \"Howdy\",\n\t\t\t\t//\t|\t\tbar: 3\n\t\t\t\t//\t|\t})\n\t\t\t\t//\t\tThis is equivalent to calling set(foo, \"Howdy\") and set(bar, 3)\n\t\t\t\tif(typeof name === \"object\"){\n\t\t\t\t\tfor(var x in name){\n\t\t\t\t\t\tthis.set(x, name[x]);\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tvar names = this._getAttrNames(name);\n\t\t\t\tif(this[names.s]){\n\t\t\t\t\t// use the explicit setter\n\t\t\t\t\tvar result = this[names.s].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\t\t}else{\n\t\t\t\t\tthis._set(name, value);\n\t\t\t\t}\n\t\t\t\treturn result || this;\n\t\t\t},\n\t\n\t\t\tget: function(name){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tGet a property from a plugin.\n\t\t\t\t// name:\n\t\t\t\t//\t\tThe property to get.\n\t\t\t\t// description:\n\t\t\t\t//\t\tGet a named property from a plugin. The property may\n\t\t\t\t//\t\tpotentially be retrieved via a getter method. If no getter is defined, this\n\t\t\t\t//\t\tjust retrieves the object's property.\n\t\t\t\t//\t\tFor example, if the plugin has a properties \"foo\"\n\t\t\t\t//\t\tand \"bar\" and a method named \"_getFooAttr\", calling:\n\t\t\t\t//\t|\tplugin.get(\"foo\");\n\t\t\t\t//\t\twould be equivalent to writing:\n\t\t\t\t//\t|\tplugin._getFooAttr();\n\t\t\t\t//\t\tand:\n\t\t\t\t//\t|\tplugin.get(\"bar\");\n\t\t\t\t//\t\twould be equivalent to writing:\n\t\t\t\t//\t|\tplugin.bar;\n\t\t\t\tvar names = this._getAttrNames(name);\n\t\t\t\treturn this[names.g] ? this[names.g]() : this[name];\n\t\t\t},\n\t\n\t\t\t_setDisabledAttr: function(disabled){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to set the plugin state and call updateState to make sure the\n\t\t\t\t//\t\tbutton is updated appropriately.\n\t\t\t\tthis._set(\"disabled\", disabled);\n\t\t\t\tthis.updateState();\n\t\t\t},\n\t\n\t\t\t_getAttrNames: function(name){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHelper function for get() and set().\n\t\t\t\t//\t\tCaches attribute name values so we don't do the string ops every time.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar apn = this._attrPairNames;\n\t\t\t\tif(apn[name]){\n\t\t\t\t\treturn apn[name];\n\t\t\t\t}\n\t\t\t\tvar uc = name.charAt(0).toUpperCase() + name.substr(1);\n\t\t\t\treturn (apn[name] = {\n\t\t\t\t\ts: \"_set\" + uc + \"Attr\",\n\t\t\t\t\tg: \"_get\" + uc + \"Attr\"\n\t\t\t\t});\n\t\t\t},\n\t\n\t\t\t_set: function(/*String*/ name, /*anything*/ value){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHelper function to set new value for specified attribute\n\t\t\t\tthis[name] = value;\n\t\t\t}\n\t\t});\n\t\n\t\t// Hash mapping plugin name to factory, used for registering plugins\n\t\t_Plugin.registry = {};\n\t\n\t\treturn _Plugin;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 153:\n/*!********************************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/plugins/EnterKeyHandling.js ***!\n  \\********************************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/dom-construct */ 39), // domConstruct.destroy domConstruct.place\n\t\t__webpack_require__(/*! dojo/keys */ 47), // keys.ENTER\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9),\n\t\t__webpack_require__(/*! dojo/on */ 25),\n\t\t__webpack_require__(/*! dojo/sniff */ 10), // has(\"ie\") has(\"mozilla\") has(\"webkit\")\n\t\t__webpack_require__(/*! dojo/_base/window */ 15), // win.withGlobal\n\t\t__webpack_require__(/*! dojo/window */ 63), // winUtils.scrollIntoView\n\t\t__webpack_require__(/*! ../_Plugin */ 152),\n\t\t__webpack_require__(/*! ../RichText */ 154),\n\t\t__webpack_require__(/*! ../range */ 157)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(declare, domConstruct, keys, lang, on, has, win, winUtils, _Plugin, RichText, rangeapi){\n\t\n\t\t// module:\n\t\t//\t\tdijit/_editor/plugins/EnterKeyHandling\n\t\n\t\treturn declare(\"dijit._editor.plugins.EnterKeyHandling\", _Plugin, {\n\t\t\t// summary:\n\t\t\t//\t\tThis plugin tries to make all browsers behave consistently with regard to\n\t\t\t//\t\thow ENTER behaves in the editor window.  It traps the ENTER key and alters\n\t\t\t//\t\tthe way DOM is constructed in certain cases to try to commonize the generated\n\t\t\t//\t\tDOM and behaviors across browsers.\n\t\t\t//\n\t\t\t// description:\n\t\t\t//\t\tThis plugin has three modes:\n\t\t\t//\n\t\t\t//\t\t- blockNodeForEnter=BR\n\t\t\t//\t\t- blockNodeForEnter=DIV\n\t\t\t//\t\t- blockNodeForEnter=P\n\t\t\t//\n\t\t\t//\t\tIn blockNodeForEnter=P, the ENTER key starts a new\n\t\t\t//\t\tparagraph, and shift-ENTER starts a new line in the current paragraph.\n\t\t\t//\t\tFor example, the input:\n\t\t\t//\n\t\t\t//\t|\tfirst paragraph <shift-ENTER>\n\t\t\t//\t|\tsecond line of first paragraph <ENTER>\n\t\t\t//\t|\tsecond paragraph\n\t\t\t//\n\t\t\t//\t\twill generate:\n\t\t\t//\n\t\t\t//\t|\t<p>\n\t\t\t//\t|\t\tfirst paragraph\n\t\t\t//\t|\t\t<br/>\n\t\t\t//\t|\t\tsecond line of first paragraph\n\t\t\t//\t|\t</p>\n\t\t\t//\t|\t<p>\n\t\t\t//\t|\t\tsecond paragraph\n\t\t\t//\t|\t</p>\n\t\t\t//\n\t\t\t//\t\tIn BR and DIV mode, the ENTER key conceptually goes to a new line in the\n\t\t\t//\t\tcurrent paragraph, and users conceptually create a new paragraph by pressing ENTER twice.\n\t\t\t//\t\tFor example, if the user enters text into an editor like this:\n\t\t\t//\n\t\t\t//\t|\t\tone <ENTER>\n\t\t\t//\t|\t\ttwo <ENTER>\n\t\t\t//\t|\t\tthree <ENTER>\n\t\t\t//\t|\t\t<ENTER>\n\t\t\t//\t|\t\tfour <ENTER>\n\t\t\t//\t|\t\tfive <ENTER>\n\t\t\t//\t|\t\tsix <ENTER>\n\t\t\t//\n\t\t\t//\t\tIt will appear on the screen as two 'paragraphs' of three lines each.  Markupwise, this generates:\n\t\t\t//\n\t\t\t//\t\tBR:\n\t\t\t//\t|\t\tone<br/>\n\t\t\t//\t|\t\ttwo<br/>\n\t\t\t//\t|\t\tthree<br/>\n\t\t\t//\t|\t\t<br/>\n\t\t\t//\t|\t\tfour<br/>\n\t\t\t//\t|\t\tfive<br/>\n\t\t\t//\t|\t\tsix<br/>\n\t\t\t//\n\t\t\t//\t\tDIV:\n\t\t\t//\t|\t\t<div>one</div>\n\t\t\t//\t|\t\t<div>two</div>\n\t\t\t//\t|\t\t<div>three</div>\n\t\t\t//\t|\t\t<div>&nbsp;</div>\n\t\t\t//\t|\t\t<div>four</div>\n\t\t\t//\t|\t\t<div>five</div>\n\t\t\t//\t|\t\t<div>six</div>\n\t\n\t\t\t// blockNodeForEnter: String\n\t\t\t//\t\tThis property decides the behavior of Enter key. It can be either P,\n\t\t\t//\t\tDIV, BR, or empty (which means disable this feature). Anything else\n\t\t\t//\t\twill trigger errors.  The default is 'BR'\n\t\t\t//\n\t\t\t//\t\tSee class description for more details.\n\t\t\tblockNodeForEnter: 'BR',\n\t\n\t\t\tconstructor: function(args){\n\t\t\t\tif(args){\n\t\t\t\t\tif(\"blockNodeForEnter\" in args){\n\t\t\t\t\t\targs.blockNodeForEnter = args.blockNodeForEnter.toUpperCase();\n\t\t\t\t\t}\n\t\t\t\t\tlang.mixin(this, args);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tsetEditor: function(editor){\n\t\t\t\t// Overrides _Plugin.setEditor().\n\t\t\t\tif(this.editor === editor){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.editor = editor;\n\t\t\t\tif(this.blockNodeForEnter == 'BR'){\n\t\t\t\t\t// While Moz has a mode tht mostly works, it's still a little different,\n\t\t\t\t\t// So, try to just have a common mode and be consistent.  Which means\n\t\t\t\t\t// we need to enable customUndo, if not already enabled.\n\t\t\t\t\tthis.editor.customUndo = true;\n\t\t\t\t\teditor.onLoadDeferred.then(lang.hitch(this, function(d){\n\t\t\t\t\t\tthis.own(on(editor.document, \"keydown\", lang.hitch(this, function(e){\n\t\t\t\t\t\t\tif(e.keyCode == keys.ENTER){\n\t\t\t\t\t\t\t\t// Just do it manually.  The handleEnterKey has a shift mode that\n\t\t\t\t\t\t\t\t// Always acts like <br>, so just use it.\n\t\t\t\t\t\t\t\tvar ne = lang.mixin({}, e);\n\t\t\t\t\t\t\t\tne.shiftKey = true;\n\t\t\t\t\t\t\t\tif(!this.handleEnterKey(ne)){\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})));\n\t\t\t\t\t\tif(has(\"ie\") >= 9 && has(\"ie\") <= 10){\n\t\t\t\t\t\t\tthis.own(on(editor.document, \"paste\", lang.hitch(this, function(e){\n\t\t\t\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\n\t\t\t\t\t\t\t\t\t// Use the old range/selection code to kick IE 9 into updating\n\t\t\t\t\t\t\t\t\t// its range by moving it back, then forward, one 'character'.\n\t\t\t\t\t\t\t\t\tvar r = this.editor.document.selection.createRange();\n\t\t\t\t\t\t\t\t\tr.move('character', -1);\n\t\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t\t\tr.move('character', 1);\n\t\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t\t}), 0);\n\t\t\t\t\t\t\t})));\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn d;\n\t\t\t\t\t}));\n\t\t\t\t}else if(this.blockNodeForEnter){\n\t\t\t\t\t// add enter key handler\n\t\t\t\t\tvar h = lang.hitch(this, \"handleEnterKey\");\n\t\t\t\t\teditor.addKeyHandler(13, 0, 0, h); //enter\n\t\t\t\t\teditor.addKeyHandler(13, 0, 1, h); //shift+enter\n\t\t\t\t\tthis.own(this.editor.on('KeyPressed', lang.hitch(this, 'onKeyPressed')));\n\t\t\t\t}\n\t\t\t},\n\t\t\tonKeyPressed: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for after the user has pressed a key, and the display has been updated.\n\t\t\t\t//\t\tConnected to RichText's onKeyPressed() method.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this._checkListLater){\n\t\t\t\t\tif(this.editor.selection.isCollapsed()){\n\t\t\t\t\t\tvar liparent = this.editor.selection.getAncestorElement('LI');\n\t\t\t\t\t\tif(!liparent){\n\t\t\t\t\t\t\t// circulate the undo detection code by calling RichText::execCommand directly\n\t\t\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'formatblock', this.blockNodeForEnter);\n\t\t\t\t\t\t\t// set the innerHTML of the new block node\n\t\t\t\t\t\t\tvar block = this.editor.selection.getAncestorElement(this.blockNodeForEnter);\n\t\t\t\t\t\t\tif(block){\n\t\t\t\t\t\t\t\tblock.innerHTML = this.bogusHtmlContent;\n\t\t\t\t\t\t\t\tif(has(\"ie\") <= 9){\n\t\t\t\t\t\t\t\t\t// move to the start by moving backwards one char\n\t\t\t\t\t\t\t\t\tvar r = this.editor.document.selection.createRange();\n\t\t\t\t\t\t\t\t\tr.move('character', -1);\n\t\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tconsole.error('onKeyPressed: Cannot find the new block node'); // FIXME\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t\t\tif(liparent.parentNode.parentNode.nodeName == 'LI'){\n\t\t\t\t\t\t\t\t\tliparent = liparent.parentNode.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar fc = liparent.firstChild;\n\t\t\t\t\t\t\tif(fc && fc.nodeType == 1 && (fc.nodeName == 'UL' || fc.nodeName == 'OL')){\n\t\t\t\t\t\t\t\tliparent.insertBefore(fc.ownerDocument.createTextNode('\\xA0'), fc);\n\t\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(liparent.firstChild, 0);\n\t\t\t\t\t\t\t\tvar selection = rangeapi.getSelection(this.editor.window, true);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._checkListLater = false;\n\t\t\t\t}\n\t\t\t\tif(this._pressedEnterInBlock){\n\t\t\t\t\t// the new created is the original current P, so we have previousSibling below\n\t\t\t\t\tif(this._pressedEnterInBlock.previousSibling){\n\t\t\t\t\t\tthis.removeTrailingBr(this._pressedEnterInBlock.previousSibling);\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._pressedEnterInBlock;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t// bogusHtmlContent: [private] String\n\t\t\t//\t\tHTML to stick into a new empty block\n\t\t\tbogusHtmlContent: '&#160;', // &nbsp;\n\t\n\t\t\t// blockNodes: [private] Regex\n\t\t\t//\t\tRegex for testing if a given tag is a block level (display:block) tag\n\t\t\tblockNodes: /^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,\n\t\n\t\t\thandleEnterKey: function(e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for enter key events when blockNodeForEnter is DIV or P.\n\t\t\t\t// description:\n\t\t\t\t//\t\tManually handle enter key event to make the behavior consistent across\n\t\t\t\t//\t\tall supported browsers. See class description for details.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar selection, range, newrange, startNode, endNode, brNode, doc = this.editor.document, br, rs, txt;\n\t\t\t\tif(e.shiftKey){        // shift+enter always generates <br>\n\t\t\t\t\tvar parent = this.editor.selection.getParentElement();\n\t\t\t\t\tvar header = rangeapi.getAncestor(parent, this.blockNodes);\n\t\t\t\t\tif(header){\n\t\t\t\t\t\tif(header.tagName == 'LI'){\n\t\t\t\t\t\t\treturn true; // let browser handle\n\t\t\t\t\t\t}\n\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\tif(!range.collapsed){\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rangeapi.atBeginningOfContainer(header, range.startContainer, range.startOffset)){\n\t\t\t\t\t\t\tbr = doc.createElement('br');\n\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\theader.insertBefore(br, header.firstChild);\n\t\t\t\t\t\t\tnewrange.setStartAfter(br);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t}else if(rangeapi.atEndOfContainer(header, range.startContainer, range.startOffset)){\n\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\tbr = doc.createElement('br');\n\t\t\t\t\t\t\theader.appendChild(br);\n\t\t\t\t\t\t\theader.appendChild(doc.createTextNode('\\xA0'));\n\t\t\t\t\t\t\tnewrange.setStart(header.lastChild, 0);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, range.startOffset));\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(range.startOffset));\n\t\t\t\t\t\t\t\tbrNode = doc.createElement(\"br\");\n\t\n\t\t\t\t\t\t\t\tif(endNode.nodeValue == \"\" && has(\"webkit\")){\n\t\t\t\t\t\t\t\t\tendNode = doc.createTextNode('\\xA0')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.place(brNode, startNode, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true; // let browser handle\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t\tif(range && range.startContainer){\n\t\t\t\t\t\t\t\tif(!range.collapsed){\n\t\t\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\n\t\t\t\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\n\t\t\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t\t\t\tbrNode = doc.createElement(\"br\");\n\t\n\t\t\t\t\t\t\t\t\tif(!endNode.length){\n\t\t\t\t\t\t\t\t\t\t// Create dummy text with a &nbsp to go after the BR, to prevent IE crash.\n\t\t\t\t\t\t\t\t\t\t// See https://bugs.dojotoolkit.org/ticket/12008 for details.\n\t\t\t\t\t\t\t\t\t\tendNode = doc.createTextNode('\\xA0');\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomConstruct.place(brNode, startNode, \"after\");\n\t\t\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\t\t\tnewrange.setEnd(endNode, endNode.length);\n\t\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\t\tthis.editor.selection.collapse(true);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tvar targetNode;\n\t\t\t\t\t\t\t\t\tif(range.startOffset >= 0){\n\t\t\t\t\t\t\t\t\t\ttargetNode = rs.childNodes[range.startOffset];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar brNode = doc.createElement(\"br\");\n\t\t\t\t\t\t\t\t\tvar endNode = doc.createTextNode('\\xA0');\n\t\t\t\t\t\t\t\t\tif(!targetNode){\n\t\t\t\t\t\t\t\t\t\trs.appendChild(brNode);\n\t\t\t\t\t\t\t\t\t\trs.appendChild(endNode);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(brNode, targetNode, \"before\");\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\t\t\tnewrange.setEnd(endNode, endNode.length);\n\t\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\t\tthis.editor.selection.collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// \\xA0 dummy text node remains, but is stripped before get(\"value\")\n\t\t\t\t\t\t\t\t// by RichText._stripTrailingEmptyNodes().  Still, could we just use a plain\n\t\t\t\t\t\t\t\t// space (\" \") instead?\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// don't change this: do not call this.execCommand, as that may have other logic in subclass\n\t\t\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'inserthtml', '<br>');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar _letBrowserHandle = true;\n\t\n\t\t\t\t// first remove selection\n\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\tif(!range.collapsed){\n\t\t\t\t\trange.deleteContents();\n\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t}\n\t\n\t\t\t\tvar block = rangeapi.getBlockAncestor(range.endContainer, null, this.editor.editNode);\n\t\t\t\tvar blockNode = block.blockNode;\n\t\n\t\t\t\t// if this is under a LI or the parent of the blockNode is LI, just let browser to handle it\n\t\t\t\tif((this._checkListLater = (blockNode && (blockNode.nodeName == 'LI' || blockNode.parentNode.nodeName == 'LI')))){\n\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\t\tthis._pressedEnterInBlock = blockNode;\n\t\t\t\t\t}\n\t\t\t\t\t// if this li only contains spaces, set the content to empty so the browser will outdent this item\n\t\t\t\t\tif(/^(\\s|&nbsp;|&#160;|\\xA0|<span\\b[^>]*\\bclass=['\"]Apple-style-span['\"][^>]*>(\\s|&nbsp;|&#160;|\\xA0)<\\/span>)?(<br>)?$/.test(blockNode.innerHTML)){\n\t\t\t\t\t\t// empty LI node\n\t\t\t\t\t\tblockNode.innerHTML = '';\n\t\t\t\t\t\tif(has(\"webkit\")){ // WebKit tosses the range when innerHTML is reset\n\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\tnewrange.setStart(blockNode, 0);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._checkListLater = false; // nothing to check since the browser handles outdent\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t\t// text node directly under body, let's wrap them in a node\n\t\t\t\tif(!block.blockNode || block.blockNode === this.editor.editNode){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'formatblock', this.blockNodeForEnter);\n\t\t\t\t\t}catch(e2){ /*squelch FF3 exception bug when editor content is a single BR*/\n\t\t\t\t\t}\n\t\t\t\t\t// get the newly created block node\n\t\t\t\t\t// FIXME\n\t\t\t\t\tblock = {blockNode: this.editor.selection.getAncestorElement(this.blockNodeForEnter),\n\t\t\t\t\t\tblockContainer: this.editor.editNode};\n\t\t\t\t\tif(block.blockNode){\n\t\t\t\t\t\tif(block.blockNode != this.editor.editNode &&\n\t\t\t\t\t\t\t(!(block.blockNode.textContent || block.blockNode.innerHTML).replace(/^\\s+|\\s+$/g, \"\").length)){\n\t\t\t\t\t\t\tthis.removeTrailingBr(block.blockNode);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{    // we shouldn't be here if formatblock worked\n\t\t\t\t\t\tblock.blockNode = this.editor.editNode;\n\t\t\t\t\t}\n\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t}\n\t\n\t\t\t\tvar newblock = doc.createElement(this.blockNodeForEnter);\n\t\t\t\tnewblock.innerHTML = this.bogusHtmlContent;\n\t\t\t\tthis.removeTrailingBr(block.blockNode);\n\t\t\t\tvar endOffset = range.endOffset;\n\t\t\t\tvar node = range.endContainer;\n\t\t\t\tif(node.length < endOffset){\n\t\t\t\t\t//We are not checking the right node, try to locate the correct one\n\t\t\t\t\tvar ret = this._adjustNodeAndOffset(node, endOffset);\n\t\t\t\t\tnode = ret.node;\n\t\t\t\t\tendOffset = ret.offset;\n\t\t\t\t}\n\t\t\t\tif(rangeapi.atEndOfContainer(block.blockNode, node, endOffset)){\n\t\t\t\t\tif(block.blockNode === block.blockContainer){\n\t\t\t\t\t\tblock.blockNode.appendChild(newblock);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdomConstruct.place(newblock, block.blockNode, \"after\");\n\t\t\t\t\t}\n\t\t\t\t\t_letBrowserHandle = false;\n\t\t\t\t\t// lets move caret to the newly created block\n\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\tif(this.editor.height){\n\t\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t\t}\n\t\t\t\t}else if(rangeapi.atBeginningOfContainer(block.blockNode,\n\t\t\t\t\trange.startContainer, range.startOffset)){\n\t\t\t\t\tdomConstruct.place(newblock, block.blockNode, block.blockNode === block.blockContainer ? \"first\" : \"before\");\n\t\t\t\t\tif(newblock.nextSibling && this.editor.height){\n\t\t\t\t\t\t// position input caret - mostly WebKit needs this\n\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\tnewrange.setStart(newblock.nextSibling, 0);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t// browser does not scroll the caret position into view, do it manually\n\t\t\t\t\t\twinUtils.scrollIntoView(newblock.nextSibling);\n\t\t\t\t\t}\n\t\t\t\t\t_letBrowserHandle = false;\n\t\t\t\t}else{ //press enter in the middle of P/DIV/Whatever/\n\t\t\t\t\tif(block.blockNode === block.blockContainer){\n\t\t\t\t\t\tblock.blockNode.appendChild(newblock);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdomConstruct.place(newblock, block.blockNode, \"after\");\n\t\t\t\t\t}\n\t\t\t\t\t_letBrowserHandle = false;\n\t\n\t\t\t\t\t// Clone any block level styles.\n\t\t\t\t\tif(block.blockNode.style){\n\t\t\t\t\t\tif(newblock.style){\n\t\t\t\t\t\t\tif(block.blockNode.style.cssText){\n\t\t\t\t\t\t\t\tnewblock.style.cssText = block.blockNode.style.cssText;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Okay, we probably have to split.\n\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\tvar firstNodeMoved;\n\t\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\tvar nodeToMove, tNode;\n\t\t\t\t\t\tendOffset = range.endOffset;\n\t\t\t\t\t\tif(rs.length < endOffset){\n\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, endOffset);\n\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\tendOffset = ret.offset;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, endOffset));\n\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(endOffset, txt.length));\n\t\n\t\t\t\t\t\t// Place the split, then remove original nodes.\n\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"before\");\n\t\t\t\t\t\tdomConstruct.place(endNode, rs, \"after\");\n\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\n\t\t\t\t\t\t// Okay, we split the text.  Now we need to see if we're\n\t\t\t\t\t\t// parented to the block element we're splitting and if\n\t\t\t\t\t\t// not, we have to split all the way up.  Ugh.\n\t\t\t\t\t\tvar parentC = startNode.parentNode;\n\t\t\t\t\t\twhile(parentC !== block.blockNode){\n\t\t\t\t\t\t\tvar tg = parentC.tagName;\n\t\t\t\t\t\t\tvar newTg = doc.createElement(tg);\n\t\t\t\t\t\t\t// Clone over any 'style' data.\n\t\t\t\t\t\t\tif(parentC.style){\n\t\t\t\t\t\t\t\tif(newTg.style){\n\t\t\t\t\t\t\t\t\tif(parentC.style.cssText){\n\t\t\t\t\t\t\t\t\t\tnewTg.style.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// If font also need to clone over any font data.\n\t\t\t\t\t\t\tif(parentC.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\tif(parentC.color){\n\t\t\t\t\t\t\t\t\tnewTg.color = parentC.color;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(parentC.face){\n\t\t\t\t\t\t\t\t\tnewTg.face = parentC.face;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(parentC.size){  // this check was necessary on IE\n\t\t\t\t\t\t\t\t\tnewTg.size = parentC.size;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\t\tnewTg.appendChild(nodeToMove);\n\t\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.place(newTg, parentC, \"after\");\n\t\t\t\t\t\t\tstartNode = parentC;\n\t\t\t\t\t\t\tendNode = newTg;\n\t\t\t\t\t\t\tparentC = parentC.parentNode;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Lastly, move the split out tags to the new block.\n\t\t\t\t\t\t// as they should now be split properly.\n\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\tif(nodeToMove.nodeType == 1 || (nodeToMove.nodeType == 3 && nodeToMove.nodeValue)){\n\t\t\t\t\t\t\t// Non-blank text and non-text nodes need to clear out that blank space\n\t\t\t\t\t\t\t// before moving the contents.\n\t\t\t\t\t\t\tnewblock.innerHTML = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfirstNodeMoved = nodeToMove;\n\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\tnewblock.appendChild(nodeToMove);\n\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//lets move caret to the newly created block\n\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\tvar nodeForCursor;\n\t\t\t\t\tvar innerMostFirstNodeMoved = firstNodeMoved;\n\t\t\t\t\tif(this.blockNodeForEnter !== 'BR'){\n\t\t\t\t\t\twhile(innerMostFirstNodeMoved){\n\t\t\t\t\t\t\tnodeForCursor = innerMostFirstNodeMoved;\n\t\t\t\t\t\t\ttNode = innerMostFirstNodeMoved.firstChild;\n\t\t\t\t\t\t\tinnerMostFirstNodeMoved = tNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(nodeForCursor && nodeForCursor.parentNode){\n\t\t\t\t\t\t\tnewblock = nodeForCursor.parentNode;\n\t\t\t\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tif(this.editor.height){\n\t\t\t\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\t\t\t\tthis._pressedEnterInBlock = block.blockNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_letBrowserHandle = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\tif(this.editor.height){\n\t\t\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\t\t\tthis._pressedEnterInBlock = block.blockNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn _letBrowserHandle;\n\t\t\t},\n\t\n\t\t\t_adjustNodeAndOffset: function(/*DomNode*/node, /*Int*/offset){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tIn the case there are multiple text nodes in a row the offset may not be within the node.  If the offset is larger than the node length, it will attempt to find\n\t\t\t\t//\t\tthe next text sibling until it locates the text node in which the offset refers to\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to check.\n\t\t\t\t// offset:\n\t\t\t\t//\t\tThe position to find within the text node\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate.\n\t\t\t\twhile(node.length < offset && node.nextSibling && node.nextSibling.nodeType == 3){\n\t\t\t\t\t//Adjust the offset and node in the case of multiple text nodes in a row\n\t\t\t\t\toffset = offset - node.length;\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn {\"node\": node, \"offset\": offset};\n\t\t\t},\n\t\n\t\t\tremoveTrailingBr: function(container){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tIf last child of container is a `<br>`, then remove it.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar para = /P|DIV|LI/i.test(container.tagName) ?\n\t\t\t\t\tcontainer : this.editor.selection.getParentOfType(container, ['P', 'DIV', 'LI']);\n\t\n\t\t\t\tif(!para){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(para.lastChild){\n\t\t\t\t\tif((para.childNodes.length > 1 && para.lastChild.nodeType == 3 && /^[\\s\\xAD]*$/.test(para.lastChild.nodeValue)) ||\n\t\t\t\t\t\tpara.lastChild.tagName == 'BR'){\n\t\n\t\t\t\t\t\tdomConstruct.destroy(para.lastChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!para.childNodes.length){\n\t\t\t\t\tpara.innerHTML = this.bogusHtmlContent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 154:\n/*!****************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/RichText.js ***!\n  \\****************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/array */ 13), // array.forEach array.indexOf array.some\n\t\t__webpack_require__(/*! dojo/_base/config */ 7), // config\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/_base/Deferred */ 101), // Deferred\n\t\t__webpack_require__(/*! dojo/dom */ 14), // dom.byId\n\t\t__webpack_require__(/*! dojo/dom-attr */ 40), // domAttr.set or get\n\t\t__webpack_require__(/*! dojo/dom-class */ 35), // domClass.add domClass.remove\n\t\t__webpack_require__(/*! dojo/dom-construct */ 39), // domConstruct.create domConstruct.destroy domConstruct.place\n\t\t__webpack_require__(/*! dojo/dom-geometry */ 36), // domGeometry.position\n\t\t__webpack_require__(/*! dojo/dom-style */ 37), // domStyle.getComputedStyle domStyle.set\n\t\t__webpack_require__(/*! dojo/_base/kernel */ 4), // kernel.deprecated\n\t\t__webpack_require__(/*! dojo/keys */ 47), // keys.BACKSPACE keys.TAB\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9), // lang.clone lang.hitch lang.isArray lang.isFunction lang.isString lang.trim\n\t\t__webpack_require__(/*! dojo/on */ 25), // on()\n\t\t__webpack_require__(/*! dojo/query */ 28), // query\n\t\t__webpack_require__(/*! dojo/domReady */ 8),\n\t\t__webpack_require__(/*! dojo/sniff */ 10), // has(\"ie\") has(\"mozilla\") has(\"opera\") has(\"safari\") has(\"webkit\")\n\t\t__webpack_require__(/*! dojo/topic */ 43), // topic.publish() (publish)\n\t\t__webpack_require__(/*! dojo/_base/unload */ 155), // unload\n\t\t__webpack_require__(/*! dojo/_base/url */ 16), // url\n\t\t__webpack_require__(/*! dojo/window */ 63), // winUtils.get()\n\t\t__webpack_require__(/*! ../_Widget */ 57),\n\t\t__webpack_require__(/*! ../_CssStateMixin */ 92),\n\t\t__webpack_require__(/*! ../selection */ 156),\n\t\t__webpack_require__(/*! ./range */ 157),\n\t\t__webpack_require__(/*! ./html */ 158),\n\t\t__webpack_require__(/*! ../focus */ 62),\n\t\t__webpack_require__(/*! ../main */ 51)    // dijit._scopeName\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(array, config, declare, Deferred, dom, domAttr, domClass, domConstruct, domGeometry, domStyle,\n\t\t\t\tkernel, keys, lang, on, query, domReady, has, topic, unload, _Url, winUtils,\n\t\t\t\t_Widget, _CssStateMixin, selectionapi, rangeapi, htmlapi, focus, dijit){\n\t\n\t\t// module:\n\t\t//\t\tdijit/_editor/RichText\n\t\n\t\t// If you want to allow for rich text saving with back/forward actions, you must add a text area to your page with\n\t\t// the id==dijit._scopeName + \"._editor.RichText.value\" (typically \"dijit/_editor/RichText.value). For example,\n\t\t// something like this will work:\n\t\t//\n\t\t//\t<textarea id=\"dijit._editor.RichText.value\" style=\"display:none;position:absolute;top:-100px;left:-100px;height:3px;width:3px;overflow:hidden;\"></textarea>\n\t\n\t\tvar RichText = declare(\"dijit._editor.RichText\", [_Widget, _CssStateMixin], {\n\t\t\t// summary:\n\t\t\t//\t\tdijit/_editor/RichText is the core of dijit.Editor, which provides basic\n\t\t\t//\t\tWYSIWYG editing features.\n\t\t\t//\n\t\t\t// description:\n\t\t\t//\t\tdijit/_editor/RichText is the core of dijit.Editor, which provides basic\n\t\t\t//\t\tWYSIWYG editing features. It also encapsulates the differences\n\t\t\t//\t\tof different js engines for various browsers.  Do not use this widget\n\t\t\t//\t\twith an HTML &lt;TEXTAREA&gt; tag, since the browser unescapes XML escape characters,\n\t\t\t//\t\tlike &lt;.  This can have unexpected behavior and lead to security issues\n\t\t\t//\t\tsuch as scripting attacks.\n\t\t\t//\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\n\t\t\tconstructor: function(params /*===== , srcNodeRef =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCreate the widget.\n\t\t\t\t// params: Object|null\n\t\t\t\t//\t\tInitial settings for any of the widget attributes, except readonly attributes.\n\t\t\t\t// srcNodeRef: DOMNode\n\t\t\t\t//\t\tThe widget replaces the specified DOMNode.\n\t\n\t\t\t\t// contentPreFilters: Function(String)[]\n\t\t\t\t//\t\tPre content filter function register array.\n\t\t\t\t//\t\tthese filters will be executed before the actual\n\t\t\t\t//\t\tediting area gets the html content.\n\t\t\t\tthis.contentPreFilters = [];\n\t\n\t\t\t\t// contentPostFilters: Function(String)[]\n\t\t\t\t//\t\tpost content filter function register array.\n\t\t\t\t//\t\tThese will be used on the resulting html\n\t\t\t\t//\t\tfrom contentDomPostFilters. The resulting\n\t\t\t\t//\t\tcontent is the final html (returned by getValue()).\n\t\t\t\tthis.contentPostFilters = [];\n\t\n\t\t\t\t// contentDomPreFilters: Function(DomNode)[]\n\t\t\t\t//\t\tPre content dom filter function register array.\n\t\t\t\t//\t\tThese filters are applied after the result from\n\t\t\t\t//\t\tcontentPreFilters are set to the editing area.\n\t\t\t\tthis.contentDomPreFilters = [];\n\t\n\t\t\t\t// contentDomPostFilters: Function(DomNode)[]\n\t\t\t\t//\t\tPost content dom filter function register array.\n\t\t\t\t//\t\tThese filters are executed on the editing area dom.\n\t\t\t\t//\t\tThe result from these will be passed to contentPostFilters.\n\t\t\t\tthis.contentDomPostFilters = [];\n\t\n\t\t\t\t// editingAreaStyleSheets: dojo._URL[]\n\t\t\t\t//\t\tarray to store all the stylesheets applied to the editing area\n\t\t\t\tthis.editingAreaStyleSheets = [];\n\t\n\t\t\t\t// Make a copy of this.events before we start writing into it, otherwise we\n\t\t\t\t// will modify the prototype which leads to bad things on pages w/multiple editors\n\t\t\t\tthis.events = [].concat(this.events);\n\t\n\t\t\t\tthis._keyHandlers = {};\n\t\n\t\t\t\tif(params && lang.isString(params.value)){\n\t\t\t\t\tthis.value = params.value;\n\t\t\t\t}\n\t\n\t\t\t\tthis.onLoadDeferred = new Deferred();\n\t\t\t},\n\t\n\t\t\tbaseClass: \"dijitEditor\",\n\t\n\t\t\t// inheritWidth: Boolean\n\t\t\t//\t\twhether to inherit the parent's width or simply use 100%\n\t\t\tinheritWidth: false,\n\t\n\t\t\t// focusOnLoad: [deprecated] Boolean\n\t\t\t//\t\tFocus into this widget when the page is loaded\n\t\t\tfocusOnLoad: false,\n\t\n\t\t\t// name: String?\n\t\t\t//\t\tSpecifies the name of a (hidden) `<textarea>` node on the page that's used to save\n\t\t\t//\t\tthe editor content on page leave.   Used to restore editor contents after navigating\n\t\t\t//\t\tto a new page and then hitting the back button.\n\t\t\tname: \"\",\n\t\n\t\t\t// styleSheets: [const] String\n\t\t\t//\t\tsemicolon (\";\") separated list of css files for the editing area\n\t\t\tstyleSheets: \"\",\n\t\n\t\t\t// height: String\n\t\t\t//\t\tSet height to fix the editor at a specific height, with scrolling.\n\t\t\t//\t\tBy default, this is 300px.  If you want to have the editor always\n\t\t\t//\t\tresizes to accommodate the content, use AlwaysShowToolbar plugin\n\t\t\t//\t\tand set height=\"\".  If this editor is used within a layout widget,\n\t\t\t//\t\tset height=\"100%\".\n\t\t\theight: \"300px\",\n\t\n\t\t\t// minHeight: String\n\t\t\t//\t\tThe minimum height that the editor should have.\n\t\t\tminHeight: \"1em\",\n\t\n\t\t\t// isClosed: [private] Boolean\n\t\t\tisClosed: true,\n\t\n\t\t\t// isLoaded: [private] Boolean\n\t\t\tisLoaded: false,\n\t\n\t\t\t// _SEPARATOR: [private] String\n\t\t\t//\t\tUsed to concat contents from multiple editors into a single string,\n\t\t\t//\t\tso they can be saved into a single `<textarea>` node.  See \"name\" attribute.\n\t\t\t_SEPARATOR: \"@@**%%__RICHTEXTBOUNDRY__%%**@@\",\n\t\n\t\t\t// _NAME_CONTENT_SEP: [private] String\n\t\t\t//\t\tUSed to separate name from content.  Just a colon isn't safe.\n\t\t\t_NAME_CONTENT_SEP: \"@@**%%:%%**@@\",\n\t\n\t\t\t// onLoadDeferred: [readonly] dojo/promise/Promise\n\t\t\t//\t\tDeferred which is fired when the editor finishes loading.\n\t\t\t//\t\tCall myEditor.onLoadDeferred.then(callback) it to be informed\n\t\t\t//\t\twhen the rich-text area initialization is finalized.\n\t\t\tonLoadDeferred: null,\n\t\n\t\t\t// isTabIndent: Boolean\n\t\t\t//\t\tMake tab key and shift-tab indent and outdent rather than navigating.\n\t\t\t//\t\tCaution: sing this makes web pages inaccessible to users unable to use a mouse.\n\t\t\tisTabIndent: false,\n\t\n\t\t\t// disableSpellCheck: [const] Boolean\n\t\t\t//\t\tWhen true, disables the browser's native spell checking, if supported.\n\t\t\t//\t\tWorks only in Firefox.\n\t\t\tdisableSpellCheck: false,\n\t\n\t\t\tpostCreate: function(){\n\t\t\t\tif(\"textarea\" === this.domNode.tagName.toLowerCase()){\n\t\t\t\t\tconsole.warn(\"RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.\");\n\t\t\t\t}\n\t\n\t\t\t\t// Push in the builtin filters now, making them the first executed, but not over-riding anything\n\t\t\t\t// users passed in.  See: #6062\n\t\t\t\tthis.contentPreFilters = [\n\t\t\t\t\tlang.trim,\t// avoid IE10 problem hitting ENTER on last line when there's a trailing \\n.\n\t\t\t\t\tlang.hitch(this, \"_preFixUrlAttributes\")\n\t\t\t\t].concat(this.contentPreFilters);\n\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\tthis.contentPreFilters = [this._normalizeFontStyle].concat(this.contentPreFilters);\n\t\t\t\t\tthis.contentPostFilters = [this._removeMozBogus].concat(this.contentPostFilters);\n\t\t\t\t}\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t// Try to clean up WebKit bogus artifacts.  The inserted classes\n\t\t\t\t\t// made by WebKit sometimes messes things up.\n\t\t\t\t\tthis.contentPreFilters = [this._removeWebkitBogus].concat(this.contentPreFilters);\n\t\t\t\t\tthis.contentPostFilters = [this._removeWebkitBogus].concat(this.contentPostFilters);\n\t\t\t\t}\n\t\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\t\t// IE generates <strong> and <em> but we want to normalize to <b> and <i>\n\t\t\t\t\t// Still happens in IE11!\n\t\t\t\t\tthis.contentPostFilters = [this._normalizeFontStyle].concat(this.contentPostFilters);\n\t\t\t\t\tthis.contentDomPostFilters = [lang.hitch(this, \"_stripBreakerNodes\")].concat(this.contentDomPostFilters);\n\t\t\t\t}\n\t\t\t\tthis.contentDomPostFilters = [lang.hitch(this, \"_stripTrailingEmptyNodes\")].concat(this.contentDomPostFilters);\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\ttopic.publish(dijit._scopeName + \"._editor.RichText::init\", this);\n\t\t\t},\n\t\n\t\t\tstartup: function(){\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\t// Don't call open() until startup() because we need to be attached to the DOM, and also if we are the\n\t\t\t\t// child of a StackContainer, let StackContainer._setupChild() do DOM manipulations before iframe is\n\t\t\t\t// created, to avoid duplicate onload call.\n\t\t\t\tthis.open();\n\t\t\t\tthis.setupDefaultShortcuts();\n\t\t\t},\n\t\n\t\t\tsetupDefaultShortcuts: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tAdd some default key handlers\n\t\t\t\t// description:\n\t\t\t\t//\t\tOverwrite this to setup your own handlers. The default\n\t\t\t\t//\t\timplementation does not use Editor commands, but directly\n\t\t\t\t//\t\texecutes the builtin commands within the underlying browser\n\t\t\t\t//\t\tsupport.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar exec = lang.hitch(this, function(cmd, arg){\n\t\t\t\t\treturn function(){\n\t\t\t\t\t\treturn !this.execCommand(cmd, arg);\n\t\t\t\t\t};\n\t\t\t\t});\n\t\n\t\t\t\tvar ctrlKeyHandlers = {\n\t\t\t\t\tb: exec(\"bold\"),\n\t\t\t\t\ti: exec(\"italic\"),\n\t\t\t\t\tu: exec(\"underline\"),\n\t\t\t\t\ta: exec(\"selectall\"),\n\t\t\t\t\ts: function(){\n\t\t\t\t\t\tthis.save(true);\n\t\t\t\t\t},\n\t\t\t\t\tm: function(){\n\t\t\t\t\t\tthis.isTabIndent = !this.isTabIndent;\n\t\t\t\t\t},\n\t\n\t\t\t\t\t\"1\": exec(\"formatblock\", \"h1\"),\n\t\t\t\t\t\"2\": exec(\"formatblock\", \"h2\"),\n\t\t\t\t\t\"3\": exec(\"formatblock\", \"h3\"),\n\t\t\t\t\t\"4\": exec(\"formatblock\", \"h4\"),\n\t\n\t\t\t\t\t\"\\\\\": exec(\"insertunorderedlist\")\n\t\t\t\t};\n\t\n\t\t\t\tif(!has(\"ie\")){\n\t\t\t\t\tctrlKeyHandlers.Z = exec(\"redo\"); //FIXME: undo?\n\t\t\t\t}\n\t\n\t\t\t\tvar key;\n\t\t\t\tfor(key in ctrlKeyHandlers){\n\t\t\t\t\tthis.addKeyHandler(key, true, false, ctrlKeyHandlers[key]);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t// events: [private] String[]\n\t\t\t//\t\t events which should be connected to the underlying editing area\n\t\t\tevents: [\"onKeyDown\", \"onKeyUp\"], // onClick handled specially\n\t\n\t\t\t// captureEvents: [deprecated] String[]\n\t\t\t//\t\t Events which should be connected to the underlying editing\n\t\t\t//\t\t area, events in this array will be addListener with\n\t\t\t//\t\t capture=true.\n\t\t\t// TODO: looking at the code I don't see any distinction between events and captureEvents,\n\t\t\t// so get rid of this for 2.0 if not sooner\n\t\t\tcaptureEvents: [],\n\t\n\t\t\t_editorCommandsLocalized: false,\n\t\t\t_localizeEditorCommands: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tWhen IE is running in a non-English locale, the API actually changes,\n\t\t\t\t//\t\tso that we have to say (for example) danraku instead of p (for paragraph).\n\t\t\t\t//\t\tHandle that here.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(RichText._editorCommandsLocalized){\n\t\t\t\t\t// Use the already generate cache of mappings.\n\t\t\t\t\tthis._local2NativeFormatNames = RichText._local2NativeFormatNames;\n\t\t\t\t\tthis._native2LocalFormatNames = RichText._native2LocalFormatNames;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tRichText._editorCommandsLocalized = true;\n\t\t\t\tRichText._local2NativeFormatNames = {};\n\t\t\t\tRichText._native2LocalFormatNames = {};\n\t\t\t\tthis._local2NativeFormatNames = RichText._local2NativeFormatNames;\n\t\t\t\tthis._native2LocalFormatNames = RichText._native2LocalFormatNames;\n\t\t\t\t//in IE, names for blockformat is locale dependent, so we cache the values here\n\t\n\t\t\t\t//put p after div, so if IE returns Normal, we show it as paragraph\n\t\t\t\t//We can distinguish p and div if IE returns Normal, however, in order to detect that,\n\t\t\t\t//we have to call this.document.selection.createRange().parentElement() or such, which\n\t\t\t\t//could slow things down. Leave it as it is for now\n\t\t\t\tvar formats = ['div', 'p', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'ol', 'ul', 'address'];\n\t\t\t\tvar localhtml = \"\", format, i = 0;\n\t\t\t\twhile((format = formats[i++])){\n\t\t\t\t\t//append a <br> after each element to separate the elements more reliably\n\t\t\t\t\tif(format.charAt(1) !== 'l'){\n\t\t\t\t\t\tlocalhtml += \"<\" + format + \"><span>content</span></\" + format + \"><br/>\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlocalhtml += \"<\" + format + \"><li>content</li></\" + format + \"><br/>\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// queryCommandValue returns empty if we hide editNode, so move it out of screen temporary\n\t\t\t\t// Also, IE9 does weird stuff unless we do it inside the editor iframe.\n\t\t\t\tvar style = { position: \"absolute\", top: \"0px\", zIndex: 10, opacity: 0.01 };\n\t\t\t\tvar div = domConstruct.create('div', {style: style, innerHTML: localhtml});\n\t\t\t\tthis.ownerDocumentBody.appendChild(div);\n\t\n\t\t\t\t// IE9 has a timing issue with doing this right after setting\n\t\t\t\t// the inner HTML, so put a delay in.\n\t\t\t\tvar inject = lang.hitch(this, function(){\n\t\t\t\t\tvar node = div.firstChild;\n\t\t\t\t\twhile(node){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tthis.selection.selectElement(node.firstChild);\n\t\t\t\t\t\t\tvar nativename = node.tagName.toLowerCase();\n\t\t\t\t\t\t\tthis._local2NativeFormatNames[nativename] = document.queryCommandValue(\"formatblock\");\n\t\t\t\t\t\t\tthis._native2LocalFormatNames[this._local2NativeFormatNames[nativename]] = nativename;\n\t\t\t\t\t\t\tnode = node.nextSibling.nextSibling;\n\t\t\t\t\t\t\t//console.log(\"Mapped: \", nativename, \" to: \", this._local2NativeFormatNames[nativename]);\n\t\t\t\t\t\t}catch(e){ /*Sqelch the occasional IE9 error */\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomConstruct.destroy(div);\n\t\t\t\t});\n\t\t\t\tthis.defer(inject);\n\t\t\t},\n\t\n\t\t\topen: function(/*DomNode?*/ element){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tTransforms the node referenced in this.domNode into a rich text editing\n\t\t\t\t//\t\tnode.\n\t\t\t\t// description:\n\t\t\t\t//\t\tSets up the editing area asynchronously. This will result in\n\t\t\t\t//\t\tthe creation and replacement with an iframe.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tif(!this.onLoadDeferred || this.onLoadDeferred.fired >= 0){\n\t\t\t\t\tthis.onLoadDeferred = new Deferred();\n\t\t\t\t}\n\t\n\t\t\t\tif(!this.isClosed){\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t\ttopic.publish(dijit._scopeName + \"._editor.RichText::open\", this);\n\t\n\t\t\t\tif(arguments.length === 1 && element.nodeName){ // else unchanged\n\t\t\t\t\tthis.domNode = element;\n\t\t\t\t}\n\t\n\t\t\t\tvar dn = this.domNode;\n\t\n\t\t\t\t// Compute initial value of the editor\n\t\t\t\tvar html;\n\t\t\t\tif(lang.isString(this.value)){\n\t\t\t\t\t// Allow setting the editor content programmatically instead of\n\t\t\t\t\t// relying on the initial content being contained within the target\n\t\t\t\t\t// domNode.\n\t\t\t\t\thtml = this.value;\n\t\t\t\t\tdn.innerHTML = \"\";\n\t\t\t\t}else if(dn.nodeName && dn.nodeName.toLowerCase() == \"textarea\"){\n\t\t\t\t\t// if we were created from a textarea, then we need to create a\n\t\t\t\t\t// new editing harness node.\n\t\t\t\t\tvar ta = (this.textarea = dn);\n\t\t\t\t\tthis.name = ta.name;\n\t\t\t\t\thtml = ta.value;\n\t\t\t\t\tdn = this.domNode = this.ownerDocument.createElement(\"div\");\n\t\t\t\t\tdn.setAttribute('widgetId', this.id);\n\t\t\t\t\tta.removeAttribute('widgetId');\n\t\t\t\t\tdn.cssText = ta.cssText;\n\t\t\t\t\tdn.className += \" \" + ta.className;\n\t\t\t\t\tdomConstruct.place(dn, ta, \"before\");\n\t\t\t\t\tvar tmpFunc = lang.hitch(this, function(){\n\t\t\t\t\t\t//some browsers refuse to submit display=none textarea, so\n\t\t\t\t\t\t//move the textarea off screen instead\n\t\t\t\t\t\tdomStyle.set(ta, {\n\t\t\t\t\t\t\tdisplay: \"block\",\n\t\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\t\ttop: \"-1000px\"\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif(has(\"ie\")){ //nasty IE bug: abnormal formatting if overflow is not hidden\n\t\t\t\t\t\t\tvar s = ta.style;\n\t\t\t\t\t\t\tthis.__overflow = s.overflow;\n\t\t\t\t\t\t\ts.overflow = \"hidden\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t\tthis.defer(tmpFunc, 10);\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpFunc();\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(ta.form){\n\t\t\t\t\t\tvar resetValue = ta.value;\n\t\t\t\t\t\tthis.reset = function(){\n\t\t\t\t\t\t\tvar current = this.getValue();\n\t\t\t\t\t\t\tif(current !== resetValue){\n\t\t\t\t\t\t\t\tthis.replaceValue(resetValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\ton(ta.form, \"submit\", lang.hitch(this, function(){\n\t\t\t\t\t\t\t// Copy value to the <textarea> so it gets submitted along with form.\n\t\t\t\t\t\t\t// FIXME: should we be calling close() here instead?\n\t\t\t\t\t\t\tdomAttr.set(ta, 'disabled', this.disabled); // don't submit the value if disabled\n\t\t\t\t\t\t\tta.value = this.getValue();\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\thtml = htmlapi.getChildrenHtml(dn);\n\t\t\t\t\tdn.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis.value = html;\n\t\n\t\t\t\t// If we're a list item we have to put in a blank line to force the\n\t\t\t\t// bullet to nicely align at the top of text\n\t\t\t\tif(dn.nodeName && dn.nodeName === \"LI\"){\n\t\t\t\t\tdn.innerHTML = \" <br>\";\n\t\t\t\t}\n\t\n\t\t\t\t// Construct the editor div structure.\n\t\t\t\tthis.header = dn.ownerDocument.createElement(\"div\");\n\t\t\t\tdn.appendChild(this.header);\n\t\t\t\tthis.editingArea = dn.ownerDocument.createElement(\"div\");\n\t\t\t\tdn.appendChild(this.editingArea);\n\t\t\t\tthis.footer = dn.ownerDocument.createElement(\"div\");\n\t\t\t\tdn.appendChild(this.footer);\n\t\n\t\t\t\tif(!this.name){\n\t\t\t\t\tthis.name = this.id + \"_AUTOGEN\";\n\t\t\t\t}\n\t\n\t\t\t\t// User has pressed back/forward button so we lost the text in the editor, but it's saved\n\t\t\t\t// in a hidden <textarea> (which contains the data for all the editors on this page),\n\t\t\t\t// so get editor value from there\n\t\t\t\tif(this.name !== \"\" && (!config[\"useXDomain\"] || config[\"allowXdRichTextSave\"])){\n\t\t\t\t\tvar saveTextarea = dom.byId(dijit._scopeName + \"._editor.RichText.value\");\n\t\t\t\t\tif(saveTextarea && saveTextarea.value !== \"\"){\n\t\t\t\t\t\tvar datas = saveTextarea.value.split(this._SEPARATOR), i = 0, dat;\n\t\t\t\t\t\twhile((dat = datas[i++])){\n\t\t\t\t\t\t\tvar data = dat.split(this._NAME_CONTENT_SEP);\n\t\t\t\t\t\t\tif(data[0] === this.name){\n\t\t\t\t\t\t\t\tthis.value = data[1];\n\t\t\t\t\t\t\t\tdatas = datas.splice(i, 1);\n\t\t\t\t\t\t\t\tsaveTextarea.value = datas.join(this._SEPARATOR);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(!RichText._globalSaveHandler){\n\t\t\t\t\t\tRichText._globalSaveHandler = {};\n\t\t\t\t\t\tunload.addOnUnload(function(){\n\t\t\t\t\t\t\tvar id;\n\t\t\t\t\t\t\tfor(id in RichText._globalSaveHandler){\n\t\t\t\t\t\t\t\tvar f = RichText._globalSaveHandler[id];\n\t\t\t\t\t\t\t\tif(lang.isFunction(f)){\n\t\t\t\t\t\t\t\t\tf();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tRichText._globalSaveHandler[this.id] = lang.hitch(this, \"_saveContent\");\n\t\t\t\t}\n\t\n\t\t\t\tthis.isClosed = false;\n\t\n\t\t\t\tvar ifr = (this.editorObject = this.iframe = this.ownerDocument.createElement('iframe'));\n\t\t\t\tifr.id = this.id + \"_iframe\";\n\t\t\t\tifr.style.border = \"none\";\n\t\t\t\tifr.style.width = \"100%\";\n\t\t\t\tif(this._layoutMode){\n\t\t\t\t\t// iframe should be 100% height, thus getting it's height from surrounding\n\t\t\t\t\t// <div> (which has the correct height set by Editor)\n\t\t\t\t\tifr.style.height = \"100%\";\n\t\t\t\t}else{\n\t\t\t\t\tif(has(\"ie\") >= 7){\n\t\t\t\t\t\tif(this.height){\n\t\t\t\t\t\t\tifr.style.height = this.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.minHeight){\n\t\t\t\t\t\t\tifr.style.minHeight = this.minHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tifr.style.height = this.height ? this.height : this.minHeight;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tifr.frameBorder = 0;\n\t\t\t\tifr._loadFunc = lang.hitch(this, function(w){\n\t\t\t\t\t// This method is called when the editor is first loaded and also if the Editor's\n\t\t\t\t\t// dom node is repositioned. Unfortunately repositioning the Editor tends to\n\t\t\t\t\t// clear the iframe's contents, so we can't just no-op in that case.\n\t\n\t\t\t\t\tthis.window = w;\n\t\t\t\t\tthis.document = w.document;\n\t\n\t\t\t\t\t// instantiate class to access selected text in editor's iframe\n\t\t\t\t\tthis.selection = new selectionapi.SelectionManager(w);\n\t\n\t\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t\tthis._localizeEditorCommands();\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Do final setup and set contents of editor.\n\t\t\t\t\t// Use get(\"value\") rather than html in case _loadFunc() is being called for a second time\n\t\t\t\t\t// because editor's DOMNode was repositioned.\n\t\t\t\t\tthis.onLoad(this.get(\"value\"));\n\t\t\t\t});\n\t\n\t\t\t\t// Attach iframe to document, and set the initial (blank) content.\n\t\t\t\tvar src = this._getIframeDocTxt().replace(/\\\\/g, \"\\\\\\\\\").replace(/'/g, \"\\\\'\"),\n\t\t\t\t\ts;\n\t\n\t\t\t\t// IE10 and earlier will throw an \"Access is denied\" error when attempting to access the parent frame if\n\t\t\t\t// document.domain has been set, unless the child frame also has the same document.domain set. The child frame\n\t\t\t\t// can only set document.domain while the document is being constructed using open/write/close; attempting to\n\t\t\t\t// set it later results in a different \"This method can't be used in this context\" error. See #17529\n\t\t\t\tif (has(\"ie\") < 11) {\n\t\t\t\t\ts = 'javascript:document.open();try{parent.window;}catch(e){document.domain=\"' + document.domain + '\";}' +\n\t\t\t\t\t\t'document.write(\\'' + src + '\\');document.close()';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ts = \"javascript: '\" + src + \"'\";\n\t\t\t\t}\n\t\n\t\t\t\tif(has(\"ie\") == 9){\n\t\t\t\t\t// On IE9, attach to document before setting the content, to avoid problem w/iframe running in\n\t\t\t\t\t// wrong security context, see #16633.\n\t\t\t\t\tthis.editingArea.appendChild(ifr);\n\t\t\t\t\tifr.src = s;\n\t\t\t\t}else{\n\t\t\t\t\t// For other browsers, set src first, especially for IE6/7 where attaching first gives a warning on\n\t\t\t\t\t// https:// about \"this page contains secure and insecure items, do you want to view both?\"\n\t\t\t\t\tifr.setAttribute('src', s);\n\t\t\t\t\tthis.editingArea.appendChild(ifr);\n\t\t\t\t}\n\t\n\t\t\t\t// TODO: this is a guess at the default line-height, kinda works\n\t\t\t\tif(dn.nodeName === \"LI\"){\n\t\t\t\t\tdn.lastChild.style.marginTop = \"-1.2em\";\n\t\t\t\t}\n\t\n\t\t\t\tdomClass.add(this.domNode, this.baseClass);\n\t\t\t},\n\t\n\t\t\t//static cache variables shared among all instance of this class\n\t\t\t_local2NativeFormatNames: {},\n\t\t\t_native2LocalFormatNames: {},\n\t\n\t\t\t_getIframeDocTxt: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tGenerates the boilerplate text of the document inside the iframe (ie, `<html><head>...</head><body/></html>`).\n\t\t\t\t//\t\tEditor content (if not blank) should be added afterwards.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar _cs = domStyle.getComputedStyle(this.domNode);\n\t\n\t\t\t\t// The contents inside of <body>.  The real contents are set later via a call to setValue().\n\t\t\t\t// In auto-expand mode, need a wrapper div for AlwaysShowToolbar plugin to correctly\n\t\t\t\t// expand/contract the editor as the content changes.\n\t\t\t\tvar html = \"<div id='dijitEditorBody'></div>\";\n\t\n\t\t\t\tvar font = [ _cs.fontWeight, _cs.fontSize, _cs.fontFamily ].join(\" \");\n\t\n\t\t\t\t// line height is tricky - applying a units value will mess things up.\n\t\t\t\t// if we can't get a non-units value, bail out.\n\t\t\t\tvar lineHeight = _cs.lineHeight;\n\t\t\t\tif(lineHeight.indexOf(\"px\") >= 0){\n\t\t\t\t\tlineHeight = parseFloat(lineHeight) / parseFloat(_cs.fontSize);\n\t\t\t\t\t// console.debug(lineHeight);\n\t\t\t\t}else if(lineHeight.indexOf(\"em\") >= 0){\n\t\t\t\t\tlineHeight = parseFloat(lineHeight);\n\t\t\t\t}else{\n\t\t\t\t\t// If we can't get a non-units value, just default\n\t\t\t\t\t// it to the CSS spec default of 'normal'.  Seems to\n\t\t\t\t\t// work better, esp on IE, than '1.0'\n\t\t\t\t\tlineHeight = \"normal\";\n\t\t\t\t}\n\t\t\t\tvar userStyle = \"\";\n\t\t\t\tvar self = this;\n\t\t\t\tthis.style.replace(/(^|;)\\s*(line-|font-?)[^;]+/ig, function(match){\n\t\t\t\t\tmatch = match.replace(/^;/ig, \"\") + ';';\n\t\t\t\t\tvar s = match.split(\":\")[0];\n\t\t\t\t\tif(s){\n\t\t\t\t\t\ts = lang.trim(s);\n\t\t\t\t\t\ts = s.toLowerCase();\n\t\t\t\t\t\tvar i;\n\t\t\t\t\t\tvar sC = \"\";\n\t\t\t\t\t\tfor(i = 0; i < s.length; i++){\n\t\t\t\t\t\t\tvar c = s.charAt(i);\n\t\t\t\t\t\t\tswitch(c){\n\t\t\t\t\t\t\t\tcase \"-\":\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\tc = s.charAt(i).toUpperCase();\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tsC += c;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomStyle.set(self.domNode, sC, \"\");\n\t\t\t\t\t}\n\t\t\t\t\tuserStyle += match + ';';\n\t\t\t\t});\n\t\n\t\n\t\t\t\t// need to find any associated label element, aria-label, or aria-labelledby and update iframe document title\n\t\t\t\tvar label = query('label[for=\"' + this.id + '\"]');\n\t\t\t\tvar title = \"\";\n\t\t\t\tif(label.length){\n\t\t\t\t\ttitle = label[0].innerHTML;\n\t\t\t\t}else if(this[\"aria-label\"]){\n\t\t\t\t\ttitle = this[\"aria-label\"];\n\t\t\t\t}else if(this[\"aria-labelledby\"]){\n\t\t\t\t\ttitle = dom.byId(this[\"aria-labelledby\"]).innerHTML;\n\t\t\t\t}\n\t\n\t\t\t\t// Now that we have the title, also set it as the title attribute on the iframe\n\t\t\t\tthis.iframe.setAttribute(\"title\", title);\n\t\n\t\t\t\treturn [\n\t\t\t\t\t\"<!DOCTYPE html>\",\n\t\t\t\t\tthis.isLeftToRight() ? \"<html lang='\" + this.lang + \"'>\\n<head>\\n\" : \"<html dir='rtl' lang='\" + this.lang + \"'>\\n<head>\\n\",\n\t\t\t\t\ttitle ? \"<title>\" + title + \"</title>\" : \"\",\n\t\t\t\t\t\"<meta http-equiv='Content-Type' content='text/html'>\\n\",\n\t\t\t\t\t\"<style>\\n\",\n\t\t\t\t\t\"\\tbody,html {\\n\",\n\t\t\t\t\t\"\\t\\tbackground:transparent;\\n\",\n\t\t\t\t\t\"\\t\\tpadding: 1px 0 0 0;\\n\",\n\t\t\t\t\t\"\\t\\tmargin: -1px 0 0 0;\\n\", // remove extraneous vertical scrollbar on safari and firefox\n\t\t\t\t\t\"\\t}\\n\",\n\t\t\t\t\t\"\\tbody,html,#dijitEditorBody { outline: none; }\",\n\t\n\t\t\t\t\t// Set <body> to expand to full size of editor, so clicking anywhere will work.\n\t\t\t\t\t// Except in auto-expand mode, in which case the editor expands to the size of <body>.\n\t\t\t\t\t// Also determine how scrollers should be applied.  In autoexpand mode (height = \"\") no scrollers on y at all.\n\t\t\t\t\t// But in fixed height mode we want both x/y scrollers.\n\t\t\t\t\t// Scrollers go on <body> since it's been set to height: 100%.\n\t\t\t\t\t\"html { height: 100%; width: 100%; overflow: hidden; }\\n\",\t// scroll bar is on #dijitEditorBody, shouldn't be on <html>\n\t\t\t\t\tthis.height ? \"\\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\\n\" :\n\t\t\t\t\t\t\"\\tbody,#dijitEditorBody { min-height: \" + this.minHeight + \"; width: 100%; overflow-x: auto; overflow-y: hidden; }\\n\",\n\t\n\t\t\t\t\t// TODO: left positioning will cause contents to disappear out of view\n\t\t\t\t\t//\t   if it gets too wide for the visible area\n\t\t\t\t\t\"\\tbody{\\n\",\n\t\t\t\t\t\"\\t\\ttop:0px;\\n\",\n\t\t\t\t\t\"\\t\\tleft:0px;\\n\",\n\t\t\t\t\t\"\\t\\tright:0px;\\n\",\n\t\t\t\t\t\"\\t\\tfont:\", font, \";\\n\",\n\t\t\t\t\t((this.height || has(\"opera\")) ? \"\" : \"\\t\\tposition: fixed;\\n\"),\n\t\t\t\t\t\"\\t\\tline-height:\", lineHeight, \";\\n\",\n\t\t\t\t\t\"\\t}\\n\",\n\t\t\t\t\t\"\\tp{ margin: 1em 0; }\\n\",\n\t\n\t\t\t\t\t\"\\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\\n\",\n\t\t\t\t\t// Can't set min-height in IE9, it puts layout on li, which puts move/resize handles.\n\t\t\t\t\t(!has(\"ie\") ? \"\\tli{ min-height:1.2em; }\\n\" : \"\"),\n\t\t\t\t\t\"</style>\\n\",\n\t\t\t\t\tthis._applyEditingAreaStyleSheets(), \"\\n\",\n\t\t\t\t\t\"</head>\\n<body role='main' \",\n\t\n\t\t\t\t\t// Onload handler fills in real editor content.\n\t\t\t\t\t// On IE9, sometimes onload is called twice, and the first time frameElement is null (test_FullScreen.html)\n\t\t\t\t\t\"onload='frameElement && frameElement._loadFunc(window,document)' \",\n\t\t\t\t\t\"style='\" + userStyle + \"'>\", html, \"</body>\\n</html>\"\n\t\t\t\t].join(\"\"); // String\n\t\t\t},\n\t\n\t\t\t_applyEditingAreaStyleSheets: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tapply the specified css files in styleSheets\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar files = [];\n\t\t\t\tif(this.styleSheets){\n\t\t\t\t\tfiles = this.styleSheets.split(';');\n\t\t\t\t\tthis.styleSheets = '';\n\t\t\t\t}\n\t\n\t\t\t\t//empty this.editingAreaStyleSheets here, as it will be filled in addStyleSheet\n\t\t\t\tfiles = files.concat(this.editingAreaStyleSheets);\n\t\t\t\tthis.editingAreaStyleSheets = [];\n\t\n\t\t\t\tvar text = '', i = 0, url, ownerWindow = winUtils.get(this.ownerDocument);\n\t\t\t\twhile((url = files[i++])){\n\t\t\t\t\tvar abstring = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t\t\tthis.editingAreaStyleSheets.push(abstring);\n\t\t\t\t\ttext += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + abstring + '\"/>';\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\n\t\t\taddStyleSheet: function(/*dojo/_base/url*/ uri){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tadd an external stylesheet for the editing area\n\t\t\t\t// uri:\n\t\t\t\t//\t\tUrl of the external css file\n\t\t\t\tvar url = uri.toString(), ownerWindow = winUtils.get(this.ownerDocument);\n\t\n\t\t\t\t//if uri is relative, then convert it to absolute so that it can be resolved correctly in iframe\n\t\t\t\tif(url.charAt(0) === '.' || (url.charAt(0) !== '/' && !uri.host)){\n\t\t\t\t\turl = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t\t}\n\t\n\t\t\t\tif(array.indexOf(this.editingAreaStyleSheets, url) > -1){\n\t//\t\t\tconsole.debug(\"dijit/_editor/RichText.addStyleSheet(): Style sheet \"+url+\" is already applied\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tthis.editingAreaStyleSheets.push(url);\n\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\tif(this.document.createStyleSheet){ //IE\n\t\t\t\t\t\tthis.document.createStyleSheet(url);\n\t\t\t\t\t}else{ //other browser\n\t\t\t\t\t\tvar head = this.document.getElementsByTagName(\"head\")[0];\n\t\t\t\t\t\tvar stylesheet = this.document.createElement(\"link\");\n\t\t\t\t\t\tstylesheet.rel = \"stylesheet\";\n\t\t\t\t\t\tstylesheet.type = \"text/css\";\n\t\t\t\t\t\tstylesheet.href = url;\n\t\t\t\t\t\thead.appendChild(stylesheet);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t},\n\t\n\t\t\tremoveStyleSheet: function(/*dojo/_base/url*/ uri){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tremove an external stylesheet for the editing area\n\t\t\t\tvar url = uri.toString(), ownerWindow = winUtils.get(this.ownerDocument);\n\t\t\t\t//if uri is relative, then convert it to absolute so that it can be resolved correctly in iframe\n\t\t\t\tif(url.charAt(0) === '.' || (url.charAt(0) !== '/' && !uri.host)){\n\t\t\t\t\turl = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t\t}\n\t\t\t\tvar index = array.indexOf(this.editingAreaStyleSheets, url);\n\t\t\t\tif(index === -1){\n\t//\t\t\tconsole.debug(\"dijit/_editor/RichText.removeStyleSheet(): Style sheet \"+url+\" has not been applied\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdelete this.editingAreaStyleSheets[index];\n\t\t\t\tquery('link[href=\"' + url + '\"]', this.window.document).orphan();\n\t\t\t},\n\t\n\t\t\t// disabled: Boolean\n\t\t\t//\t\tThe editor is disabled; the text cannot be changed.\n\t\t\tdisabled: false,\n\t\n\t\t\t_mozSettingProps: {'styleWithCSS': false},\n\t\t\t_setDisabledAttr: function(/*Boolean*/ value){\n\t\t\t\tvalue = !!value;\n\t\t\t\tthis._set(\"disabled\", value);\n\t\t\t\tif(!this.isLoaded){\n\t\t\t\t\treturn;\n\t\t\t\t} // this method requires init to be complete\n\t\t\t\tvar preventIEfocus = has(\"ie\") && (this.isLoaded || !this.focusOnLoad);\n\t\t\t\tif(preventIEfocus){\n\t\t\t\t\tthis.editNode.unselectable = \"on\";\n\t\t\t\t}\n\t\t\t\tthis.editNode.contentEditable = !value;\n\t\t\t\tthis.editNode.tabIndex = value ? \"-1\" : this.tabIndex;\n\t\t\t\tif(preventIEfocus){\n\t\t\t\t\tthis.defer(function(){\n\t\t\t\t\t\tif(this.editNode){        // guard in case widget destroyed before timeout\n\t\t\t\t\t\t\tthis.editNode.unselectable = \"off\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif(has(\"mozilla\") && !value && this._mozSettingProps){\n\t\t\t\t\tvar ps = this._mozSettingProps;\n\t\t\t\t\tvar n;\n\t\t\t\t\tfor(n in ps){\n\t\t\t\t\t\tif(ps.hasOwnProperty(n)){\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tthis.document.execCommand(n, false, ps[n]);\n\t\t\t\t\t\t\t}catch(e2){\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._disabledOK = true;\n\t\t\t},\n\t\n\t\t\t/* Event handlers\n\t\t\t *****************/\n\t\n\t\t\tonLoad: function(/*String*/ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler after the iframe finishes loading.\n\t\t\t\t// html: String\n\t\t\t\t//\t\tEditor contents should be set to this value\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(!this.window.__registeredWindow){\n\t\t\t\t\tthis.window.__registeredWindow = true;\n\t\t\t\t\tthis._iframeRegHandle = focus.registerIframe(this.iframe);\n\t\t\t\t}\n\t\n\t\t\t\t// there's a wrapper div around the content, see _getIframeDocTxt().\n\t\t\t\tthis.editNode = this.document.body.firstChild;\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\t// Helper code so IE and FF skip over focusing on the <iframe> and just focus on the inner <div>.\n\t\t\t\t// See #4996 IE wants to focus the BODY tag.\n\t\t\t\tthis.beforeIframeNode = domConstruct.place(\"<div tabIndex=-1></div>\", this.iframe, \"before\");\n\t\t\t\tthis.afterIframeNode = domConstruct.place(\"<div tabIndex=-1></div>\", this.iframe, \"after\");\n\t\t\t\tthis.iframe.onfocus = this.document.onfocus = function(){\n\t\t\t\t\t_this.editNode.focus();\n\t\t\t\t};\n\t\n\t\t\t\tthis.focusNode = this.editNode; // for InlineEditBox\n\t\n\t\n\t\t\t\tvar events = this.events.concat(this.captureEvents);\n\t\t\t\tvar ap = this.iframe ? this.document : this.editNode;\n\t\t\t\tthis.own.apply(this,\n\t\t\t\t\tarray.map(events, function(item){\n\t\t\t\t\t\tvar type = item.toLowerCase().replace(/^on/, \"\");\n\t\t\t\t\t\treturn on(ap, type, lang.hitch(this, item));\n\t\t\t\t\t}, this)\n\t\t\t\t);\n\t\n\t\t\t\tthis.own(\n\t\t\t\t\t// mouseup in the margin does not generate an onclick event\n\t\t\t\t\ton(ap, \"mouseup\", lang.hitch(this, \"onClick\"))\n\t\t\t\t);\n\t\n\t\t\t\tif(has(\"ie\")){ // IE contentEditable\n\t\t\t\t\tthis.own(on(this.document, \"mousedown\", lang.hitch(this, \"_onIEMouseDown\"))); // #4996 fix focus\n\t\n\t\t\t\t\t// give the node Layout on IE\n\t\t\t\t\t// TODO: this may no longer be needed, since we've reverted IE to using an iframe,\n\t\t\t\t\t// not contentEditable.   Removing it would also probably remove the need for creating\n\t\t\t\t\t// the extra <div> in _getIframeDocTxt()\n\t\t\t\t\tthis.editNode.style.zoom = 1.0;\n\t\t\t\t}\n\t\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t//WebKit sometimes doesn't fire right on selections, so the toolbar\n\t\t\t\t\t//doesn't update right.  Therefore, help it out a bit with an additional\n\t\t\t\t\t//listener.  A mouse up will typically indicate a display change, so fire this\n\t\t\t\t\t//and get the toolbar to adapt.  Reference: #9532\n\t\t\t\t\tthis._webkitListener = this.own(on(this.document, \"mouseup\", lang.hitch(this, \"onDisplayChanged\")))[0];\n\t\t\t\t\tthis.own(on(this.document, \"mousedown\", lang.hitch(this, function(e){\n\t\t\t\t\t\tvar t = e.target;\n\t\t\t\t\t\tif(t && (t === this.document.body || t === this.document)){\n\t\t\t\t\t\t\t// Since WebKit uses the inner DIV, we need to check and set position.\n\t\t\t\t\t\t\t// See: #12024 as to why the change was made.\n\t\t\t\t\t\t\tthis.defer(\"placeCursorAtEnd\");\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t}\n\t\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t// Try to make sure 'hidden' elements aren't visible in edit mode (like browsers other than IE\n\t\t\t\t\t// do).  See #9103\n\t\t\t\t\ttry{\n\t\t\t\t\t\tthis.document.execCommand('RespectVisibilityInDesign', true, null);\n\t\t\t\t\t}catch(e){/* squelch */\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.isLoaded = true;\n\t\n\t\t\t\tthis.set('disabled', this.disabled); // initialize content to editable (or not)\n\t\n\t\t\t\t// Note that setValue() call will only work after isLoaded is set to true (above)\n\t\n\t\t\t\t// Set up a function to allow delaying the setValue until a callback is fired\n\t\t\t\t// This ensures extensions like dijit.Editor have a way to hold the value set\n\t\t\t\t// until plugins load (and do things like register filters).\n\t\t\t\tvar setContent = lang.hitch(this, function(){\n\t\t\t\t\tthis.setValue(html);\n\t\n\t\t\t\t\t// Tell app that the Editor has finished loading.  isFulfilled() check avoids spurious\n\t\t\t\t\t// console warning when this function is called repeatedly because Editor DOMNode was moved.\n\t\t\t\t\tif(this.onLoadDeferred && !this.onLoadDeferred.isFulfilled()){\n\t\t\t\t\t\tthis.onLoadDeferred.resolve(true);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthis.onDisplayChanged();\n\t\t\t\t\tif(this.focusOnLoad){\n\t\t\t\t\t\t// after the document loads, then set focus after updateInterval expires so that\n\t\t\t\t\t\t// onNormalizedDisplayChanged has run to avoid input caret issues\n\t\t\t\t\t\tdomReady(lang.hitch(this, \"defer\", \"focus\", this.updateInterval));\n\t\t\t\t\t}\n\t\t\t\t\t// Save off the initial content now\n\t\t\t\t\tthis.value = this.getValue(true);\n\t\t\t\t});\n\t\t\t\tif(this.setValueDeferred){\n\t\t\t\t\tthis.setValueDeferred.then(setContent);\n\t\t\t\t}else{\n\t\t\t\t\tsetContent();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tonKeyDown: function(/* Event */ e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for keydown event\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\t// Modifier keys should not cause the onKeyPressed event because they do not cause any change to the\n\t\t\t\t// display\n\t\t\t\tif(e.keyCode === keys.SHIFT ||\n\t\t\t\t   e.keyCode === keys.ALT ||\n\t\t\t\t   e.keyCode === keys.META ||\n\t\t\t\t   e.keyCode === keys.CTRL){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t\tif(e.keyCode === keys.TAB && this.isTabIndent){\n\t\t\t\t\t//prevent tab from moving focus out of editor\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\n\t\t\t\t\t// FIXME: this is a poor-man's indent/outdent. It would be\n\t\t\t\t\t// better if it added 4 \"&nbsp;\" chars in an undoable way.\n\t\t\t\t\t// Unfortunately pasteHTML does not prove to be undoable\n\t\t\t\t\tif(this.queryCommandEnabled((e.shiftKey ? \"outdent\" : \"indent\"))){\n\t\t\t\t\t\tthis.execCommand((e.shiftKey ? \"outdent\" : \"indent\"));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// Make tab and shift-tab skip over the <iframe>, going from the nested <div> to the toolbar\n\t\t\t\t// or next element after the editor\n\t\t\t\tif(e.keyCode == keys.TAB && !this.isTabIndent && !e.ctrlKey && !e.altKey){\n\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t// focus the <iframe> so the browser will shift-tab away from it instead\n\t\t\t\t\t\tthis.beforeIframeNode.focus();\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// focus node after the <iframe> so the browser will tab away from it instead\n\t\t\t\t\t\tthis.afterIframeNode.focus();\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Prevent onKeyPressed from firing in order to avoid triggering a display change event when the\n\t\t\t\t\t// editor is tabbed away; this fixes toolbar controls being inappropriately disabled in IE9+\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t\tif(has(\"ie\") < 9 && e.keyCode === keys.BACKSPACE && this.document.selection.type === \"Control\"){\n\t\t\t\t\t// IE has a bug where if a non-text object is selected in the editor,\n\t\t\t\t\t// hitting backspace would act as if the browser's back button was\n\t\t\t\t\t// clicked instead of deleting the object. see #1069\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.execCommand(\"delete\");\n\t\t\t\t}\n\t\n\t\t\t\tif(has(\"ff\")){\n\t\t\t\t\tif(e.keyCode === keys.PAGE_UP || e.keyCode === keys.PAGE_DOWN){\n\t\t\t\t\t\tif(this.editNode.clientHeight >= this.editNode.scrollHeight){\n\t\t\t\t\t\t\t// Stop the event to prevent firefox from trapping the cursor when there is no scroll bar.\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tvar handlers = this._keyHandlers[e.keyCode],\n\t\t\t\t\targs = arguments;\n\t\n\t\t\t\tif(handlers && !e.altKey){\n\t\t\t\t\tarray.some(handlers, function(h){\n\t\t\t\t\t\t// treat meta- same as ctrl-, for benefit of mac users\n\t\t\t\t\t\tif(!(h.shift ^ e.shiftKey) && !(h.ctrl ^ (e.ctrlKey || e.metaKey))){\n\t\t\t\t\t\t\tif(!h.handler.apply(this, args)){\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this);\n\t\t\t\t}\n\t\n\t\t\t\t// function call after the character has been inserted\n\t\t\t\tthis.defer(\"onKeyPressed\", 1);\n\t\n\t\t\t\treturn true;\n\t\t\t},\n\t\n\t\t\tonKeyUp: function(/*===== e =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for onkeyup event\n\t\t\t\t// tags:\n\t\t\t\t//\t\tcallback\n\t\t\t},\n\t\n\t\t\tsetDisabled: function(/*Boolean*/ disabled){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tDeprecated, use set('disabled', ...) instead.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tdeprecated\n\t\t\t\tkernel.deprecated('dijit.Editor::setDisabled is deprecated', 'use dijit.Editor::attr(\"disabled\",boolean) instead', 2.0);\n\t\t\t\tthis.set('disabled', disabled);\n\t\t\t},\n\t\t\t_setValueAttr: function(/*String*/ value){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tRegisters that attr(\"value\", foo) should call setValue(foo)\n\t\t\t\tthis.setValue(value);\n\t\t\t},\n\t\t\t_setDisableSpellCheckAttr: function(/*Boolean*/ disabled){\n\t\t\t\tif(this.document){\n\t\t\t\t\tdomAttr.set(this.document.body, \"spellcheck\", !disabled);\n\t\t\t\t}else{\n\t\t\t\t\t// try again after the editor is finished loading\n\t\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\t\tdomAttr.set(this.document.body, \"spellcheck\", !disabled);\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tthis._set(\"disableSpellCheck\", disabled);\n\t\t\t},\n\t\n\t\t\taddKeyHandler: function(/*String|Number*/ key, /*Boolean*/ ctrl, /*Boolean*/ shift, /*Function*/ handler){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tAdd a handler for a keyboard shortcut\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(typeof key == \"string\"){\n\t\t\t\t\t// Something like Ctrl-B.  Since using keydown event, we need to convert string to a number.\n\t\t\t\t\tkey = key.toUpperCase().charCodeAt(0);\n\t\t\t\t}\n\t\n\t\t\t\tif(!lang.isArray(this._keyHandlers[key])){\n\t\t\t\t\tthis._keyHandlers[key] = [];\n\t\t\t\t}\n\t\n\t\t\t\tthis._keyHandlers[key].push({\n\t\t\t\t\tshift: shift || false,\n\t\t\t\t\tctrl: ctrl || false,\n\t\t\t\t\thandler: handler\n\t\t\t\t});\n\t\t\t},\n\t\n\t\t\tonKeyPressed: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for after the user has pressed a key, and the display has been updated.\n\t\t\t\t//\t\t(Runs on a timer so that it runs after the display is updated)\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tthis.onDisplayChanged(/*e*/); // can't pass in e\n\t\t\t},\n\t\n\t\t\tonClick: function(/*Event*/ e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHandler for when the user clicks.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\t// console.info('onClick',this._tryDesignModeOn);\n\t\t\t\tthis.onDisplayChanged(e);\n\t\t\t},\n\t\n\t\t\t_onIEMouseDown: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tIE only to prevent 2 clicks to focus\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(!this.focused && !this.disabled){\n\t\t\t\t\tthis.focus();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_onBlur: function(e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled from focus manager when focus has moved away from this editor\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\t// Workaround IE problem when you blur the browser windows while an editor is focused: IE hangs\n\t\t\t\t// when you focus editor #1, blur the browser window, and then click editor #0.  See #16939.\n\t\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\t\tthis.defer(function(){\n\t\t\t\t\t\tif(!focus.curNode){\n\t\t\t\t\t\t\tthis.ownerDocumentBody.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tthis.inherited(arguments);\n\t\n\t\t\t\tvar newValue = this.getValue(true);\n\t\t\t\tif(newValue !== this.value){\n\t\t\t\t\tthis.onChange(newValue);\n\t\t\t\t}\n\t\t\t\tthis._set(\"value\", newValue);\n\t\t\t},\n\t\n\t\t\t_onFocus: function(/*Event*/ e){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCalled from focus manager when focus has moved into this editor\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\t// console.info('_onFocus')\n\t\t\t\tif(!this.disabled){\n\t\t\t\t\tif(!this._disabledOK){\n\t\t\t\t\t\tthis.set('disabled', false);\n\t\t\t\t\t}\n\t\t\t\t\tthis.inherited(arguments);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t// TODO: remove in 2.0\n\t\t\tblur: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tRemove focus from this instance.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tdeprecated\n\t\t\t\tif(!has(\"ie\") && this.window.document.documentElement && this.window.document.documentElement.focus){\n\t\t\t\t\tthis.window.document.documentElement.focus();\n\t\t\t\t}else if(this.ownerDocumentBody.focus){\n\t\t\t\t\tthis.ownerDocumentBody.focus();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tfocus: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tMove focus to this editor\n\t\t\t\tif(!this.isLoaded){\n\t\t\t\t\tthis.focusOnLoad = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(has(\"ie\") < 9){\n\t\t\t\t\t//this.editNode.focus(); -> causes IE to scroll always (strict and quirks mode) to the top the Iframe\n\t\t\t\t\t// if we fire the event manually and let the browser handle the focusing, the latest\n\t\t\t\t\t// cursor position is focused like in FF\n\t\t\t\t\tthis.iframe.fireEvent('onfocus', document.createEventObject()); // createEventObject/fireEvent only in IE < 11\n\t\t\t\t}else{\n\t\t\t\t\t// Firefox and chrome\n\t\t\t\t\tthis.editNode.focus();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t// _lastUpdate: 0,\n\t\t\tupdateInterval: 200,\n\t\t\t_updateTimer: null,\n\t\t\tonDisplayChanged: function(/*Event*/ /*===== e =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis event will be fired every time the display context\n\t\t\t\t//\t\tchanges and the result needs to be reflected in the UI.\n\t\t\t\t// description:\n\t\t\t\t//\t\tIf you don't want to have update too often,\n\t\t\t\t//\t\tonNormalizedDisplayChanged should be used instead\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\t// var _t=new Date();\n\t\t\t\tif(this._updateTimer){\n\t\t\t\t\tthis._updateTimer.remove();\n\t\t\t\t}\n\t\t\t\tthis._updateTimer = this.defer(\"onNormalizedDisplayChanged\", this.updateInterval);\n\t\n\t\t\t\t// Technically this should trigger a call to watch(\"value\", ...) registered handlers,\n\t\t\t\t// but getValue() is too slow to call on every keystroke so we don't.\n\t\t\t},\n\t\t\tonNormalizedDisplayChanged: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis event is fired every updateInterval ms or more\n\t\t\t\t// description:\n\t\t\t\t//\t\tIf something needs to happen immediately after a\n\t\t\t\t//\t\tuser change, please use onDisplayChanged instead.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tdelete this._updateTimer;\n\t\t\t},\n\t\t\tonChange: function(/*===== newContent =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis is fired if and only if the editor loses focus and\n\t\t\t\t//\t\tthe content is changed.\n\t\t\t},\n\t\t\t_normalizeCommand: function(/*String*/ cmd, /*Anything?*/argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tUsed as the advice function to map our\n\t\t\t\t//\t\tnormalized set of commands to those supported by the target\n\t\t\t\t//\t\tbrowser.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar command = cmd.toLowerCase();\n\t\t\t\tif(command === \"formatblock\"){\n\t\t\t\t\tif(has(\"safari\") && argument === undefined){\n\t\t\t\t\t\tcommand = \"heading\";\n\t\t\t\t\t}\n\t\t\t\t}else if(command === \"hilitecolor\" && !has(\"mozilla\")){\n\t\t\t\t\tcommand = \"backcolor\";\n\t\t\t\t}\n\t\n\t\t\t\treturn command;\n\t\t\t},\n\t\n\t\t\t_qcaCache: {},\n\t\t\tqueryCommandAvailable: function(/*String*/ command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tTests whether a command is supported by the host. Clients\n\t\t\t\t//\t\tSHOULD check whether a command is supported before attempting\n\t\t\t\t//\t\tto use it, behaviour for unsupported commands is undefined.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe command to test for\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\t// memoizing version. See _queryCommandAvailable for computing version\n\t\t\t\tvar ca = this._qcaCache[command];\n\t\t\t\tif(ca !== undefined){\n\t\t\t\t\treturn ca;\n\t\t\t\t}\n\t\t\t\treturn (this._qcaCache[command] = this._queryCommandAvailable(command));\n\t\t\t},\n\t\n\t\t\t_queryCommandAvailable: function(/*String*/ command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSee queryCommandAvailable().\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar ie = 1;\n\t\t\t\tvar mozilla = 1 << 1;\n\t\t\t\tvar webkit = 1 << 2;\n\t\t\t\tvar opera = 1 << 3;\n\t\n\t\t\t\tfunction isSupportedBy(browsers){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tie: Boolean(browsers & ie),\n\t\t\t\t\t\tmozilla: Boolean(browsers & mozilla),\n\t\t\t\t\t\twebkit: Boolean(browsers & webkit),\n\t\t\t\t\t\topera: Boolean(browsers & opera)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\n\t\t\t\tvar supportedBy = null;\n\t\n\t\t\t\tswitch(command.toLowerCase()){\n\t\t\t\t\tcase \"bold\":\n\t\t\t\t\tcase \"italic\":\n\t\t\t\t\tcase \"underline\":\n\t\t\t\t\tcase \"subscript\":\n\t\t\t\t\tcase \"superscript\":\n\t\t\t\t\tcase \"fontname\":\n\t\t\t\t\tcase \"fontsize\":\n\t\t\t\t\tcase \"forecolor\":\n\t\t\t\t\tcase \"hilitecolor\":\n\t\t\t\t\tcase \"justifycenter\":\n\t\t\t\t\tcase \"justifyfull\":\n\t\t\t\t\tcase \"justifyleft\":\n\t\t\t\t\tcase \"justifyright\":\n\t\t\t\t\tcase \"delete\":\n\t\t\t\t\tcase \"selectall\":\n\t\t\t\t\tcase \"toggledir\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie | webkit | opera);\n\t\t\t\t\t\tbreak;\n\t\n\t\t\t\t\tcase \"createlink\":\n\t\t\t\t\tcase \"unlink\":\n\t\t\t\t\tcase \"removeformat\":\n\t\t\t\t\tcase \"inserthorizontalrule\":\n\t\t\t\t\tcase \"insertimage\":\n\t\t\t\t\tcase \"insertorderedlist\":\n\t\t\t\t\tcase \"insertunorderedlist\":\n\t\t\t\t\tcase \"indent\":\n\t\t\t\t\tcase \"outdent\":\n\t\t\t\t\tcase \"formatblock\":\n\t\t\t\t\tcase \"inserthtml\":\n\t\t\t\t\tcase \"undo\":\n\t\t\t\t\tcase \"redo\":\n\t\t\t\t\tcase \"strikethrough\":\n\t\t\t\t\tcase \"tabindent\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie | opera | webkit);\n\t\t\t\t\t\tbreak;\n\t\n\t\t\t\t\tcase \"blockdirltr\":\n\t\t\t\t\tcase \"blockdirrtl\":\n\t\t\t\t\tcase \"dirltr\":\n\t\t\t\t\tcase \"dirrtl\":\n\t\t\t\t\tcase \"inlinedirltr\":\n\t\t\t\t\tcase \"inlinedirrtl\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(ie);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"cut\":\n\t\t\t\t\tcase \"copy\":\n\t\t\t\t\tcase \"paste\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(ie | mozilla | webkit | opera);\n\t\t\t\t\t\tbreak;\n\t\n\t\t\t\t\tcase \"inserttable\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie);\n\t\t\t\t\t\tbreak;\n\t\n\t\t\t\t\tcase \"insertcell\":\n\t\t\t\t\tcase \"insertcol\":\n\t\t\t\t\tcase \"insertrow\":\n\t\t\t\t\tcase \"deletecells\":\n\t\t\t\t\tcase \"deletecols\":\n\t\t\t\t\tcase \"deleterows\":\n\t\t\t\t\tcase \"mergecells\":\n\t\t\t\t\tcase \"splitcell\":\n\t\t\t\t\t\tsupportedBy = isSupportedBy(ie | mozilla);\n\t\t\t\t\t\tbreak;\n\t\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\treturn ((has(\"ie\") || has(\"trident\")) && supportedBy.ie) ||\n\t\t\t\t\t(has(\"mozilla\") && supportedBy.mozilla) ||\n\t\t\t\t\t(has(\"webkit\") && supportedBy.webkit) ||\n\t\t\t\t\t(has(\"opera\") && supportedBy.opera);\t// Boolean return true if the command is supported, false otherwise\n\t\t\t},\n\t\n\t\t\texecCommand: function(/*String*/ command, argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tExecutes a command in the Rich Text area\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe command to execute\n\t\t\t\t// argument:\n\t\t\t\t//\t\tAn optional argument to the command\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar returnValue;\n\t\n\t\t\t\t//focus() is required for IE to work\n\t\t\t\t//In addition, focus() makes sure after the execution of\n\t\t\t\t//the command, the editor receives the focus as expected\n\t\t\t\tif(this.focused){\n\t\t\t\t\t// put focus back in the iframe, unless focus has somehow been shifted out of the editor completely\n\t\t\t\t\tthis.focus();\n\t\t\t\t}\n\t\n\t\t\t\tcommand = this._normalizeCommand(command, argument);\n\t\n\t\t\t\tif(argument !== undefined){\n\t\t\t\t\tif(command === \"heading\"){\n\t\t\t\t\t\tthrow new Error(\"unimplemented\");\n\t\t\t\t\t}else if(command === \"formatblock\" && (has(\"ie\") || has(\"trident\"))){\n\t\t\t\t\t\targument = '<' + argument + '>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t//Check to see if we have any over-rides for commands, they will be functions on this\n\t\t\t\t//widget of the form _commandImpl.  If we don't, fall through to the basic native\n\t\t\t\t//exec command of the browser.\n\t\t\t\tvar implFunc = \"_\" + command + \"Impl\";\n\t\t\t\tif(this[implFunc]){\n\t\t\t\t\treturnValue = this[implFunc](argument);\n\t\t\t\t}else{\n\t\t\t\t\targument = arguments.length > 1 ? argument : null;\n\t\t\t\t\tif(argument || command !== \"createlink\"){\n\t\t\t\t\t\treturnValue = this.document.execCommand(command, false, argument);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.onDisplayChanged();\n\t\t\t\treturn returnValue;\n\t\t\t},\n\t\n\t\t\tqueryCommandEnabled: function(/*String*/ command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCheck whether a command is enabled or not.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe command to execute\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\tcommand = this._normalizeCommand(command);\n\t\n\t\t\t\t//Check to see if we have any over-rides for commands, they will be functions on this\n\t\t\t\t//widget of the form _commandEnabledImpl.  If we don't, fall through to the basic native\n\t\t\t\t//command of the browser.\n\t\t\t\tvar implFunc = \"_\" + command + \"EnabledImpl\";\n\t\n\t\t\t\tif(this[implFunc]){\n\t\t\t\t\treturn  this[implFunc](command);\n\t\t\t\t}else{\n\t\t\t\t\treturn this._browserQueryCommandEnabled(command);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tqueryCommandState: function(command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCheck the state of a given command and returns true or false.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tcommand = this._normalizeCommand(command);\n\t\t\t\ttry{\n\t\t\t\t\treturn this.document.queryCommandState(command);\n\t\t\t\t}catch(e){\n\t\t\t\t\t//Squelch, occurs if editor is hidden on FF 3 (and maybe others.)\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tqueryCommandValue: function(command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCheck the value of a given command. This matters most for\n\t\t\t\t//\t\tcustom selections and complex values like font value setting.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar r;\n\t\t\t\tcommand = this._normalizeCommand(command);\n\t\t\t\tif((has(\"ie\") || has(\"trident\")) && command === \"formatblock\"){\n\t\t\t\t\tr = this._native2LocalFormatNames[this.document.queryCommandValue(command)];\n\t\t\t\t}else if(has(\"mozilla\") && command === \"hilitecolor\"){\n\t\t\t\t\tvar oldValue;\n\t\t\t\t\ttry{\n\t\t\t\t\t\toldValue = this.document.queryCommandValue(\"styleWithCSS\");\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\toldValue = false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, true);\n\t\t\t\t\tr = this.document.queryCommandValue(command);\n\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, oldValue);\n\t\t\t\t}else{\n\t\t\t\t\tr = this.document.queryCommandValue(command);\n\t\t\t\t}\n\t\t\t\treturn r;\n\t\t\t},\n\t\n\t\t\t// Misc.\n\t\n\t\t\t_sCall: function(name, args){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tDeprecated, remove for 2.0.   New code should access this.selection directly.\n\t\t\t\t//\t\tRun the named method of dijit/selection over the\n\t\t\t\t//\t\tcurrent editor instance's window, with the passed args.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate deprecated\n\t\n\t\t\t\treturn this.selection[name].apply(this.selection, args);\n\t\t\t},\n\t\n\t\t\t// FIXME: this is a TON of code duplication. Why?\n\t\n\t\t\tplaceCursorAtStart: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tPlace the cursor at the start of the editing area.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tthis.focus();\n\t\n\t\t\t\t//see comments in placeCursorAtEnd\n\t\t\t\tvar isvalid = false;\n\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t// TODO:  Is this branch even necessary?\n\t\t\t\t\tvar first = this.editNode.firstChild;\n\t\t\t\t\twhile(first){\n\t\t\t\t\t\tif(first.nodeType === 3){\n\t\t\t\t\t\t\tif(first.nodeValue.replace(/^\\s+|\\s+$/g, \"\").length > 0){\n\t\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\t\tthis.selection.selectElement(first);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else if(first.nodeType === 1){\n\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\tvar tg = first.tagName ? first.tagName.toLowerCase() : \"\";\n\t\t\t\t\t\t\t// Collapse before childless tags.\n\t\t\t\t\t\t\tif(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){\n\t\t\t\t\t\t\t\tthis.selection.selectElement(first);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// Collapse inside tags with children.\n\t\t\t\t\t\t\t\tthis.selection.selectElementChildren(first);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tisvalid = true;\n\t\t\t\t\tthis.selection.selectElementChildren(this.editNode);\n\t\t\t\t}\n\t\t\t\tif(isvalid){\n\t\t\t\t\tthis.selection.collapse(true);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tplaceCursorAtEnd: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tPlace the cursor at the end of the editing area.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tthis.focus();\n\t\n\t\t\t\t//In mozilla, if last child is not a text node, we have to use\n\t\t\t\t// selectElementChildren on this.editNode.lastChild otherwise the\n\t\t\t\t// cursor would be placed at the end of the closing tag of\n\t\t\t\t//this.editNode.lastChild\n\t\t\t\tvar isvalid = false;\n\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\tvar last = this.editNode.lastChild;\n\t\t\t\t\twhile(last){\n\t\t\t\t\t\tif(last.nodeType === 3){\n\t\t\t\t\t\t\tif(last.nodeValue.replace(/^\\s+|\\s+$/g, \"\").length > 0){\n\t\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\t\tthis.selection.selectElement(last);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else if(last.nodeType === 1){\n\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\tthis.selection.selectElement(last.lastChild || last);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlast = last.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tisvalid = true;\n\t\t\t\t\tthis.selection.selectElementChildren(this.editNode);\n\t\t\t\t}\n\t\t\t\tif(isvalid){\n\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tgetValue: function(/*Boolean?*/ nonDestructive){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturn the current content of the editing area (post filters\n\t\t\t\t//\t\tare applied).  Users should call get('value') instead.\n\t\t\t\t// nonDestructive:\n\t\t\t\t//\t\tdefaults to false. Should the post-filtering be run over a copy\n\t\t\t\t//\t\tof the live DOM? Most users should pass \"true\" here unless they\n\t\t\t\t//\t\t*really* know that none of the installed filters are going to\n\t\t\t\t//\t\tmess up the editing session.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(this.textarea){\n\t\t\t\t\tif(this.isClosed || !this.isLoaded){\n\t\t\t\t\t\treturn this.textarea.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn this.isLoaded ? this._postFilterContent(null, nonDestructive) : this.value;\n\t\t\t},\n\t\t\t_getValueAttr: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tHook to make attr(\"value\") work\n\t\t\t\treturn this.getValue(true);\n\t\t\t},\n\t\n\t\t\tsetValue: function(/*String*/ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function sets the content. No undo history is preserved.\n\t\t\t\t//\t\tUsers should use set('value', ...) instead.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tdeprecated\n\t\n\t\t\t\t// TODO: remove this and getValue() for 2.0, and move code to _setValueAttr()\n\t\n\t\t\t\tif(!this.isLoaded){\n\t\t\t\t\t// try again after the editor is finished loading\n\t\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\t\tthis.setValue(html);\n\t\t\t\t\t}));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(this.textarea && (this.isClosed || !this.isLoaded)){\n\t\t\t\t\tthis.textarea.value = html;\n\t\t\t\t}else{\n\t\t\t\t\thtml = this._preFilterContent(html);\n\t\t\t\t\tvar node = this.isClosed ? this.domNode : this.editNode;\n\t\n\t\t\t\t\tnode.innerHTML = html;\n\t\t\t\t\tthis._preDomFilterContent(node);\n\t\t\t\t}\n\t\n\t\t\t\tthis.onDisplayChanged();\n\t\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t\t},\n\t\n\t\t\treplaceValue: function(/*String*/ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function set the content while trying to maintain the undo stack\n\t\t\t\t//\t\t(now only works fine with Moz, this is identical to setValue in all\n\t\t\t\t//\t\tother browsers)\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\n\t\t\t\tif(this.isClosed){\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t}else if(this.window && this.window.getSelection && !has(\"mozilla\")){ // Safari\n\t\t\t\t\t// look ma! it's a totally f'd browser!\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t}else if(this.window && this.window.getSelection){ // Moz\n\t\t\t\t\thtml = this._preFilterContent(html);\n\t\t\t\t\tthis.execCommand(\"selectall\");\n\t\t\t\t\tthis.execCommand(\"inserthtml\", html);\n\t\t\t\t\tthis._preDomFilterContent(this.editNode);\n\t\t\t\t}else if(this.document && this.document.selection){//IE\n\t\t\t\t\t//In IE, when the first element is not a text node, say\n\t\t\t\t\t//an <a> tag, when replacing the content of the editing\n\t\t\t\t\t//area, the <a> tag will be around all the content\n\t\t\t\t\t//so for now, use setValue for IE too\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t}\n\t\n\t\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t\t},\n\t\n\t\t\t_preFilterContent: function(/*String*/ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFilter the input before setting the content of the editing\n\t\t\t\t//\t\tarea. DOM pre-filtering may happen after this\n\t\t\t\t//\t\tstring-based filtering takes place but as of 1.2, this is not\n\t\t\t\t//\t\tguaranteed for operations such as the inserthtml command.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar ec = html;\n\t\t\t\tarray.forEach(this.contentPreFilters, function(ef){\n\t\t\t\t\tif(ef){\n\t\t\t\t\t\tec = ef(ec);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn ec;\n\t\t\t},\n\t\t\t_preDomFilterContent: function(/*DomNode*/ dom){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tfilter the input's live DOM. All filter operations should be\n\t\t\t\t//\t\tconsidered to be \"live\" and operating on the DOM that the user\n\t\t\t\t//\t\twill be interacting with in their editing session.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tdom = dom || this.editNode;\n\t\t\t\tarray.forEach(this.contentDomPreFilters, function(ef){\n\t\t\t\t\tif(ef && lang.isFunction(ef)){\n\t\t\t\t\t\tef(dom);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t},\n\t\n\t\t\t_postFilterContent: function(/*DomNode|DomNode[]|String?*/ dom, /*Boolean?*/ nonDestructive){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tfilter the output after getting the content of the editing area\n\t\t\t\t//\n\t\t\t\t// description:\n\t\t\t\t//\t\tpost-filtering allows plug-ins and users to specify any number\n\t\t\t\t//\t\tof transforms over the editor's content, enabling many common\n\t\t\t\t//\t\tuse-cases such as transforming absolute to relative URLs (and\n\t\t\t\t//\t\tvice-versa), ensuring conformance with a particular DTD, etc.\n\t\t\t\t//\t\tThe filters are registered in the contentDomPostFilters and\n\t\t\t\t//\t\tcontentPostFilters arrays. Each item in the\n\t\t\t\t//\t\tcontentDomPostFilters array is a function which takes a DOM\n\t\t\t\t//\t\tNode or array of nodes as its only argument and returns the\n\t\t\t\t//\t\tsame. It is then passed down the chain for further filtering.\n\t\t\t\t//\t\tThe contentPostFilters array behaves the same way, except each\n\t\t\t\t//\t\tmember operates on strings. Together, the DOM and string-based\n\t\t\t\t//\t\tfiltering allow the full range of post-processing that should\n\t\t\t\t//\t\tbe necessaray to enable even the most agressive of post-editing\n\t\t\t\t//\t\tconversions to take place.\n\t\t\t\t//\n\t\t\t\t//\t\tIf nonDestructive is set to \"true\", the nodes are cloned before\n\t\t\t\t//\t\tfiltering proceeds to avoid potentially destructive transforms\n\t\t\t\t//\t\tto the content which may still needed to be edited further.\n\t\t\t\t//\t\tOnce DOM filtering has taken place, the serialized version of\n\t\t\t\t//\t\tthe DOM which is passed is run through each of the\n\t\t\t\t//\t\tcontentPostFilters functions.\n\t\t\t\t//\n\t\t\t\t// dom:\n\t\t\t\t//\t\ta node, set of nodes, which to filter using each of the current\n\t\t\t\t//\t\tmembers of the contentDomPostFilters and contentPostFilters arrays.\n\t\t\t\t//\n\t\t\t\t// nonDestructive:\n\t\t\t\t//\t\tdefaults to \"false\". If true, ensures that filtering happens on\n\t\t\t\t//\t\ta clone of the passed-in content and not the actual node\n\t\t\t\t//\t\titself.\n\t\t\t\t//\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar ec;\n\t\t\t\tif(!lang.isString(dom)){\n\t\t\t\t\tdom = dom || this.editNode;\n\t\t\t\t\tif(this.contentDomPostFilters.length){\n\t\t\t\t\t\tif(nonDestructive){\n\t\t\t\t\t\t\tdom = lang.clone(dom);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tarray.forEach(this.contentDomPostFilters, function(ef){\n\t\t\t\t\t\t\tdom = ef(dom);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tec = htmlapi.getChildrenHtml(dom);\n\t\t\t\t}else{\n\t\t\t\t\tec = dom;\n\t\t\t\t}\n\t\n\t\t\t\tif(!lang.trim(ec.replace(/^\\xA0\\xA0*/, '').replace(/\\xA0\\xA0*$/, '')).length){\n\t\t\t\t\tec = \"\";\n\t\t\t\t}\n\t\n\t\t\t\tarray.forEach(this.contentPostFilters, function(ef){\n\t\t\t\t\tec = ef(ec);\n\t\t\t\t});\n\t\n\t\t\t\treturn ec;\n\t\t\t},\n\t\n\t\t\t_saveContent: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSaves the content in an onunload event if the editor has not been closed\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tvar saveTextarea = dom.byId(dijit._scopeName + \"._editor.RichText.value\");\n\t\t\t\tif(saveTextarea){\n\t\t\t\t\tif(saveTextarea.value){\n\t\t\t\t\t\tsaveTextarea.value += this._SEPARATOR;\n\t\t\t\t\t}\n\t\t\t\t\tsaveTextarea.value += this.name + this._NAME_CONTENT_SEP + this.getValue(true);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\n\t\t\tescapeXml: function(/*String*/ str, /*Boolean*/ noSingleQuotes){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tAdds escape sequences for special characters in XML.\n\t\t\t\t//\t\tOptionally skips escapes for single quotes\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tstr = str.replace(/&/gm, \"&amp;\").replace(/</gm, \"&lt;\").replace(/>/gm, \"&gt;\").replace(/\"/gm, \"&quot;\");\n\t\t\t\tif(!noSingleQuotes){\n\t\t\t\t\tstr = str.replace(/'/gm, \"&#39;\");\n\t\t\t\t}\n\t\t\t\treturn str; // string\n\t\t\t},\n\t\n\t\t\tgetNodeHtml: function(/* DomNode */ node){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tDeprecated.   Use dijit/_editor/html::_getNodeHtml() instead.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tdeprecated\n\t\t\t\tkernel.deprecated('dijit.Editor::getNodeHtml is deprecated', 'use dijit/_editor/html::getNodeHtml instead', 2);\n\t\t\t\treturn htmlapi.getNodeHtml(node); // String\n\t\t\t},\n\t\n\t\t\tgetNodeChildrenHtml: function(/* DomNode */ dom){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tDeprecated.   Use dijit/_editor/html::getChildrenHtml() instead.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tdeprecated\n\t\t\t\tkernel.deprecated('dijit.Editor::getNodeChildrenHtml is deprecated', 'use dijit/_editor/html::getChildrenHtml instead', 2);\n\t\t\t\treturn htmlapi.getChildrenHtml(dom);\n\t\t\t},\n\t\n\t\t\tclose: function(/*Boolean?*/ save){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tKills the editor and optionally writes back the modified contents to the\n\t\t\t\t//\t\telement from which it originated.\n\t\t\t\t// save:\n\t\t\t\t//\t\tWhether or not to save the changes. If false, the changes are discarded.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\n\t\t\t\tif(this.isClosed){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif(!arguments.length){\n\t\t\t\t\tsave = true;\n\t\t\t\t}\n\t\t\t\tif(save){\n\t\t\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t\t\t}\n\t\n\t\t\t\t// line height is squashed for iframes\n\t\t\t\t// FIXME: why was this here? if(this.iframe){ this.domNode.style.lineHeight = null; }\n\t\n\t\t\t\tif(this.interval){\n\t\t\t\t\tclearInterval(this.interval);\n\t\t\t\t}\n\t\n\t\t\t\tif(this._webkitListener){\n\t\t\t\t\t// Cleanup of WebKit fix: #9532\n\t\t\t\t\tthis._webkitListener.remove();\n\t\t\t\t\tdelete this._webkitListener;\n\t\t\t\t}\n\t\n\t\t\t\t// Guard against memory leaks on IE (see #9268)\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis.iframe.onfocus = null;\n\t\t\t\t}\n\t\t\t\tthis.iframe._loadFunc = null;\n\t\n\t\t\t\tif(this._iframeRegHandle){\n\t\t\t\t\tthis._iframeRegHandle.remove();\n\t\t\t\t\tdelete this._iframeRegHandle;\n\t\t\t\t}\n\t\n\t\t\t\tif(this.textarea){\n\t\t\t\t\tvar s = this.textarea.style;\n\t\t\t\t\ts.position = \"\";\n\t\t\t\t\ts.left = s.top = \"\";\n\t\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t\ts.overflow = this.__overflow;\n\t\t\t\t\t\tthis.__overflow = null;\n\t\t\t\t\t}\n\t\t\t\t\tthis.textarea.value = this.value;\n\t\t\t\t\tdomConstruct.destroy(this.domNode);\n\t\t\t\t\tthis.domNode = this.textarea;\n\t\t\t\t}else{\n\t\t\t\t\t// Note that this destroys the iframe\n\t\t\t\t\tthis.domNode.innerHTML = this.value;\n\t\t\t\t}\n\t\t\t\tdelete this.iframe;\n\t\n\t\t\t\tdomClass.remove(this.domNode, this.baseClass);\n\t\t\t\tthis.isClosed = true;\n\t\t\t\tthis.isLoaded = false;\n\t\n\t\t\t\tdelete this.editNode;\n\t\t\t\tdelete this.focusNode;\n\t\n\t\t\t\tif(this.window && this.window._frameElement){\n\t\t\t\t\tthis.window._frameElement = null;\n\t\t\t\t}\n\t\n\t\t\t\tthis.window = null;\n\t\t\t\tthis.document = null;\n\t\t\t\tthis.editingArea = null;\n\t\t\t\tthis.editorObject = null;\n\t\t\t},\n\t\n\t\t\tdestroy: function(){\n\t\t\t\tif(!this.isClosed){\n\t\t\t\t\tthis.close(false);\n\t\t\t\t}\n\t\t\t\tif(this._updateTimer){\n\t\t\t\t\tthis._updateTimer.remove();\n\t\t\t\t}\n\t\t\t\tthis.inherited(arguments);\n\t\t\t\tif(RichText._globalSaveHandler){\n\t\t\t\t\tdelete RichText._globalSaveHandler[this.id];\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_removeMozBogus: function(/* String */ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tPost filter to remove unwanted HTML attributes generated by mozilla\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\treturn html.replace(/\\stype=\"_moz\"/gi, '').replace(/\\s_moz_dirty=\"\"/gi, '').replace(/_moz_resizing=\"(true|false)\"/gi, ''); // String\n\t\t\t},\n\t\t\t_removeWebkitBogus: function(/* String */ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tPost filter to remove unwanted HTML attributes generated by webkit\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\thtml = html.replace(/\\sclass=\"webkit-block-placeholder\"/gi, '');\n\t\t\t\thtml = html.replace(/\\sclass=\"apple-style-span\"/gi, '');\n\t\t\t\t// For some reason copy/paste sometime adds extra meta tags for charset on\n\t\t\t\t// webkit (chrome) on mac.They need to be removed.  See: #12007\"\n\t\t\t\thtml = html.replace(/<meta charset=\\\"utf-8\\\" \\/>/gi, '');\n\t\t\t\treturn html; // String\n\t\t\t},\n\t\t\t_normalizeFontStyle: function(/* String */ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tConvert 'strong' and 'em' to 'b' and 'i'.\n\t\t\t\t// description:\n\t\t\t\t//\t\tMoz can not handle strong/em tags correctly, so to help\n\t\t\t\t//\t\tmozilla and also to normalize output, convert them to 'b' and 'i'.\n\t\t\t\t//\n\t\t\t\t//\t\tNote the IE generates 'strong' and 'em' rather than 'b' and 'i'\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\treturn html.replace(/<(\\/)?strong([ \\>])/gi, '<$1b$2')\n\t\t\t\t\t.replace(/<(\\/)?em([ \\>])/gi, '<$1i$2'); // String\n\t\t\t},\n\t\n\t\t\t_preFixUrlAttributes: function(/* String */ html){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tPre-filter to do fixing to href attributes on `<a>` and `<img>` tags\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\treturn html.replace(/(?:(<a(?=\\s).*?\\shref=)(\"|')(.*?)\\2)|(?:(<a\\s.*?href=)([^\"'][^ >]+))/gi,\n\t\t\t\t\t'$1$4$2$3$5$2 _djrealurl=$2$3$5$2')\n\t\t\t\t\t.replace(/(?:(<img(?=\\s).*?\\ssrc=)(\"|')(.*?)\\2)|(?:(<img\\s.*?src=)([^\"'][^ >]+))/gi,\n\t\t\t\t\t'$1$4$2$3$5$2 _djrealurl=$2$3$5$2'); // String\n\t\t\t},\n\t\n\t\t\t/*****************************************************************************\n\t\t\t The following functions implement HTML manipulation commands for various\n\t\t\t browser/contentEditable implementations.  The goal of them is to enforce\n\t\t\t standard behaviors of them.\n\t\t\t ******************************************************************************/\n\t\n\t\t\t/*** queryCommandEnabled implementations ***/\n\t\n\t\t\t_browserQueryCommandEnabled: function(command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tImplementation to call to the native queryCommandEnabled of the browser.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe command to check.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(!command){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar elem = has(\"ie\") < 9 ? this.document.selection.createRange() : this.document;\n\t\t\t\ttry{\n\t\t\t\t\treturn elem.queryCommandEnabled(command);\n\t\t\t\t}catch(e){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_createlinkEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the test for if the create link\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"opera\")){\n\t\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\t\tif(sel.isCollapsed){\n\t\t\t\t\t\tenabled = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tenabled = this.document.queryCommandEnabled(\"createlink\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"createlink\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t_unlinkEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the test for if the unlink\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"mozilla\") || has(\"webkit\")){\n\t\t\t\t\tenabled = this.selection.hasAncestorElement(\"a\");\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"unlink\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t_inserttableEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the test for if the inserttable\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"mozilla\") || has(\"webkit\")){\n\t\t\t\t\tenabled = true;\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"inserttable\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t_cutEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the test for if the cut\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t// WebKit deems clipboard activity as a security threat and natively would return false\n\t\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\t\tif(sel){\n\t\t\t\t\t\tsel = sel.toString();\n\t\t\t\t\t}\n\t\t\t\t\tenabled = !!sel;\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"cut\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t_copyEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the test for if the copy\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t// WebKit deems clipboard activity as a security threat and natively would return false\n\t\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\t\tif(sel){\n\t\t\t\t\t\tsel = sel.toString();\n\t\t\t\t\t}\n\t\t\t\t\tenabled = !!sel;\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"copy\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t_pasteEnabledImpl: function(/*===== argument =====*/){\n\t\t\t\t// summary:c\n\t\t\t\t//\t\tThis function implements the test for if the paste\n\t\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar enabled = true;\n\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\treturn true;\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this._browserQueryCommandEnabled(\"paste\");\n\t\t\t\t}\n\t\t\t\treturn enabled;\n\t\t\t},\n\t\n\t\t\t/*** execCommand implementations ***/\n\t\n\t\t\t_inserthorizontalruleImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the insertion of HTML 'HR' tags.\n\t\t\t\t//\t\tinto a point on the page.  IE doesn't to it right, so\n\t\t\t\t//\t\twe have to use an alternate form\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\treturn this._inserthtmlImpl(\"<hr>\");\n\t\t\t\t}\n\t\t\t\treturn this.document.execCommand(\"inserthorizontalrule\", false, argument);\n\t\t\t},\n\t\n\t\t\t_unlinkImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the unlink of an 'a' tag.\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif((this.queryCommandEnabled(\"unlink\")) && (has(\"mozilla\") || has(\"webkit\"))){\n\t\t\t\t\tvar a = this.selection.getAncestorElement(\"a\");\n\t\t\t\t\tthis.selection.selectElement(a);\n\t\t\t\t\treturn this.document.execCommand(\"unlink\", false, null);\n\t\t\t\t}\n\t\t\t\treturn this.document.execCommand(\"unlink\", false, argument);\n\t\t\t},\n\t\n\t\t\t_hilitecolorImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the hilitecolor command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar returnValue;\n\t\t\t\tvar isApplied = this._handleTextColorOrProperties(\"hilitecolor\", argument);\n\t\t\t\tif(!isApplied){\n\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t// mozilla doesn't support hilitecolor properly when useCSS is\n\t\t\t\t\t\t// set to false (bugzilla #279330)\n\t\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, true);\n\t\t\t\t\t\tconsole.log(\"Executing color command.\");\n\t\t\t\t\t\treturnValue = this.document.execCommand(\"hilitecolor\", false, argument);\n\t\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, false);\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturnValue = this.document.execCommand(\"hilitecolor\", false, argument);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn returnValue;\n\t\t\t},\n\t\n\t\t\t_backcolorImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the backcolor command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t// Tested under IE 6 XP2, no problem here, comment out\n\t\t\t\t\t// IE weirdly collapses ranges when we exec these commands, so prevent it\n\t\t\t\t\t//\tvar tr = this.document.selection.createRange();\n\t\t\t\t\targument = argument ? argument : null;\n\t\t\t\t}\n\t\t\t\tvar isApplied = this._handleTextColorOrProperties(\"backcolor\", argument);\n\t\t\t\tif(!isApplied){\n\t\t\t\t\tisApplied = this.document.execCommand(\"backcolor\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn isApplied;\n\t\t\t},\n\t\n\t\t\t_forecolorImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the forecolor command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\t// Tested under IE 6 XP2, no problem here, comment out\n\t\t\t\t\t// IE weirdly collapses ranges when we exec these commands, so prevent it\n\t\t\t\t\t//\tvar tr = this.document.selection.createRange();\n\t\t\t\t\targument = argument ? argument : null;\n\t\t\t\t}\n\t\t\t\tvar isApplied = false;\n\t\t\t\tisApplied = this._handleTextColorOrProperties(\"forecolor\", argument);\n\t\t\t\tif(!isApplied){\n\t\t\t\t\tisApplied = this.document.execCommand(\"forecolor\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn isApplied;\n\t\t\t},\n\t\n\t\t\t_inserthtmlImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the insertion of HTML content into\n\t\t\t\t//\t\ta point on the page.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tThe content to insert, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\targument = this._preFilterContent(argument);\n\t\t\t\tvar rv = true;\n\t\t\t\tif(has(\"ie\") < 9){\n\t\t\t\t\tvar insertRange = this.document.selection.createRange();\n\t\t\t\t\tif(this.document.selection.type.toUpperCase() === 'CONTROL'){\n\t\t\t\t\t\tvar n = insertRange.item(0);\n\t\t\t\t\t\twhile(insertRange.length){\n\t\t\t\t\t\t\tinsertRange.remove(insertRange.item(0));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tn.outerHTML = argument;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tinsertRange.pasteHTML(argument);\n\t\t\t\t\t}\n\t\t\t\t\tinsertRange.select();\n\t\t\t\t}else if(has(\"trident\") < 8){\n\t\t\t\t\tvar insertRange;\n\t\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\t\tif(selection && selection.rangeCount && selection.getRangeAt){\n\t\t\t\t\t\tinsertRange = selection.getRangeAt(0);\n\t\t\t\t\t\tinsertRange.deleteContents();\n\t\n\t\t\t\t\t\tvar div = domConstruct.create('div');\n\t\t\t\t\t\tdiv.innerHTML = argument;\n\t\t\t\t\t\tvar node, lastNode;\n\t\t\t\t\t\tvar n = this.document.createDocumentFragment();\n\t\t\t\t\t\twhile((node = div.firstChild)){\n\t\t\t\t\t\t\tlastNode = n.appendChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinsertRange.insertNode(n);\n\t\t\t\t\t\tif(lastNode) {\n\t\t\t\t\t\t\tinsertRange = insertRange.cloneRange();\n\t\t\t\t\t\t\tinsertRange.setStartAfter(lastNode);\n\t\t\t\t\t\t\tinsertRange.collapse(false);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(insertRange);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(has(\"mozilla\") && !argument.length){\n\t\t\t\t\t//mozilla can not inserthtml an empty html to delete current selection\n\t\t\t\t\t//so we delete the selection instead in this case\n\t\t\t\t\tthis.selection.remove(); // FIXME\n\t\t\t\t}else{\n\t\t\t\t\trv = this.document.execCommand(\"inserthtml\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn rv;\n\t\t\t},\n\t\n\t\t\t_boldImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the bold command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"bold\");\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"bold\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_italicImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the italic command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"italic\");\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"italic\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_underlineImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the underline command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"underline\");\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"underline\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_strikethroughImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the strikethrough command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"strikethrough\");\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"strikethrough\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_superscriptImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the superscript command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"superscript\");\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"superscript\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_subscriptImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements an over-ride of the superscript command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tNot used, operates by selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._adaptIESelection();\n\t\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"subscript\");\n\t\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"subscript\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_fontnameImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the fontname command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar isApplied;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tisApplied = this._handleTextColorOrProperties(\"fontname\", argument);\n\t\t\t\t}\n\t\t\t\tif(!isApplied){\n\t\t\t\t\tisApplied = this.document.execCommand(\"fontname\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn isApplied;\n\t\t\t},\n\t\n\t\t\t_fontsizeImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the fontsize command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar isApplied;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tisApplied = this._handleTextColorOrProperties(\"fontsize\", argument);\n\t\t\t\t}\n\t\t\t\tif(!isApplied){\n\t\t\t\t\tisApplied = this.document.execCommand(\"fontsize\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn isApplied;\n\t\t\t},\n\t\n\t\t\t_insertorderedlistImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the insertorderedlist command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tapplied = this._adaptIEList(\"insertorderedlist\", argument);\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"insertorderedlist\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\t_insertunorderedlistImpl: function(argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function implements the insertunorderedlist command\n\t\t\t\t// argument:\n\t\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprotected\n\t\t\t\tvar applied = false;\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tapplied = this._adaptIEList(\"insertunorderedlist\", argument);\n\t\t\t\t}\n\t\t\t\tif(!applied){\n\t\t\t\t\tapplied = this.document.execCommand(\"insertunorderedlist\", false, argument);\n\t\t\t\t}\n\t\t\t\treturn applied;\n\t\t\t},\n\t\n\t\t\tgetHeaderHeight: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tA function for obtaining the height of the header node\n\t\t\t\treturn this._getNodeChildrenHeight(this.header); // Number\n\t\t\t},\n\t\n\t\t\tgetFooterHeight: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tA function for obtaining the height of the footer node\n\t\t\t\treturn this._getNodeChildrenHeight(this.footer); // Number\n\t\t\t},\n\t\n\t\t\t_getNodeChildrenHeight: function(node){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tAn internal function for computing the cumulative height of all child nodes of 'node'\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to process the children of;\n\t\t\t\tvar h = 0;\n\t\t\t\tif(node && node.childNodes){\n\t\t\t\t\t// IE didn't compute it right when position was obtained on the node directly is some cases,\n\t\t\t\t\t// so we have to walk over all the children manually.\n\t\t\t\t\tvar i;\n\t\t\t\t\tfor(i = 0; i < node.childNodes.length; i++){\n\t\t\t\t\t\tvar size = domGeometry.position(node.childNodes[i]);\n\t\t\t\t\t\th += size.h;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn h; // Number\n\t\t\t},\n\t\n\t\t\t_isNodeEmpty: function(node, startOffset){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to test if a node is devoid of real content.\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to check.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate.\n\t\t\t\tif(node.nodeType === 1/*element*/){\n\t\t\t\t\tif(node.childNodes.length > 0){\n\t\t\t\t\t\treturn this._isNodeEmpty(node.childNodes[0], startOffset);\t// huh?   why test just first child?\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}else if(node.nodeType === 3/*text*/){\n\t\t\t\t\treturn (node.nodeValue.substring(startOffset) === \"\");\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\n\t\t\t_removeStartingRangeFromRange: function(node, range){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to adjust selection range by removing the current\n\t\t\t\t//\t\tstart node.\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to remove from the starting range.\n\t\t\t\t// range:\n\t\t\t\t//\t\tThe range to adapt.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(node.nextSibling){\n\t\t\t\t\trange.setStart(node.nextSibling, 0);\n\t\t\t\t}else{\n\t\t\t\t\tvar parent = node.parentNode;\n\t\t\t\t\twhile(parent && parent.nextSibling == null){\n\t\t\t\t\t\t//move up the tree until we find a parent that has another node, that node will be the next node\n\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif(parent){\n\t\t\t\t\t\trange.setStart(parent.nextSibling, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range;\n\t\t\t},\n\t\n\t\t\t_adaptIESelection: function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to adapt the IE range by removing leading 'newlines'\n\t\t\t\t//\t\tNeeded to fix issue with bold/italics/underline not working if\n\t\t\t\t//\t\trange included leading 'newlines'.\n\t\t\t\t//\t\tIn IE, if a user starts a selection at the very end of a line,\n\t\t\t\t//\t\tthen the native browser commands will fail to execute correctly.\n\t\t\t\t//\t\tTo work around the issue,  we can remove all empty nodes from\n\t\t\t\t//\t\tthe start of the range selection.\n\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\tif(selection && selection.rangeCount && !selection.isCollapsed){\n\t\t\t\t\tvar range = selection.getRangeAt(0);\n\t\t\t\t\tvar firstNode = range.startContainer;\n\t\t\t\t\tvar startOffset = range.startOffset;\n\t\n\t\t\t\t\twhile(firstNode.nodeType === 3/*text*/ && startOffset >= firstNode.length && firstNode.nextSibling){\n\t\t\t\t\t\t//traverse the text nodes until we get to the one that is actually highlighted\n\t\t\t\t\t\tstartOffset = startOffset - firstNode.length;\n\t\t\t\t\t\tfirstNode = firstNode.nextSibling;\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//Remove the starting ranges until the range does not start with an empty node.\n\t\t\t\t\tvar lastNode = null;\n\t\t\t\t\twhile(this._isNodeEmpty(firstNode, startOffset) && firstNode !== lastNode){\n\t\t\t\t\t\tlastNode = firstNode; //this will break the loop in case we can't find the next sibling\n\t\t\t\t\t\trange = this._removeStartingRangeFromRange(firstNode, range); //move the start container to the next node in the range\n\t\t\t\t\t\tfirstNode = range.startContainer;\n\t\t\t\t\t\tstartOffset = 0; //start at the beginning of the new starting range\n\t\t\t\t\t}\n\t\t\t\t\tselection.removeAllRanges();// this will work as long as users cannot select multiple ranges. I have not been able to do that in the editor.\n\t\t\t\t\tselection.addRange(range);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_adaptIEFormatAreaAndExec: function(command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to handle IE's quirkiness regarding how it handles\n\t\t\t\t//\t\tformat commands on a word.  This involves a lit of node splitting\n\t\t\t\t//\t\tand format cloning.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe format command, needed to check if the desired\n\t\t\t\t//\t\tcommand is true or not.\n\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\tvar doc = this.document;\n\t\t\t\tvar rs, ret, range, txt, startNode, endNode, breaker, sNode;\n\t\t\t\tif(command && selection && selection.isCollapsed){\n\t\t\t\t\tvar isApplied = this.queryCommandValue(command);\n\t\t\t\t\tif(isApplied){\n\t\n\t\t\t\t\t\t// We have to split backwards until we hit the format\n\t\t\t\t\t\tvar nNames = this._tagNamesForCommand(command);\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\tvar fs = range.startContainer;\n\t\t\t\t\t\tif(fs.nodeType === 3){\n\t\t\t\t\t\t\tvar offset = range.endOffset;\n\t\t\t\t\t\t\tif(fs.length < offset){\n\t\t\t\t\t\t\t\t//We are not looking from the right node, try to locate the correct one\n\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\t\tfs = ret.node;\n\t\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar topNode;\n\t\t\t\t\t\twhile(fs && fs !== this.editNode){\n\t\t\t\t\t\t\t// We have to walk back and see if this is still a format or not.\n\t\t\t\t\t\t\t// Hm, how do I do this?\n\t\t\t\t\t\t\tvar tName = fs.tagName ? fs.tagName.toLowerCase() : \"\";\n\t\t\t\t\t\t\tif(array.indexOf(nNames, tName) > -1){\n\t\t\t\t\t\t\t\ttopNode = fs;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfs = fs.parentNode;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Okay, we have a stopping place, time to split things apart.\n\t\t\t\t\t\tif(topNode){\n\t\t\t\t\t\t\t// Okay, we know how far we have to split backwards, so we have to split now.\n\t\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\t\tvar newblock = doc.createElement(topNode.tagName);\n\t\t\t\t\t\t\tdomConstruct.place(newblock, topNode, \"after\");\n\t\t\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\t\tvar nodeToMove, tNode;\n\t\t\t\t\t\t\t\tvar endOffset = range.endOffset;\n\t\t\t\t\t\t\t\tif(rs.length < endOffset){\n\t\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, endOffset);\n\t\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\t\tendOffset = ret.offset;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, endOffset));\n\t\t\t\t\t\t\t\tvar endText = txt.substring(endOffset, txt.length);\n\t\t\t\t\t\t\t\tif(endText){\n\t\t\t\t\t\t\t\t\tendNode = doc.createTextNode(endText);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Place the split, then remove original nodes.\n\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"before\");\n\t\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\t\tdomConstruct.place(breaker, rs, \"after\");\n\t\t\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t\t\t\tendNode = breaker;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\n\t\t\t\t\t\t\t\t// Okay, we split the text.  Now we need to see if we're\n\t\t\t\t\t\t\t\t// parented to the block element we're splitting and if\n\t\t\t\t\t\t\t\t// not, we have to split all the way up.  Ugh.\n\t\t\t\t\t\t\t\tvar parentC = startNode.parentNode;\n\t\t\t\t\t\t\t\tvar tagList = [];\n\t\t\t\t\t\t\t\tvar tagData;\n\t\t\t\t\t\t\t\twhile(parentC !== topNode){\n\t\t\t\t\t\t\t\t\tvar tg = parentC.tagName;\n\t\t\t\t\t\t\t\t\ttagData = {tagName: tg};\n\t\t\t\t\t\t\t\t\ttagList.push(tagData);\n\t\n\t\t\t\t\t\t\t\t\tvar newTg = doc.createElement(tg);\n\t\t\t\t\t\t\t\t\t// Clone over any 'style' data.\n\t\t\t\t\t\t\t\t\tif(parentC.style){\n\t\t\t\t\t\t\t\t\t\tif(newTg.style){\n\t\t\t\t\t\t\t\t\t\t\tif(parentC.style.cssText){\n\t\t\t\t\t\t\t\t\t\t\t\tnewTg.style.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\t\ttagData.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// If font also need to clone over any font data.\n\t\t\t\t\t\t\t\t\tif(parentC.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\t\tif(parentC.color){\n\t\t\t\t\t\t\t\t\t\t\tnewTg.color = parentC.color;\n\t\t\t\t\t\t\t\t\t\t\ttagData.color = parentC.color;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(parentC.face){\n\t\t\t\t\t\t\t\t\t\t\tnewTg.face = parentC.face;\n\t\t\t\t\t\t\t\t\t\t\ttagData.face = parentC.face;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(parentC.size){  // this check was necessary on IE\n\t\t\t\t\t\t\t\t\t\t\tnewTg.size = parentC.size;\n\t\t\t\t\t\t\t\t\t\t\ttagData.size = parentC.size;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(parentC.className){\n\t\t\t\t\t\t\t\t\t\tnewTg.className = parentC.className;\n\t\t\t\t\t\t\t\t\t\ttagData.className = parentC.className;\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t// Now move end node and every sibling\n\t\t\t\t\t\t\t\t\t// after it over into the new tag.\n\t\t\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\t\t\t\t\tnewTg.appendChild(nodeToMove);\n\t\t\t\t\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(newTg.tagName == parentC.tagName){\n\t\t\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(breaker, parentC, \"after\");\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(newTg, breaker, \"after\");\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tdomConstruct.place(newTg, parentC, \"after\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tstartNode = parentC;\n\t\t\t\t\t\t\t\t\tendNode = newTg;\n\t\t\t\t\t\t\t\t\tparentC = parentC.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t// Lastly, move the split out all the split tags\n\t\t\t\t\t\t\t\t// to the new block as they should now be split properly.\n\t\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\t\t\t\tif(nodeToMove.nodeType === 1 || (nodeToMove.nodeType === 3 && nodeToMove.nodeValue)){\n\t\t\t\t\t\t\t\t\t\t// Non-blank text and non-text nodes need to clear out that blank space\n\t\t\t\t\t\t\t\t\t\t// before moving the contents.\n\t\t\t\t\t\t\t\t\t\tnewblock.innerHTML = \"\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\t\t\t\tnewblock.appendChild(nodeToMove);\n\t\t\t\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t// We had intermediate tags, we have to now recreate them inbetween the split\n\t\t\t\t\t\t\t\t// and restore what styles, classnames, etc, we can.\n\t\t\t\t\t\t\t\tvar newrange;\n\t\t\t\t\t\t\t\tif(tagList.length){\n\t\t\t\t\t\t\t\t\ttagData = tagList.pop();\n\t\t\t\t\t\t\t\t\tvar newContTag = doc.createElement(tagData.tagName);\n\t\t\t\t\t\t\t\t\tif(tagData.cssText && newContTag.style){\n\t\t\t\t\t\t\t\t\t\tnewContTag.style.cssText = tagData.cssText;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.className){\n\t\t\t\t\t\t\t\t\t\tnewContTag.className = tagData.className;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\t\tif(tagData.color){\n\t\t\t\t\t\t\t\t\t\t\tnewContTag.color = tagData.color;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.face){\n\t\t\t\t\t\t\t\t\t\t\tnewContTag.face = tagData.face;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.size){\n\t\t\t\t\t\t\t\t\t\t\tnewContTag.size = tagData.size;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomConstruct.place(newContTag, newblock, \"before\");\n\t\t\t\t\t\t\t\t\twhile(tagList.length){\n\t\t\t\t\t\t\t\t\t\ttagData = tagList.pop();\n\t\t\t\t\t\t\t\t\t\tvar newTgNode = doc.createElement(tagData.tagName);\n\t\t\t\t\t\t\t\t\t\tif(tagData.cssText && newTgNode.style){\n\t\t\t\t\t\t\t\t\t\t\tnewTgNode.style.cssText = tagData.cssText;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.className){\n\t\t\t\t\t\t\t\t\t\t\tnewTgNode.className = tagData.className;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\t\t\tif(tagData.color){\n\t\t\t\t\t\t\t\t\t\t\t\tnewTgNode.color = tagData.color;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif(tagData.face){\n\t\t\t\t\t\t\t\t\t\t\t\tnewTgNode.face = tagData.face;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif(tagData.size){\n\t\t\t\t\t\t\t\t\t\t\t\tnewTgNode.size = tagData.size;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tnewContTag.appendChild(newTgNode);\n\t\t\t\t\t\t\t\t\t\tnewContTag = newTgNode;\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t// Okay, everything is theoretically split apart and removed from the content\n\t\t\t\t\t\t\t\t\t// so insert the dummy text to select, select it, then\n\t\t\t\t\t\t\t\t\t// clear to position cursor.\n\t\t\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\t\t\tnewContTag.appendChild(sNode);\n\t\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t// No extra tags, so we have to insert a breaker point and rely\n\t\t\t\t\t\t\t\t\t// on filters to remove it later.\n\t\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\t\t\tdomConstruct.place(breaker, newblock, \"before\");\n\t\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(!newblock.firstChild){\n\t\t\t\t\t\t\t\t\t// Empty, we don't need it.  Split was at end or similar\n\t\t\t\t\t\t\t\t\t// So, remove it.\n\t\t\t\t\t\t\t\t\tdomConstruct.destroy(newblock);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}else{\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\t\tvar endText = txt.substring(offset);\n\t\t\t\t\t\t\tif(endText !== \"\"){\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.place(breaker, startNode, \"after\");\n\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tdoc.execCommand(command);\n\t\t\t\t\t\t\tdomConstruct.place(breaker.firstChild, breaker, \"before\");\n\t\t\t\t\t\t\tdomConstruct.destroy(breaker);\n\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t_adaptIEList: function(command /*===== , argument =====*/){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function handles normalizing the IE list behavior as\n\t\t\t\t//\t\tmuch as possible.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe list command to execute.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tAny additional argument.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\tif(selection.isCollapsed){\n\t\t\t\t\t// In the case of no selection, lets commonize the behavior and\n\t\t\t\t\t// make sure that it indents if needed.\n\t\t\t\t\tif(selection.rangeCount && !this.queryCommandValue(command)){\n\t\t\t\t\t\tvar range = selection.getRangeAt(0);\n\t\t\t\t\t\tvar sc = range.startContainer;\n\t\t\t\t\t\tif(sc && sc.nodeType == 3){\n\t\t\t\t\t\t\t// text node.  Lets see if there is a node before it that isn't\n\t\t\t\t\t\t\t// some sort of breaker.\n\t\t\t\t\t\t\tif(!range.startOffset){\n\t\t\t\t\t\t\t\t// We're at the beginning of a text area.  It may have been br split\n\t\t\t\t\t\t\t\t// Who knows?  In any event, we must create the list manually\n\t\t\t\t\t\t\t\t// or IE may shove too much into the list element.  It seems to\n\t\t\t\t\t\t\t\t// grab content before the text node too if it's br split.\n\t\t\t\t\t\t\t\t// Why can't IE work like everyone else?\n\t\n\t\t\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\t\t\tvar lType = \"ul\";\n\t\t\t\t\t\t\t\tif(command === \"insertorderedlist\"){\n\t\t\t\t\t\t\t\t\tlType = \"ol\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar list = this.document.createElement(lType);\n\t\t\t\t\t\t\t\tvar li = domConstruct.create(\"li\", null, list);\n\t\t\t\t\t\t\t\tdomConstruct.place(list, sc, \"before\");\n\t\t\t\t\t\t\t\t// Move in the text node as part of the li.\n\t\t\t\t\t\t\t\tli.appendChild(sc);\n\t\t\t\t\t\t\t\t// We need a br after it or the enter key handler\n\t\t\t\t\t\t\t\t// sometimes throws errors.\n\t\t\t\t\t\t\t\tdomConstruct.create(\"br\", null, list, \"after\");\n\t\t\t\t\t\t\t\t// Okay, now lets move our cursor to the beginning.\n\t\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(sc, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(sc, sc.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.selection.collapse(true);\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\n\t\t\t_handleTextColorOrProperties: function(command, argument){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function handles applying text color as best it is\n\t\t\t\t//\t\table to do so when the selection is collapsed, making the\n\t\t\t\t//\t\tbehavior cross-browser consistent. It also handles the name\n\t\t\t\t//\t\tand size for IE.\n\t\t\t\t// command:\n\t\t\t\t//\t\tThe command.\n\t\t\t\t// argument:\n\t\t\t\t//\t\tAny additional arguments.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\tvar doc = this.document;\n\t\t\t\tvar rs, ret, range, txt, startNode, endNode, breaker, sNode;\n\t\t\t\targument = argument || null;\n\t\t\t\tif(command && selection && selection.isCollapsed){\n\t\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\t\tvar endText = txt.substring(offset);\n\t\t\t\t\t\t\tif(endText !== \"\"){\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\t// Create a junk node to avoid it trying to style the breaker.\n\t\t\t\t\t\t\t// This will get destroyed later.\n\t\t\t\t\t\t\tvar extraSpan = doc.createElement(\"span\");\n\t\t\t\t\t\t\tbreaker.appendChild(extraSpan);\n\t\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.place(breaker, startNode, \"after\");\n\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t\t\t\t// WebKit is frustrating with positioning the cursor.\n\t\t\t\t\t\t\t\t// It stinks to have a selected space, but there really\n\t\t\t\t\t\t\t\t// isn't much choice here.\n\t\t\t\t\t\t\t\tvar style = \"color\";\n\t\t\t\t\t\t\t\tif(command === \"hilitecolor\" || command === \"backcolor\"){\n\t\t\t\t\t\t\t\t\tstyle = \"backgroundColor\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomStyle.set(breaker, style, argument);\n\t\t\t\t\t\t\t\tthis.selection.remove();\n\t\t\t\t\t\t\t\tdomConstruct.destroy(extraSpan);\n\t\t\t\t\t\t\t\tbreaker.innerHTML = \"&#160;\";\t// &nbsp;\n\t\t\t\t\t\t\t\tthis.selection.selectElement(breaker);\n\t\t\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.execCommand(command, argument);\n\t\t\t\t\t\t\t\tdomConstruct.place(breaker.firstChild, breaker, \"before\");\n\t\t\t\t\t\t\t\tdomConstruct.destroy(breaker);\n\t\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\t\tsNode.parentNode.removeChild(sNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\n\t\t\t_adjustNodeAndOffset: function(/*DomNode*/node, /*Int*/offset){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tIn the case there are multiple text nodes in a row the offset may not be within the node.\n\t\t\t\t//\t\tIf the offset is larger than the node length, it will attempt to find\n\t\t\t\t//\t\tthe next text sibling until it locates the text node in which the offset refers to\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to check.\n\t\t\t\t// offset:\n\t\t\t\t//\t\tThe position to find within the text node\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate.\n\t\t\t\twhile(node.length < offset && node.nextSibling && node.nextSibling.nodeType === 3){\n\t\t\t\t\t//Adjust the offset and node in the case of multiple text nodes in a row\n\t\t\t\t\toffset = offset - node.length;\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn {\"node\": node, \"offset\": offset};\n\t\t\t},\n\t\n\t\t\t_tagNamesForCommand: function(command){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to return the tab names that are associated\n\t\t\t\t//\t\twith a particular style.\n\t\t\t\t// command: String\n\t\t\t\t//\t\tThe command to return tags for.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tprivate\n\t\t\t\tif(command === \"bold\"){\n\t\t\t\t\treturn [\"b\", \"strong\"];\n\t\t\t\t}else if(command === \"italic\"){\n\t\t\t\t\treturn [\"i\", \"em\"];\n\t\t\t\t}else if(command === \"strikethrough\"){\n\t\t\t\t\treturn [\"s\", \"strike\"];\n\t\t\t\t}else if(command === \"superscript\"){\n\t\t\t\t\treturn [\"sup\"];\n\t\t\t\t}else if(command === \"subscript\"){\n\t\t\t\t\treturn [\"sub\"];\n\t\t\t\t}else if(command === \"underline\"){\n\t\t\t\t\treturn [\"u\"];\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t},\n\t\n\t\t\t_stripBreakerNodes: function(/*DOMNode*/ node){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction for stripping out the breaker spans inserted by the formatting command.\n\t\t\t\t//\t\tRegistered as a filter for IE, handles the breaker spans needed to fix up\n\t\t\t\t//\t\tHow bold/italic/etc, work when selection is collapsed (single cursor).\n\t\t\t\tif(!this.isLoaded){\n\t\t\t\t\treturn;\n\t\t\t\t} // this method requires init to be complete\n\t\t\t\tquery(\".ieFormatBreakerSpan\", node).forEach(function(b){\n\t\t\t\t\twhile(b.firstChild){\n\t\t\t\t\t\tdomConstruct.place(b.firstChild, b, \"before\");\n\t\t\t\t\t}\n\t\t\t\t\tdomConstruct.destroy(b);\n\t\t\t\t});\n\t\t\t\treturn node;\n\t\t\t},\n\t\n\t\t\t_stripTrailingEmptyNodes: function(/*DOMNode*/ node){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction for stripping trailing nodes without any text, excluding trailing nodes\n\t\t\t\t//\t\tlike <img> or <div><img></div>, even though they don't have text either.\n\t\n\t\t\t\tfunction isEmpty(node){\n\t\t\t\t\t// If not for old IE we could check for Element children by node.firstElementChild\n\t\t\t\t\treturn (/^(p|div|br)$/i.test(node.nodeName) && node.children.length == 0 &&\n\t\t\t\t\t\t/^[\\s\\xA0]*$/.test(node.textContent || node.innerText || \"\")) ||\n\t\t\t\t\t\t(node.nodeType === 3/*text*/ && /^[\\s\\xA0]*$/.test(node.nodeValue));\n\t\t\t\t}\n\t\t\t\twhile(node.lastChild && isEmpty(node.lastChild)){\n\t\t\t\t\tdomConstruct.destroy(node.lastChild);\n\t\t\t\t}\n\t\n\t\t\t\treturn node;\n\t\t\t},\n\t\n\t\t\t// Needed to support ToggleDir plugin.  Intentionally not inside if(has(\"dojo-bidi\")) block\n\t\t\t// so that (for backwards compatibility) ToggleDir plugin works even when has(\"dojo-bidi\") is falsy.\n\t\t\t_setTextDirAttr: function(/*String*/ value){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tSets textDir attribute.  Sets direction of editNode accordingly.\n\t\t\t\tthis._set(\"textDir\", value);\n\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\tthis.editNode.dir = value;\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\t\n\t\treturn RichText;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 155:\n/*!***********************************************!*\\\n  !*** C:/Users/Chuck/git/dojo/_base/unload.js ***!\n  \\***********************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(/*! ./kernel */ 4), __webpack_require__(/*! ./lang */ 9), __webpack_require__(/*! ../on */ 25)], __WEBPACK_AMD_DEFINE_RESULT__ = function(dojo, lang, on){\r\n\t\r\n\t// module:\r\n\t//\t\tdojo/unload\r\n\t\r\n\tvar win = window;\r\n\t\r\n\tvar unload = {\r\n\t\t// summary:\r\n\t\t//\t\tThis module contains the document and window unload detection API.\r\n\t\t//\t\tThis module is deprecated.  Use on(window, \"unload\", func)\r\n\t\t//\t\tand on(window, \"beforeunload\", func) instead.\r\n\t\r\n\t\taddOnWindowUnload: function(/*Object|Function?*/ obj, /*String|Function?*/ functionName){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRegisters a function to be triggered when window.onunload fires.\r\n\t\t\t//\t\tDeprecated, use on(window, \"unload\", lang.hitch(obj, functionName)) instead.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThe first time that addOnWindowUnload is called Dojo\r\n\t\t\t//\t\twill register a page listener to trigger your unload\r\n\t\t\t//\t\thandler with. Note that registering these handlers may\r\n\t\t\t//\t\tdestroy \"fastback\" page caching in browsers that support\r\n\t\t\t//\t\tit. Be careful trying to modify the DOM or access\r\n\t\t\t//\t\tJavaScript properties during this phase of page unloading:\r\n\t\t\t//\t\tthey may not always be available. Consider\r\n\t\t\t//\t\taddOnUnload() if you need to modify the DOM or do\r\n\t\t\t//\t\theavy JavaScript work since it fires at the equivalent of\r\n\t\t\t//\t\tthe page's \"onbeforeunload\" event.\r\n\t\t\t// example:\r\n\t\t\t//\t|\tvar afunc = function() {console.log(\"global function\");};\r\n\t\t\t//\t|\trequire([\"dojo/_base/unload\"], function(unload) {\r\n\t\t\t//\t|\t\tvar foo = {bar: function(){ console.log(\"bar unloading...\");}, \r\n\t\t\t//\t|\t\t           data: \"mydata\"};\r\n\t\t\t//\t|\t\tunload.addOnWindowUnload(afunc);\r\n\t\t\t//\t|\t\tunload.addOnWindowUnload(foo, \"bar\");\r\n\t\t\t//\t|\t\tunload.addOnWindowUnload(foo, function(){console.log(\"\", this.data);});\r\n\t\t\t//\t|\t});\r\n\t\r\n\t\t\tif (!dojo.windowUnloaded){\r\n\t\t\t\ton(win, \"unload\", (dojo.windowUnloaded = function(){\r\n\t\t\t\t\t// summary:\r\n\t\t\t\t\t//\t\tsignal fired by impending window destruction. You may use\r\n\t\t\t\t\t//\t\tdojo.addOnWindowUnload() to register a listener for this\r\n\t\t\t\t\t//\t\tevent. NOTE: if you wish to dojo.connect() to this method\r\n\t\t\t\t\t//\t\tto perform page/application cleanup, be aware that this\r\n\t\t\t\t\t//\t\tevent WILL NOT fire if no handler has been registered with\r\n\t\t\t\t\t//\t\taddOnWindowUnload(). This behavior started in Dojo 1.3.\r\n\t\t\t\t\t//\t\tPrevious versions always triggered windowUnloaded(). See\r\n\t\t\t\t\t//\t\taddOnWindowUnload for more info.\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\ton(win, \"unload\", lang.hitch(obj, functionName));\r\n\t\t},\r\n\t\r\n\t\taddOnUnload: function(/*Object?|Function?*/ obj, /*String|Function?*/ functionName){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tRegisters a function to be triggered when the page unloads.\r\n\t\t\t//\t\tDeprecated, use on(window, \"beforeunload\", lang.hitch(obj, functionName)) instead.\r\n\t\t\t// description:\r\n\t\t\t//\t\tThe first time that addOnUnload is called Dojo will\r\n\t\t\t//\t\tregister a page listener to trigger your unload handler\r\n\t\t\t//\t\twith.\r\n\t\t\t//\r\n\t\t\t//\t\tIn a browser environment, the functions will be triggered\r\n\t\t\t//\t\tduring the window.onbeforeunload event. Be careful of doing\r\n\t\t\t//\t\ttoo much work in an unload handler. onbeforeunload can be\r\n\t\t\t//\t\ttriggered if a link to download a file is clicked, or if\r\n\t\t\t//\t\tthe link is a javascript: link. In these cases, the\r\n\t\t\t//\t\tonbeforeunload event fires, but the document is not\r\n\t\t\t//\t\tactually destroyed. So be careful about doing destructive\r\n\t\t\t//\t\toperations in a dojo.addOnUnload callback.\r\n\t\t\t//\r\n\t\t\t//\t\tFurther note that calling dojo.addOnUnload will prevent\r\n\t\t\t//\t\tbrowsers from using a \"fast back\" cache to make page\r\n\t\t\t//\t\tloading via back button instantaneous.\r\n\t\t\t// example:\r\n\t\t\t//\t|\tvar afunc = function() {console.log(\"global function\");};\r\n\t\t\t//\t|\trequire([\"dojo/_base/unload\"], function(unload) {\r\n\t\t\t//\t|\t\tvar foo = {bar: function(){ console.log(\"bar unloading...\");}, \r\n\t\t\t//\t|\t\t           data: \"mydata\"};\r\n\t\t\t//\t|\t\tunload.addOnUnload(afunc);\r\n\t\t\t//\t|\t\tunload.addOnUnload(foo, \"bar\");\r\n\t\t\t//\t|\t\tunload.addOnUnload(foo, function(){console.log(\"\", this.data);});\r\n\t\t\t//\t|\t});\r\n\t\r\n\t\t\ton(win, \"beforeunload\", lang.hitch(obj, functionName));\r\n\t\t}\r\n\t};\r\n\t\r\n\tdojo.addOnWindowUnload = unload.addOnWindowUnload;\r\n\tdojo.addOnUnload = unload.addOnUnload;\r\n\t\r\n\treturn unload;\r\n\t\r\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n\n\n/***/ }),\n\n/***/ 156:\n/*!*********************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/selection.js ***!\n  \\*********************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/array */ 13),\n\t\t__webpack_require__(/*! dojo/dom */ 14), // dom.byId\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9),\n\t\t__webpack_require__(/*! dojo/sniff */ 10), // has(\"ie\") has(\"opera\")\n\t\t__webpack_require__(/*! dojo/_base/window */ 15),\n\t\t__webpack_require__(/*! dijit/focus */ 62)\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(array, dom, lang, has, baseWindow, focus){\n\t\n\t\t// module:\n\t\t//\t\tdijit/selection\n\t\n\t\t// Note that this class is using feature detection, but doesn't use has() because sometimes on IE the outer window\n\t\t// may be running in standards mode (ie, IE9 mode) but an iframe may be in compatibility mode.   So the code path\n\t\t// used will vary based on the window.\n\t\n\t\tvar SelectionManager = function(win){\n\t\t\t// summary:\n\t\t\t//\t\tClass for monitoring / changing the selection (typically highlighted text) in a given window\n\t\t\t// win: Window\n\t\t\t//\t\tThe window to monitor/adjust the selection on.\n\t\n\t\t\tvar doc = win.document;\n\t\n\t\t\tthis.getType = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tGet the selection type (like doc.select.type in IE).\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar stype = \"text\";\n\t\n\t\t\t\t\t// Check if the actual selection is a CONTROL (IMG, TABLE, HR, etc...).\n\t\t\t\t\tvar oSel;\n\t\t\t\t\ttry{\n\t\t\t\t\t\toSel = win.getSelection();\n\t\t\t\t\t}catch(e){ /*squelch*/ }\n\t\n\t\t\t\t\tif(oSel && oSel.rangeCount == 1){\n\t\t\t\t\t\tvar oRange = oSel.getRangeAt(0);\n\t\t\t\t\t\tif(\t(oRange.startContainer == oRange.endContainer) &&\n\t\t\t\t\t\t\t((oRange.endOffset - oRange.startOffset) == 1) &&\n\t\t\t\t\t\t\t(oRange.startContainer.nodeType != 3 /* text node*/)\n\t\t\t\t\t\t\t){\n\t\t\t\t\t\t\tstype = \"control\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn stype; //String\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\treturn doc.selection.type.toLowerCase();\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.getSelectedText = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturn the text (no html tags) included in the current selection or null if no text is selected\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\treturn selection ? selection.toString() : \"\"; //String\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\tif(this.getType() == 'control'){\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn doc.selection.createRange().text;\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.getSelectedHtml = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturn the html text of the current selection or null if unavailable\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\tif(selection && selection.rangeCount){\n\t\t\t\t\t\tvar i;\n\t\t\t\t\t\tvar html = \"\";\n\t\t\t\t\t\tfor(i = 0; i < selection.rangeCount; i++){\n\t\t\t\t\t\t\t//Handle selections spanning ranges, such as Opera\n\t\t\t\t\t\t\tvar frag = selection.getRangeAt(i).cloneContents();\n\t\t\t\t\t\t\tvar div = doc.createElement(\"div\");\n\t\t\t\t\t\t\tdiv.appendChild(frag);\n\t\t\t\t\t\t\thtml += div.innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn html; //String\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\tif(this.getType() == 'control'){\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn doc.selection.createRange().htmlText;\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.getSelectedElement = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tRetrieves the selected element (if any), just in the case that\n\t\t\t\t//\t\ta single element (object like and image or a table) is\n\t\t\t\t//\t\tselected.\n\t\t\t\tif(this.getType() == \"control\"){\n\t\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t\t// W3C path\n\t\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\t\treturn selection.anchorNode.childNodes[ selection.anchorOffset ];\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// IE6-8\n\t\t\t\t\t\tvar range = doc.selection.createRange();\n\t\t\t\t\t\tif(range && range.item){\n\t\t\t\t\t\t\treturn doc.selection.createRange().item(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tthis.getParentElement = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tGet the parent element of the current selection\n\t\t\t\tif(this.getType() == \"control\"){\n\t\t\t\t\tvar p = this.getSelectedElement();\n\t\t\t\t\tif(p){ return p.parentNode; }\n\t\t\t\t}else{\n\t\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t\tvar selection = doc.getSelection();\n\t\t\t\t\t\tif(selection){\n\t\t\t\t\t\t\tvar node = selection.anchorNode;\n\t\t\t\t\t\t\twhile(node && (node.nodeType != 1)){ // not an element\n\t\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar r = doc.selection.createRange();\n\t\t\t\t\t\tr.collapse(true);\n\t\t\t\t\t\treturn r.parentElement();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tthis.hasAncestorElement = function(/*String*/ tagName /* ... */){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tCheck whether current selection has a  parent element which is\n\t\t\t\t//\t\tof type tagName (or one of the other specified tagName)\n\t\t\t\t// tagName: String\n\t\t\t\t//\t\tThe tag name to determine if it has an ancestor of.\n\t\t\t\treturn this.getAncestorElement.apply(this, arguments) != null; //Boolean\n\t\t\t};\n\t\n\t\t\tthis.getAncestorElement = function(/*String*/ tagName /* ... */){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturn the parent element of the current selection which is of\n\t\t\t\t//\t\ttype tagName (or one of the other specified tagName)\n\t\t\t\t// tagName: String\n\t\t\t\t//\t\tThe tag name to determine if it has an ancestor of.\n\t\t\t\tvar node = this.getSelectedElement() || this.getParentElement();\n\t\t\t\treturn this.getParentOfType(node, arguments); //DOMNode\n\t\t\t};\n\t\n\t\t\tthis.isTag = function(/*DomNode*/ node, /*String[]*/ tags){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to determine if a node is one of an array of tags.\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to inspect.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tAn array of tag name strings to check to see if the node matches.\n\t\t\t\tif(node && node.tagName){\n\t\t\t\t\tvar _nlc = node.tagName.toLowerCase();\n\t\t\t\t\tfor(var i=0; i<tags.length; i++){\n\t\t\t\t\t\tvar _tlc = String(tags[i]).toLowerCase();\n\t\t\t\t\t\tif(_nlc == _tlc){\n\t\t\t\t\t\t\treturn _tlc; // String\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn \"\";\n\t\t\t};\n\t\n\t\t\tthis.getParentOfType = function(/*DomNode*/ node, /*String[]*/ tags){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to locate a parent node that matches one of a set of tags\n\t\t\t\t// node:\n\t\t\t\t//\t\tThe node to inspect.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tAn array of tag name strings to check to see if the node matches.\n\t\t\t\twhile(node){\n\t\t\t\t\tif(this.isTag(node, tags).length){\n\t\t\t\t\t\treturn node; // DOMNode\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tthis.collapse = function(/*Boolean*/ beginning){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to collapse (clear), the current selection\n\t\t\t\t// beginning: Boolean\n\t\t\t\t//\t\tIndicates whether to collapse the cursor to the beginning of the selection or end.\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\tif(selection.removeAllRanges){ // Mozilla\n\t\t\t\t\t\tif(beginning){\n\t\t\t\t\t\t\tselection.collapseToStart();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tselection.collapseToEnd();\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ // Safari\n\t\t\t\t\t\t// pulled from WebCore/ecma/kjs_window.cpp, line 2536\n\t\t\t\t\t\tselection.collapse(beginning);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\tvar range = doc.selection.createRange();\n\t\t\t\t\trange.collapse(beginning);\n\t\t\t\t\trange.select();\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.remove = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tFunction to delete the currently selected content from the document.\n\t\t\t\tvar sel = doc.selection;\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tsel = win.getSelection();\n\t\t\t\t\tsel.deleteFromDocument();\n\t\t\t\t\treturn sel; //Selection\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\tif(sel.type.toLowerCase() != \"none\"){\n\t\t\t\t\t\tsel.clear();\n\t\t\t\t\t}\n\t\t\t\t\treturn sel; //Selection\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.selectElementChildren = function(/*DomNode*/ element, /*Boolean?*/ nochangefocus){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tclear previous selection and select the content of the node\n\t\t\t\t//\t\t(excluding the node itself)\n\t\t\t\t// element: DOMNode\n\t\t\t\t//\t\tThe element you wish to select the children content of.\n\t\t\t\t// nochangefocus: Boolean\n\t\t\t\t//\t\tIndicates if the focus should change or not.\n\t\n\t\t\t\tvar range;\n\t\t\t\telement = dom.byId(element);\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C\n\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\tif(has(\"opera\")){\n\t\t\t\t\t\t//Opera's selectAllChildren doesn't seem to work right\n\t\t\t\t\t\t//against <body> nodes and possibly others ... so\n\t\t\t\t\t\t//we use the W3C range API\n\t\t\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trange = doc.createRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setStart(element, 0);\n\t\t\t\t\t\trange.setEnd(element,(element.nodeType == 3) ? element.length : element.childNodes.length);\n\t\t\t\t\t\tselection.addRange(range);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tselection.selectAllChildren(element);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\trange = element.ownerDocument.body.createTextRange();\n\t\t\t\t\trange.moveToElementText(element);\n\t\t\t\t\tif(!nochangefocus){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\trange.select(); // IE throws an exception here if the widget is hidden.  See #5439\n\t\t\t\t\t\t}catch(e){ /* squelch */}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.selectElement = function(/*DomNode*/ element, /*Boolean?*/ nochangefocus){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tclear previous selection and select element (including all its children)\n\t\t\t\t// element: DOMNode\n\t\t\t\t//\t\tThe element to select.\n\t\t\t\t// nochangefocus: Boolean\n\t\t\t\t//\t\tBoolean indicating if the focus should be changed.  IE only.\n\t\t\t\tvar range;\n\t\t\t\telement = dom.byId(element);\t// TODO: remove for 2.0 or sooner, spec listed above doesn't allow for string\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar selection = doc.getSelection();\n\t\t\t\t\trange = doc.createRange();\n\t\t\t\t\tif(selection.removeAllRanges){ // Mozilla\n\t\t\t\t\t\t// FIXME: does this work on Safari?\n\t\t\t\t\t\tif(has(\"opera\")){\n\t\t\t\t\t\t\t//Opera works if you use the current range on\n\t\t\t\t\t\t\t//the selection if present.\n\t\t\t\t\t\t\tif(selection.getRangeAt(0)){\n\t\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.selectNode(element);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(range);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\ttry{\n\t\t\t\t\t\tvar tg = element.tagName ? element.tagName.toLowerCase() : \"\";\n\t\t\t\t\t\tif(tg === \"img\" || tg === \"table\"){\n\t\t\t\t\t\t\trange = baseWindow.body(doc).createControlRange();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trange = baseWindow.body(doc).createRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.addElement(element);\n\t\t\t\t\t\tif(!nochangefocus){\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tthis.selectElementChildren(element, nochangefocus);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.inSelection = function(node){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tThis function determines if 'node' is\n\t\t\t\t//\t\tin the current selection.\n\t\t\t\t// tags:\n\t\t\t\t//\t\tpublic\n\t\t\t\tif(node){\n\t\t\t\t\tvar newRange;\n\t\t\t\t\tvar range;\n\t\n\t\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t\t// WC3\n\t\t\t\t\t\tvar sel = win.getSelection();\n\t\t\t\t\t\tif(sel && sel.rangeCount > 0){\n\t\t\t\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(range && range.compareBoundaryPoints && doc.createRange){\n\t\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t\tnewRange = doc.createRange();\n\t\t\t\t\t\t\t\tnewRange.setStart(node, 0);\n\t\t\t\t\t\t\t\tif(range.compareBoundaryPoints(range.START_TO_END, newRange) === 1){\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}catch(e){ /* squelch */}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// IE6-8, so we can't use the range object as the pseudo\n\t\t\t\t\t\t// range doesn't implement the boundary checking, we have to\n\t\t\t\t\t\t// use IE specific crud.\n\t\t\t\t\t\trange = doc.selection.createRange();\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tnewRange = node.ownerDocument.body.createTextRange();\n\t\t\t\t\t\t\tnewRange.moveToElementText(node);\n\t\t\t\t\t\t}catch(e2){/* squelch */}\n\t\t\t\t\t\tif(range && newRange){\n\t\t\t\t\t\t\t// We can finally compare similar to W3C\n\t\t\t\t\t\t\tif(range.compareEndPoints(\"EndToStart\", newRange) === 1){\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false; // Boolean\n\t\t\t};\n\t\n\t\t\tthis.getBookmark = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tRetrieves a bookmark that can be used with moveToBookmark to reselect the currently selected range.\n\t\n\t\t\t\t// TODO: merge additional code from Editor._getBookmark into this method\n\t\n\t\t\t\tvar bm, rg, tg, sel = doc.selection, cf = focus.curNode;\n\t\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C Range API for selections.\n\t\t\t\t\tsel = win.getSelection();\n\t\t\t\t\tif(sel){\n\t\t\t\t\t\tif(sel.isCollapsed){\n\t\t\t\t\t\t\ttg = cf? cf.tagName : \"\";\n\t\t\t\t\t\t\tif(tg){\n\t\t\t\t\t\t\t\t// Create a fake rangelike item to restore selections.\n\t\t\t\t\t\t\t\ttg = tg.toLowerCase();\n\t\t\t\t\t\t\t\tif(tg == \"textarea\" ||\n\t\t\t\t\t\t\t\t\t(tg == \"input\" && (!cf.type || cf.type.toLowerCase() == \"text\"))){\n\t\t\t\t\t\t\t\t\tsel = {\n\t\t\t\t\t\t\t\t\t\tstart: cf.selectionStart,\n\t\t\t\t\t\t\t\t\t\tend: cf.selectionEnd,\n\t\t\t\t\t\t\t\t\t\tnode: cf,\n\t\t\t\t\t\t\t\t\t\tpRange: true\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\treturn {isCollapsed: (sel.end <= sel.start), mark: sel}; //Object.\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbm = {isCollapsed:true};\n\t\t\t\t\t\t\tif(sel.rangeCount){\n\t\t\t\t\t\t\t\tbm.mark = sel.getRangeAt(0).cloneRange();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trg = sel.getRangeAt(0);\n\t\t\t\t\t\t\tbm = {isCollapsed: false, mark: rg.cloneRange()};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(sel){\n\t\t\t\t\t// If the current focus was a input of some sort and no selection, don't bother saving\n\t\t\t\t\t// a native bookmark.  This is because it causes issues with dialog/page selection restore.\n\t\t\t\t\t// So, we need to create pseudo bookmarks to work with.\n\t\t\t\t\ttg = cf ? cf.tagName : \"\";\n\t\t\t\t\ttg = tg.toLowerCase();\n\t\t\t\t\tif(cf && tg && (tg == \"button\" || tg == \"textarea\" || tg == \"input\")){\n\t\t\t\t\t\tif(sel.type && sel.type.toLowerCase() == \"none\"){\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tisCollapsed: true,\n\t\t\t\t\t\t\t\tmark: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trg = sel.createRange();\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tisCollapsed: rg.text && rg.text.length?false:true,\n\t\t\t\t\t\t\t\tmark: {\n\t\t\t\t\t\t\t\t\trange: rg,\n\t\t\t\t\t\t\t\t\tpRange: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbm = {};\n\t\n\t\t\t\t\t//'IE' way for selections.\n\t\t\t\t\ttry{\n\t\t\t\t\t\t// createRange() throws exception when dojo in iframe\n\t\t\t\t\t\t// and nothing selected, see #9632\n\t\t\t\t\t\trg = sel.createRange();\n\t\t\t\t\t\tbm.isCollapsed = !(sel.type == 'Text' ? rg.htmlText.length : rg.length);\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tbm.isCollapsed = true;\n\t\t\t\t\t\treturn bm;\n\t\t\t\t\t}\n\t\t\t\t\tif(sel.type.toUpperCase() == 'CONTROL'){\n\t\t\t\t\t\tif(rg.length){\n\t\t\t\t\t\t\tbm.mark=[];\n\t\t\t\t\t\t\tvar i=0,len=rg.length;\n\t\t\t\t\t\t\twhile(i<len){\n\t\t\t\t\t\t\t\tbm.mark.push(rg.item(i++));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbm.isCollapsed = true;\n\t\t\t\t\t\t\tbm.mark = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbm.mark = rg.getBookmark();\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tconsole.warn(\"No idea how to store the current selection for this browser!\");\n\t\t\t\t}\n\t\t\t\treturn bm; // Object\n\t\t\t};\n\t\n\t\t\tthis.moveToBookmark = function(/*Object*/ bookmark){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tMoves current selection to a bookmark.\n\t\t\t\t// bookmark:\n\t\t\t\t//\t\tThis should be a returned object from getBookmark().\n\t\n\t\t\t\t// TODO: merge additional code from Editor._moveToBookmark into this method\n\t\n\t\t\t\tvar mark = bookmark.mark;\n\t\t\t\tif(mark){\n\t\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t\t// W3C Range API (FF, WebKit, Opera, etc)\n\t\t\t\t\t\tvar sel = win.getSelection();\n\t\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\t\tif(mark.pRange){\n\t\t\t\t\t\t\t\tvar n = mark.node;\n\t\t\t\t\t\t\t\tn.selectionStart = mark.start;\n\t\t\t\t\t\t\t\tn.selectionEnd = mark.end;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\t\tsel.addRange(mark);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tconsole.warn(\"No idea how to restore selection for this browser!\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(doc.selection && mark){\n\t\t\t\t\t\t//'IE' way.\n\t\t\t\t\t\tvar rg;\n\t\t\t\t\t\tif(mark.pRange){\n\t\t\t\t\t\t\trg = mark.range;\n\t\t\t\t\t\t}else if(lang.isArray(mark)){\n\t\t\t\t\t\t\trg = doc.body.createControlRange();\n\t\t\t\t\t\t\t//rg.addElement does not have call/apply method, so can not call it directly\n\t\t\t\t\t\t\t//rg is not available in \"range.addElement(item)\", so can't use that either\n\t\t\t\t\t\t\tarray.forEach(mark, function(n){\n\t\t\t\t\t\t\t\trg.addElement(n);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trg = doc.body.createTextRange();\n\t\t\t\t\t\t\trg.moveToBookmark(mark);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trg.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.isCollapsed = function(){\n\t\t\t\t// summary:\n\t\t\t\t//\t\tReturns true if there is no text selected\n\t\t\t\treturn this.getBookmark().isCollapsed;\n\t\t\t};\n\t\t};\n\t\n\t\t// singleton on the main window\n\t\tvar selection = new SelectionManager(window);\n\t\n\t\t// hook for editor to use class\n\t\tselection.SelectionManager = SelectionManager;\n\t\n\t\treturn selection;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 157:\n/*!*************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/range.js ***!\n  \\*************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/array */ 13), // array.every\n\t\t__webpack_require__(/*! dojo/_base/declare */ 33), // declare\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9) // lang.isArray\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(array, declare, lang){\n\t\n\t\t// module:\n\t\t//\t\tdijit/_editor/range\n\t\n\t\tvar rangeapi = {\n\t\t\t// summary:\n\t\t\t//\t\tW3C range API\n\t\n\t\t\tgetIndex: function(/*DomNode*/ node, /*DomNode*/ parent){\n\t\t\t\tvar ret = [], retR = [];\n\t\t\t\tvar onode = node;\n\t\n\t\t\t\tvar pnode, n;\n\t\t\t\twhile(node != parent){\n\t\t\t\t\tvar i = 0;\n\t\t\t\t\tpnode = node.parentNode;\n\t\t\t\t\twhile((n = pnode.childNodes[i++])){\n\t\t\t\t\t\tif(n === node){\n\t\t\t\t\t\t\t--i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//if(i>=pnode.childNodes.length){\n\t\t\t\t\t//console.debug(\"Error finding index of a node in dijit/range.getIndex()\");\n\t\t\t\t\t//}\n\t\t\t\t\tret.unshift(i);\n\t\t\t\t\tretR.unshift(i - pnode.childNodes.length);\n\t\t\t\t\tnode = pnode;\n\t\t\t\t}\n\t\n\t\t\t\t//normalized() can not be called so often to prevent\n\t\t\t\t//invalidating selection/range, so we have to detect\n\t\t\t\t//here that any text nodes in a row\n\t\t\t\tif(ret.length > 0 && onode.nodeType == 3){\n\t\t\t\t\tn = onode.previousSibling;\n\t\t\t\t\twhile(n && n.nodeType == 3){\n\t\t\t\t\t\tret[ret.length - 1]--;\n\t\t\t\t\t\tn = n.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tn = onode.nextSibling;\n\t\t\t\t\twhile(n && n.nodeType == 3){\n\t\t\t\t\t\tretR[retR.length - 1]++;\n\t\t\t\t\t\tn = n.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn {o: ret, r:retR};\n\t\t\t},\n\t\n\t\t\tgetNode: function(/*Array*/ index, /*DomNode*/ parent){\n\t\t\t\tif(!lang.isArray(index) || index.length == 0){\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tvar node = parent;\n\t\t\t\t//\tif(!node)debugger\n\t\t\t\tarray.every(index, function(i){\n\t\t\t\t\tif(i >= 0 && i < node.childNodes.length){\n\t\t\t\t\t\tnode = node.childNodes[i];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t//console.debug('Error: can not find node with index',index,'under parent node',parent );\n\t\t\t\t\t\treturn false; //terminate array.every\n\t\t\t\t\t}\n\t\t\t\t\treturn true; //carry on the every loop\n\t\t\t\t});\n\t\n\t\t\t\treturn node;\n\t\t\t},\n\t\n\t\t\tgetCommonAncestor: function(n1, n2, root){\n\t\t\t\troot = root || n1.ownerDocument.body;\n\t\t\t\tvar getAncestors = function(n){\n\t\t\t\t\tvar as = [];\n\t\t\t\t\twhile(n){\n\t\t\t\t\t\tas.unshift(n);\n\t\t\t\t\t\tif(n !== root){\n\t\t\t\t\t\t\tn = n.parentNode;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn as;\n\t\t\t\t};\n\t\t\t\tvar n1as = getAncestors(n1);\n\t\t\t\tvar n2as = getAncestors(n2);\n\t\n\t\t\t\tvar m = Math.min(n1as.length, n2as.length);\n\t\t\t\tvar com = n1as[0]; //at least, one element should be in the array: the root (BODY by default)\n\t\t\t\tfor(var i = 1; i < m; i++){\n\t\t\t\t\tif(n1as[i] === n2as[i]){\n\t\t\t\t\t\tcom = n1as[i]\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn com;\n\t\t\t},\n\t\n\t\t\tgetAncestor: function(/*DomNode*/ node, /*RegEx?*/ regex, /*DomNode?*/ root){\n\t\t\t\troot = root || node.ownerDocument.body;\n\t\t\t\twhile(node && node !== root){\n\t\t\t\t\tvar name = node.nodeName.toUpperCase();\n\t\t\t\t\tif(regex.test(name)){\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\t\n\t\t\tBlockTagNames: /^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,\n\t\n\t\t\tgetBlockAncestor: function(/*DomNode*/ node, /*RegEx?*/ regex, /*DomNode?*/ root){\n\t\t\t\troot = root || node.ownerDocument.body;\n\t\t\t\tregex = regex || rangeapi.BlockTagNames;\n\t\t\t\tvar block = null, blockContainer;\n\t\t\t\twhile(node && node !== root){\n\t\t\t\t\tvar name = node.nodeName.toUpperCase();\n\t\t\t\t\tif(!block && regex.test(name)){\n\t\t\t\t\t\tblock = node;\n\t\t\t\t\t}\n\t\t\t\t\tif(!blockContainer && (/^(?:BODY|TD|TH|CAPTION)$/).test(name)){\n\t\t\t\t\t\tblockContainer = node;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn {blockNode:block, blockContainer:blockContainer || node.ownerDocument.body};\n\t\t\t},\n\t\n\t\t\tatBeginningOfContainer: function(/*DomNode*/ container, /*DomNode*/ node, /*Int*/ offset){\n\t\t\t\tvar atBeginning = false;\n\t\t\t\tvar offsetAtBeginning = (offset == 0);\n\t\t\t\tif(!offsetAtBeginning && node.nodeType == 3){ //if this is a text node, check whether the left part is all space\n\t\t\t\t\tif(/^[\\s\\xA0]+$/.test(node.nodeValue.substr(0, offset))){\n\t\t\t\t\t\toffsetAtBeginning = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(offsetAtBeginning){\n\t\t\t\t\tvar cnode = node;\n\t\t\t\t\tatBeginning = true;\n\t\t\t\t\twhile(cnode && cnode !== container){\n\t\t\t\t\t\tif(cnode.previousSibling){\n\t\t\t\t\t\t\tatBeginning = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcnode = cnode.parentNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn atBeginning;\n\t\t\t},\n\t\n\t\t\tatEndOfContainer: function(/*DomNode*/ container, /*DomNode*/ node, /*Int*/ offset){\n\t\t\t\tvar atEnd = false;\n\t\t\t\tvar offsetAtEnd = (offset == (node.length || node.childNodes.length));\n\t\t\t\tif(!offsetAtEnd && node.nodeType == 3){ //if this is a text node, check whether the right part is all space\n\t\t\t\t\tif(/^[\\s\\xA0]+$/.test(node.nodeValue.substr(offset))){\n\t\t\t\t\t\toffsetAtEnd = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(offsetAtEnd){\n\t\t\t\t\tvar cnode = node;\n\t\t\t\t\tatEnd = true;\n\t\t\t\t\twhile(cnode && cnode !== container){\n\t\t\t\t\t\tif(cnode.nextSibling){\n\t\t\t\t\t\t\tatEnd = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcnode = cnode.parentNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn atEnd;\n\t\t\t},\n\t\n\t\t\tadjacentNoneTextNode: function(startnode, next){\n\t\t\t\tvar node = startnode;\n\t\t\t\tvar len = (0 - startnode.length) || 0;\n\t\t\t\tvar prop = next ? 'nextSibling' : 'previousSibling';\n\t\t\t\twhile(node){\n\t\t\t\t\tif(node.nodeType != 3){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlen += node.length;\n\t\t\t\t\tnode = node[prop];\n\t\t\t\t}\n\t\t\t\treturn [node,len];\n\t\t\t},\n\t\n\t\t\tcreate: function(/*Window?*/ win){\t// TODO: for 2.0, replace optional window param w/mandatory window or document param\n\t\t\t\twin = win || window;\n\t\t\t\tif(win.getSelection){\n\t\t\t\t\treturn win.document.createRange();\n\t\t\t\t}else{//IE\n\t\t\t\t\treturn new W3CRange();\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\tgetSelection: function(/*Window*/ window, /*Boolean?*/ ignoreUpdate){\n\t\t\t\tif(window.getSelection){\n\t\t\t\t\treturn window.getSelection();\n\t\t\t\t}else{//IE\n\t\t\t\t\tvar s = new ie.selection(window);\n\t\t\t\t\tif(!ignoreUpdate){\n\t\t\t\t\t\ts._getCurrentSelection();\n\t\t\t\t\t}\n\t\t\t\t\treturn s;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// TODO: convert to has() test?   But remember IE9 issues with quirks vs. standards in main frame vs. iframe.\n\t\tif(!window.getSelection){\n\t\t\tvar ie = rangeapi.ie = {\n\t\t\t\tcachedSelection: {},\n\t\t\t\tselection: function(window){\n\t\t\t\t\tthis._ranges = [];\n\t\t\t\t\tthis.addRange = function(r, /*boolean*/ internal){\n\t\t\t\t\t\tthis._ranges.push(r);\n\t\t\t\t\t\tif(!internal){\n\t\t\t\t\t\t\tr._select();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.rangeCount = this._ranges.length;\n\t\t\t\t\t};\n\t\t\t\t\tthis.removeAllRanges = function(){\n\t\t\t\t\t\t//don't detach, the range may be used later\n\t\t\t\t\t\t//\t\t\t\tfor(var i=0;i<this._ranges.length;i++){\n\t\t\t\t\t\t//\t\t\t\t\tthis._ranges[i].detach();\n\t\t\t\t\t\t//\t\t\t\t}\n\t\t\t\t\t\tthis._ranges = [];\n\t\t\t\t\t\tthis.rangeCount = 0;\n\t\t\t\t\t};\n\t\t\t\t\tvar _initCurrentRange = function(){\n\t\t\t\t\t\tvar r = window.document.selection.createRange();\n\t\t\t\t\t\tvar type = window.document.selection.type.toUpperCase();\n\t\t\t\t\t\tif(type == \"CONTROL\"){\n\t\t\t\t\t\t\t//TODO: multiple range selection(?)\n\t\t\t\t\t\t\treturn new W3CRange(ie.decomposeControlRange(r));\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn new W3CRange(ie.decomposeTextRange(r));\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.getRangeAt = function(i){\n\t\t\t\t\t\treturn this._ranges[i];\n\t\t\t\t\t};\n\t\t\t\t\tthis._getCurrentSelection = function(){\n\t\t\t\t\t\tthis.removeAllRanges();\n\t\t\t\t\t\tvar r = _initCurrentRange();\n\t\t\t\t\t\tif(r){\n\t\t\t\t\t\t\tthis.addRange(r, true);\n\t\t\t\t\t\t\tthis.isCollapsed = r.collapsed;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthis.isCollapsed = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tdecomposeControlRange: function(range){\n\t\t\t\t\tvar firstnode = range.item(0), lastnode = range.item(range.length - 1);\n\t\t\t\t\tvar startContainer = firstnode.parentNode, endContainer = lastnode.parentNode;\n\t\t\t\t\tvar startOffset = rangeapi.getIndex(firstnode, startContainer).o[0];\n\t\t\t\t\tvar endOffset = rangeapi.getIndex(lastnode, endContainer).o[0] + 1;\n\t\t\t\t\treturn [startContainer, startOffset,endContainer, endOffset];\n\t\t\t\t},\n\t\t\t\tgetEndPoint: function(range, end){\n\t\t\t\t\tvar atmrange = range.duplicate();\n\t\t\t\t\tatmrange.collapse(!end);\n\t\t\t\t\tvar cmpstr = 'EndTo' + (end ? 'End' : 'Start');\n\t\t\t\t\tvar parentNode = atmrange.parentElement();\n\t\n\t\t\t\t\tvar startnode, startOffset, lastNode;\n\t\t\t\t\tif(parentNode.childNodes.length > 0){\n\t\t\t\t\t\tarray.every(parentNode.childNodes, function(node, i){\n\t\t\t\t\t\t\tvar calOffset;\n\t\t\t\t\t\t\tif(node.nodeType != 3){\n\t\t\t\t\t\t\t\tatmrange.moveToElementText(node);\n\t\n\t\t\t\t\t\t\t\tif(atmrange.compareEndPoints(cmpstr, range) > 0){\n\t\t\t\t\t\t\t\t\t//startnode = node.previousSibling;\n\t\t\t\t\t\t\t\t\tif(lastNode && lastNode.nodeType == 3){\n\t\t\t\t\t\t\t\t\t\t//where shall we put the start? in the text node or after?\n\t\t\t\t\t\t\t\t\t\tstartnode = lastNode;\n\t\t\t\t\t\t\t\t\t\tcalOffset = true;\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\t\t\t\t\t\tstartOffset = i;\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tif(i == parentNode.childNodes.length - 1){\n\t\t\t\t\t\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\t\t\t\t\t\tstartOffset = parentNode.childNodes.length;\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tif(i == parentNode.childNodes.length - 1){//at the end of this node\n\t\t\t\t\t\t\t\t\tstartnode = node;\n\t\t\t\t\t\t\t\t\tcalOffset = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//\t\t\ttry{\n\t\t\t\t\t\t\tif(calOffset && startnode){\n\t\t\t\t\t\t\t\tvar prevnode = rangeapi.adjacentNoneTextNode(startnode)[0];\n\t\t\t\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\t\t\t\tstartnode = prevnode.nextSibling;\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tstartnode = parentNode.firstChild; //firstChild must be a text node\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar prevnodeobj = rangeapi.adjacentNoneTextNode(startnode);\n\t\t\t\t\t\t\t\tprevnode = prevnodeobj[0];\n\t\t\t\t\t\t\t\tvar lenoffset = prevnodeobj[1];\n\t\t\t\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\t\t\t\tatmrange.moveToElementText(prevnode);\n\t\t\t\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tatmrange.moveToElementText(parentNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tatmrange.setEndPoint(cmpstr, range);\n\t\t\t\t\t\t\t\tstartOffset = atmrange.text.length - lenoffset;\n\t\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//\t\t\t}catch(e){ debugger }\n\t\t\t\t\t\t\tlastNode = node;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\t\tstartOffset = 0;\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//if at the end of startnode and we are dealing with start container, then\n\t\t\t\t\t//move the startnode to nextSibling if it is a text node\n\t\t\t\t\t//TODO: do this for end container?\n\t\t\t\t\tif(!end && startnode.nodeType == 1 && startOffset == startnode.childNodes.length){\n\t\t\t\t\t\tvar nextnode = startnode.nextSibling;\n\t\t\t\t\t\tif(nextnode && nextnode.nodeType == 3){\n\t\t\t\t\t\t\tstartnode = nextnode;\n\t\t\t\t\t\t\tstartOffset = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn [startnode, startOffset];\n\t\t\t\t},\n\t\t\t\tsetEndPoint: function(range, container, offset){\n\t\t\t\t\t//text node\n\t\t\t\t\tvar atmrange = range.duplicate(), node, len;\n\t\t\t\t\tif(container.nodeType != 3){ //normal node\n\t\t\t\t\t\tif(offset > 0){\n\t\t\t\t\t\t\tnode = container.childNodes[offset - 1];\n\t\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\t\tif(node.nodeType == 3){\n\t\t\t\t\t\t\t\t\tcontainer = node;\n\t\t\t\t\t\t\t\t\toffset = node.length;\n\t\t\t\t\t\t\t\t\t//pass through\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tif(node.nextSibling && node.nextSibling.nodeType == 3){\n\t\t\t\t\t\t\t\t\t\tcontainer = node.nextSibling;\n\t\t\t\t\t\t\t\t\t\toffset = 0;\n\t\t\t\t\t\t\t\t\t\t//pass through\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tatmrange.moveToElementText(node.nextSibling ? node : container);\n\t\t\t\t\t\t\t\t\t\tvar parent = node.parentNode;\n\t\t\t\t\t\t\t\t\t\tvar tempNode = parent.insertBefore(node.ownerDocument.createTextNode(' '), node.nextSibling);\n\t\t\t\t\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t\t\t\t\tparent.removeChild(tempNode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tatmrange.moveToElementText(container);\n\t\t\t\t\t\t\tatmrange.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(container.nodeType == 3){\n\t\t\t\t\t\tvar prevnodeobj = rangeapi.adjacentNoneTextNode(container);\n\t\t\t\t\t\tvar prevnode = prevnodeobj[0];\n\t\t\t\t\t\tlen = prevnodeobj[1];\n\t\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\t\tatmrange.moveToElementText(prevnode);\n\t\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t\t//if contentEditable is not inherit, the above collapse won't make the end point\n\t\t\t\t\t\t\t//in the correctly position: it always has a -1 offset, so compensate it\n\t\t\t\t\t\t\tif(prevnode.contentEditable != 'inherit'){\n\t\t\t\t\t\t\t\tlen++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tatmrange.moveToElementText(container.parentNode);\n\t\t\t\t\t\t\tatmrange.collapse(true);\n\t\n\t\t\t\t\t\t\t// Correct internal cursor position\n\t\t\t\t\t\t\t// http://bugs.dojotoolkit.org/ticket/15578\n\t\t\t\t\t\t\tatmrange.move('character', 1);\n\t\t\t\t\t\t\tatmrange.move('character', -1);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\toffset += len;\n\t\t\t\t\t\tif(offset > 0){\n\t\t\t\t\t\t\tif(atmrange.move('character', offset) != offset){\n\t\t\t\t\t\t\t\tconsole.error('Error when moving!');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn atmrange;\n\t\t\t\t},\n\t\t\t\tdecomposeTextRange: function(range){\n\t\t\t\t\tvar tmpary = ie.getEndPoint(range);\n\t\t\t\t\tvar startContainer = tmpary[0], startOffset = tmpary[1];\n\t\t\t\t\tvar endContainer = tmpary[0], endOffset = tmpary[1];\n\t\n\t\t\t\t\tif(range.htmlText.length){\n\t\t\t\t\t\tif(range.htmlText == range.text){ //in the same text node\n\t\t\t\t\t\t\tendOffset = startOffset + range.text.length;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpary = ie.getEndPoint(range, true);\n\t\t\t\t\t\t\tendContainer = tmpary[0],endOffset = tmpary[1];\n\t\t\t\t\t\t\t//\t\t\t\t\tif(startContainer.tagName == \"BODY\"){\n\t\t\t\t\t\t\t//\t\t\t\t\t\tstartContainer = startContainer.firstChild;\n\t\t\t\t\t\t\t//\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn [startContainer, startOffset, endContainer, endOffset];\n\t\t\t\t},\n\t\t\t\tsetRange: function(range, startContainer, startOffset, endContainer, endOffset, collapsed){\n\t\t\t\t\tvar start = ie.setEndPoint(range, startContainer, startOffset);\n\t\n\t\t\t\t\trange.setEndPoint('StartToStart', start);\n\t\t\t\t\tif(!collapsed){\n\t\t\t\t\t\tvar end = ie.setEndPoint(range, endContainer, endOffset);\n\t\t\t\t\t}\n\t\t\t\t\trange.setEndPoint('EndToEnd', end || start);\n\t\n\t\t\t\t\treturn range;\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tvar W3CRange = rangeapi.W3CRange = declare(null, {\n\t\t\t\tconstructor: function(){\n\t\t\t\t\tif(arguments.length>0){\n\t\t\t\t\t\tthis.setStart(arguments[0][0],arguments[0][1]);\n\t\t\t\t\t\tthis.setEnd(arguments[0][2],arguments[0][3]);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.commonAncestorContainer = null;\n\t\t\t\t\t\tthis.startContainer = null;\n\t\t\t\t\t\tthis.startOffset = 0;\n\t\t\t\t\t\tthis.endContainer = null;\n\t\t\t\t\t\tthis.endOffset = 0;\n\t\t\t\t\t\tthis.collapsed = true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_updateInternal: function(){\n\t\t\t\t\tif(this.startContainer !== this.endContainer){\n\t\t\t\t\t\tthis.commonAncestorContainer = rangeapi.getCommonAncestor(this.startContainer, this.endContainer);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.commonAncestorContainer = this.startContainer;\n\t\t\t\t\t}\n\t\t\t\t\tthis.collapsed = (this.startContainer === this.endContainer) && (this.startOffset == this.endOffset);\n\t\t\t\t},\n\t\t\t\tsetStart: function(node, offset){\n\t\t\t\t\toffset=parseInt(offset);\n\t\t\t\t\tif(this.startContainer === node && this.startOffset == offset){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._cachedBookmark;\n\t\n\t\t\t\t\tthis.startContainer = node;\n\t\t\t\t\tthis.startOffset = offset;\n\t\t\t\t\tif(!this.endContainer){\n\t\t\t\t\t\tthis.setEnd(node, offset);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._updateInternal();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetEnd: function(node, offset){\n\t\t\t\t\toffset=parseInt(offset);\n\t\t\t\t\tif(this.endContainer === node && this.endOffset == offset){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdelete this._cachedBookmark;\n\t\n\t\t\t\t\tthis.endContainer = node;\n\t\t\t\t\tthis.endOffset = offset;\n\t\t\t\t\tif(!this.startContainer){\n\t\t\t\t\t\tthis.setStart(node, offset);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._updateInternal();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetStartAfter: function(node, offset){\n\t\t\t\t\tthis._setPoint('setStart', node, offset, 1);\n\t\t\t\t},\n\t\t\t\tsetStartBefore: function(node, offset){\n\t\t\t\t\tthis._setPoint('setStart', node, offset, 0);\n\t\t\t\t},\n\t\t\t\tsetEndAfter: function(node, offset){\n\t\t\t\t\tthis._setPoint('setEnd', node, offset, 1);\n\t\t\t\t},\n\t\t\t\tsetEndBefore: function(node, offset){\n\t\t\t\t\tthis._setPoint('setEnd', node, offset, 0);\n\t\t\t\t},\n\t\t\t\t_setPoint: function(what, node, offset, ext){\n\t\t\t\t\tvar index = rangeapi.getIndex(node, node.parentNode).o;\n\t\t\t\t\tthis[what](node.parentNode, index.pop()+ext);\n\t\t\t\t},\n\t\t\t\t_getIERange: function(){\n\t\t\t\t\tvar r = (this._body || this.endContainer.ownerDocument.body).createTextRange();\n\t\t\t\t\tie.setRange(r, this.startContainer, this.startOffset, this.endContainer, this.endOffset, this.collapsed);\n\t\t\t\t\treturn r;\n\t\t\t\t},\n\t\t\t\tgetBookmark: function(){\n\t\t\t\t\tthis._getIERange();\n\t\t\t\t\treturn this._cachedBookmark;\n\t\t\t\t},\n\t\t\t\t_select: function(){\n\t\t\t\t\tvar r = this._getIERange();\n\t\t\t\t\tr.select();\n\t\t\t\t},\n\t\t\t\tdeleteContents: function(){\n\t\t\t\t\tvar s = this.startContainer, r = this._getIERange();\n\t\t\t\t\tif(s.nodeType === 3 && !this.startOffset){\n\t\t\t\t\t\t//if the range starts at the beginning of a\n\t\t\t\t\t\t//text node, move it to before the textnode\n\t\t\t\t\t\t//to make sure the range is still valid\n\t\t\t\t\t\t//after deleteContents() finishes\n\t\t\t\t\t\tthis.setStartBefore(s);\n\t\t\t\t\t}\n\t\t\t\t\tr.pasteHTML('');\n\t\t\t\t\tthis.endContainer = this.startContainer;\n\t\t\t\t\tthis.endOffset = this.startOffset;\n\t\t\t\t\tthis.collapsed = true;\n\t\t\t\t},\n\t\t\t\tcloneRange: function(){\n\t\t\t\t\tvar r = new W3CRange([this.startContainer,this.startOffset,\n\t\t\t\t\t\tthis.endContainer,this.endOffset]);\n\t\t\t\t\tr._body = this._body;\n\t\t\t\t\treturn r;\n\t\t\t\t},\n\t\t\t\tdetach: function(){\n\t\t\t\t\tthis._body = null;\n\t\t\t\t\tthis.commonAncestorContainer = null;\n\t\t\t\t\tthis.startContainer = null;\n\t\t\t\t\tthis.startOffset = 0;\n\t\t\t\t\tthis.endContainer = null;\n\t\t\t\t\tthis.endOffset = 0;\n\t\t\t\t\tthis.collapsed = true;\n\t\t\t\t}\n\t\t\t});\n\t\t} //if(!window.getSelection)\n\t\n\t\t// remove for 2.0\n\t\tlang.setObject(\"dijit.range\", rangeapi);\n\t\n\t\treturn rangeapi;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 158:\n/*!************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/html.js ***!\n  \\************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [\n\t\t__webpack_require__(/*! dojo/_base/array */ 13),\n\t\t__webpack_require__(/*! dojo/_base/lang */ 9), // lang.setObject\n\t\t__webpack_require__(/*! dojo/sniff */ 10) // has(\"ie\")\n\t], __WEBPACK_AMD_DEFINE_RESULT__ = function(array, lang, has){\n\t\n\t\t// module:\n\t\t//\t\tdijit/_editor/html\n\t\n\t\tvar exports = {\n\t\t\t// summary:\n\t\t\t//\t\tHTML serialization utility functions used by editor\n\t\t};\n\t\tlang.setObject(\"dijit._editor.html\", exports);\n\t\n\t\tvar escape = exports.escapeXml = function(/*String*/ str, /*Boolean?*/ noSingleQuotes){\n\t\t\t// summary:\n\t\t\t//\t\tAdds escape sequences for special characters in XML: `&<>\"'`.\n\t\t\t//\t\tOptionally skips escapes for single quotes.\n\t\t\tstr = str.replace(/&/gm, \"&amp;\").replace(/</gm, \"&lt;\").replace(/>/gm, \"&gt;\").replace(/\"/gm, \"&quot;\");\n\t\t\tif(!noSingleQuotes){\n\t\t\t\tstr = str.replace(/'/gm, \"&#39;\");\n\t\t\t}\n\t\t\treturn str; // string\n\t\t};\n\t\n\t\texports.getNodeHtml = function(/*DomNode*/ node){\n\t\t\t// summary:\n\t\t\t//\t\tReturn string representing HTML for node and it's children\n\t\t\tvar output = [];\n\t\t\texports.getNodeHtmlHelper(node, output);\n\t\t\treturn output.join(\"\");\n\t\t};\n\t\n\t\texports.getNodeHtmlHelper = function(/*DomNode*/ node, /*String[]*/ output){\n\t\t\t// summary:\n\t\t\t//\t\tPushes array of strings into output[] which represent HTML for node and it's children\n\t\t\tswitch(node.nodeType){\n\t\t\t\tcase 1: // element node\n\t\t\t\t\tvar lName = node.nodeName.toLowerCase();\n\t\t\t\t\tif(!lName || lName.charAt(0) == \"/\"){\n\t\t\t\t\t\t// IE does some strange things with malformed HTML input, like\n\t\t\t\t\t\t// treating a close tag </span> without an open tag <span>, as\n\t\t\t\t\t\t// a new tag with tagName of /span.  Corrupts output HTML, remove\n\t\t\t\t\t\t// them.  Other browsers don't prefix tags that way, so will\n\t\t\t\t\t\t// never show up.\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t}\n\t\t\t\t\toutput.push('<', lName);\n\t\n\t\t\t\t\t// store the list of attributes and sort it to have the\n\t\t\t\t\t// attributes appear in the dictionary order\n\t\t\t\t\tvar attrarray = [], attrhash = {};\n\t\t\t\t\tvar attr;\n\t\t\t\t\tif(has(\"dom-attributes-explicit\") || has(\"dom-attributes-specified-flag\")){\n\t\t\t\t\t\t// IE8+ and all other browsers.\n\t\t\t\t\t\tvar i = 0;\n\t\t\t\t\t\twhile((attr = node.attributes[i++])){\n\t\t\t\t\t\t\t// ignore all attributes starting with _dj which are\n\t\t\t\t\t\t\t// internal temporary attributes used by the editor\n\t\t\t\t\t\t\tvar n = attr.name;\n\t\t\t\t\t\t\tif(n.substr(0, 3) !== '_dj' &&\n\t\t\t\t\t\t\t\t(!has(\"dom-attributes-specified-flag\") || attr.specified) && !(n in attrhash)){    // workaround repeated attributes bug in IE8 (LinkDialog test)\n\t\t\t\t\t\t\t\tvar v = attr.value;\n\t\t\t\t\t\t\t\tif(n == 'src' || n == 'href'){\n\t\t\t\t\t\t\t\t\tif(node.getAttribute('_djrealurl')){\n\t\t\t\t\t\t\t\t\t\tv = node.getAttribute('_djrealurl');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(has(\"ie\") === 8 && n === \"style\"){\n\t\t\t\t\t\t\t\t\tv = v.replace(\"HEIGHT:\", \"height:\").replace(\"WIDTH:\", \"width:\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tattrarray.push([n, v]);\n\t\t\t\t\t\t\t\tattrhash[n] = v;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// IE6-7 code path\n\t\t\t\t\t\tvar clone = /^input$|^img$/i.test(node.nodeName) ? node : node.cloneNode(false);\n\t\t\t\t\t\tvar s = clone.outerHTML;\n\t\t\t\t\t\t// Split up and manage the attrs via regexp\n\t\t\t\t\t\t// similar to prettyPrint attr logic.\n\t\t\t\t\t\tvar rgxp_attrsMatch = /[\\w-]+=(\"[^\"]*\"|'[^']*'|\\S*)/gi\n\t\t\t\t\t\tvar attrSplit = s.match(rgxp_attrsMatch);\n\t\t\t\t\t\ts = s.substr(0, s.indexOf('>'));\n\t\t\t\t\t\tarray.forEach(attrSplit, function(attr){\n\t\t\t\t\t\t\tif(attr){\n\t\t\t\t\t\t\t\tvar idx = attr.indexOf(\"=\");\n\t\t\t\t\t\t\t\tif(idx > 0){\n\t\t\t\t\t\t\t\t\tvar key = attr.substring(0, idx);\n\t\t\t\t\t\t\t\t\tif(key.substr(0, 3) != '_dj'){\n\t\t\t\t\t\t\t\t\t\tif(key == 'src' || key == 'href'){\n\t\t\t\t\t\t\t\t\t\t\tif(node.getAttribute('_djrealurl')){\n\t\t\t\t\t\t\t\t\t\t\t\tattrarray.push([key, node.getAttribute('_djrealurl')]);\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tvar val, match;\n\t\t\t\t\t\t\t\t\t\tswitch(key){\n\t\t\t\t\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\t\t\t\t\tval = node.style.cssText.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t\t\t\t\t\tval = node.className;\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\t\t\t\t\t\t\tif(lName === \"img\"){\n\t\t\t\t\t\t\t\t\t\t\t\t\t// This somehow gets lost on IE for IMG tags and the like\n\t\t\t\t\t\t\t\t\t\t\t\t\t// and we have to find it in outerHTML, known IE oddity.\n\t\t\t\t\t\t\t\t\t\t\t\t\tmatch = /width=(\\S+)/i.exec(s);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = match[1];\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\t\t\t\t\t\t\tif(lName === \"img\"){\n\t\t\t\t\t\t\t\t\t\t\t\t\t// This somehow gets lost on IE for IMG tags and the like\n\t\t\t\t\t\t\t\t\t\t\t\t\t// and we have to find it in outerHTML, known IE oddity.\n\t\t\t\t\t\t\t\t\t\t\t\t\tmatch = /height=(\\S+)/i.exec(s);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tval = match[1];\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tval = node.getAttribute(key);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(val != null){\n\t\t\t\t\t\t\t\t\t\t\tattrarray.push([key, val.toString()]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\t\t\t\t\t}\n\t\t\t\t\tattrarray.sort(function(a, b){\n\t\t\t\t\t\treturn a[0] < b[0] ? -1 : (a[0] == b[0] ? 0 : 1);\n\t\t\t\t\t});\n\t\t\t\t\tvar j = 0;\n\t\t\t\t\twhile((attr = attrarray[j++])){\n\t\t\t\t\t\toutput.push(' ', attr[0], '=\"',\n\t\t\t\t\t\t\t(typeof attr[1] === \"string\" ? escape(attr[1], true) : attr[1]), '\"');\n\t\t\t\t\t}\n\t\t\t\t\tswitch(lName){\n\t\t\t\t\t\tcase 'br':\n\t\t\t\t\t\tcase 'hr':\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tcase 'base':\n\t\t\t\t\t\tcase 'meta':\n\t\t\t\t\t\tcase 'area':\n\t\t\t\t\t\tcase 'basefont':\n\t\t\t\t\t\t\t// These should all be singly closed\n\t\t\t\t\t\t\toutput.push(' />');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\t// Browsers handle script tags differently in how you get content,\n\t\t\t\t\t\t\t// but innerHTML always seems to work, so insert its content that way\n\t\t\t\t\t\t\t// Yes, it's bad to allow script tags in the editor code, but some people\n\t\t\t\t\t\t\t// seem to want to do it, so we need to at least return them right.\n\t\t\t\t\t\t\t// other plugins/filters can strip them.\n\t\t\t\t\t\t\toutput.push('>', node.innerHTML, '</', lName, '>');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\toutput.push('>');\n\t\t\t\t\t\t\tif(node.hasChildNodes()){\n\t\t\t\t\t\t\t\texports.getChildrenHtmlHelper(node, output);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toutput.push('</', lName, '>');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4: // cdata\n\t\t\t\tcase 3: // text\n\t\t\t\t\t// FIXME:\n\t\t\t\t\toutput.push(escape(node.nodeValue, true));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8: // comment\n\t\t\t\t\t// FIXME:\n\t\t\t\t\toutput.push('<!--', escape(node.nodeValue, true), '-->');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\toutput.push(\"<!-- Element not recognized - Type: \", node.nodeType, \" Name: \", node.nodeName, \"-->\");\n\t\t\t}\n\t\t};\n\t\n\t\texports.getChildrenHtml = function(/*DomNode*/ node){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the html content of a DomNode's children\n\t\t\tvar output = [];\n\t\t\texports.getChildrenHtmlHelper(node, output);\n\t\t\treturn output.join(\"\");\n\t\t};\n\t\n\t\texports.getChildrenHtmlHelper = function(/*DomNode*/ dom, /*String[]*/ output){\n\t\t\t// summary:\n\t\t\t//\t\tPushes the html content of a DomNode's children into out[]\n\t\n\t\t\tif(!dom){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar nodes = dom[\"childNodes\"] || dom;\n\t\n\t\t\t// IE issue.\n\t\t\t// If we have an actual node we can check parent relationships on for IE,\n\t\t\t// We should check, as IE sometimes builds invalid DOMS.  If no parent, we can't check\n\t\t\t// And should just process it and hope for the best.\n\t\t\tvar checkParent = !has(\"ie\") || nodes !== dom;\n\t\n\t\t\tvar node, i = 0;\n\t\t\twhile((node = nodes[i++])){\n\t\t\t\t// IE is broken.  DOMs are supposed to be a tree.  But in the case of malformed HTML, IE generates a graph\n\t\t\t\t// meaning one node ends up with multiple references (multiple parents).  This is totally wrong and invalid, but\n\t\t\t\t// such is what it is.  We have to keep track and check for this because otherwise the source output HTML will have dups.\n\t\t\t\t// No other browser generates a graph.  Leave it to IE to break a fundamental DOM rule.  So, we check the parent if we can\n\t\t\t\t// If we can't, nothing more we can do other than walk it.\n\t\t\t\tif(!checkParent || node.parentNode == dom){\n\t\t\t\t\texports.getNodeHtmlHelper(node, output);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\treturn exports;\n\t}.apply(null, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n\n/***/ 159:\n/*!*************************************************************************************************!*\\\n  !*** ../dojo-webpack-plugin/loaders/dojo/i18n!C:/Users/Chuck/git/dijit/_editor/nls/commands.js ***!\n  \\*************************************************************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(/*! dijit/_editor/nls/commands?absMid=dijit/_editor/nls/commands */ 160);\n\tmodule.exports = __webpack_require__(/*! ../dojo-webpack-plugin/loaders/dojo/i18n/runner.js */ 116)(\"dijit/_editor/nls/commands\");\n\n/***/ }),\n\n/***/ 160:\n/*!********************************************************!*\\\n  !*** C:/Users/Chuck/git/dijit/_editor/nls/commands.js ***!\n  \\********************************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\t!(module.exports = { root:\n\t//begin v1.x content\n\t({\n\t\t'bold': 'Bold',\n\t\t'copy': 'Copy',\n\t\t'cut': 'Cut',\n\t\t'delete': 'Delete',\n\t\t'indent': 'Indent',\n\t\t'insertHorizontalRule': 'Horizontal Rule',\n\t\t'insertOrderedList': 'Numbered List',\n\t\t'insertUnorderedList': 'Bullet List',\n\t\t'italic': 'Italic',\n\t\t'justifyCenter': 'Align Center',\n\t\t'justifyFull': 'Justify',\n\t\t'justifyLeft': 'Align Left',\n\t\t'justifyRight': 'Align Right',\n\t\t'outdent': 'Outdent',\n\t\t'paste': 'Paste',\n\t\t'redo': 'Redo',\n\t\t'removeFormat': 'Remove Format',\n\t\t'selectAll': 'Select All',\n\t\t'strikethrough': 'Strikethrough',\n\t\t'subscript': 'Subscript',\n\t\t'superscript': 'Superscript',\n\t\t'underline': 'Underline',\n\t\t'undo': 'Undo',\n\t\t'unlink': 'Remove Link',\n\t\t'createLink': 'Create Link',\n\t\t'toggleDir': 'Toggle Direction',\n\t\t'insertImage': 'Insert Image',\n\t\t'insertTable': 'Insert/Edit Table',\n\t\t'toggleTableBorder': 'Toggle Table Border',\n\t\t'deleteTable': 'Delete Table',\n\t\t'tableProp': 'Table Property',\n\t\t'htmlToggle': 'HTML Source',\n\t\t'foreColor': 'Foreground Color',\n\t\t'hiliteColor': 'Background Color',\n\t\t'plainFormatBlock': 'Paragraph Style',\n\t\t'formatBlock': 'Paragraph Style',\n\t\t'fontSize': 'Font Size',\n\t\t'fontName': 'Font Name',\n\t\t'tabIndent': 'Tab Indent',\n\t\t\"fullScreen\": \"Toggle Full Screen\",\n\t\t\"viewSource\": \"View HTML Source\",\n\t\t\"print\": \"Print\",\n\t\t\"newPage\": \"New Page\",\n\t\t/* Error messages */\n\t\t'systemShortcut': 'The \"${0}\" action is only available in your browser using a keyboard shortcut. Use ${1}.',\n\t\t'ctrlKey':'ctrl+${0}',\n\t\t'appleKey':'\\u2318${0}' // \"command\" or open-apple key on Macintosh\n\t})\n\t//end v1.x content\n\t,\n\t\"zh\": true,\n\t\"zh-tw\": true,\n\t\"uk\": true,\n\t\"tr\": true,\n\t\"th\": true,\n\t\"sv\": true,\n\t\"sl\": true,\n\t\"sk\": true,\n\t\"ru\": true,\n\t\"ro\": true,\n\t\"pt\": true,\n\t\"pt-pt\": true,\n\t\"pl\": true,\n\t\"nl\": true,\n\t\"nb\": true,\n\t\"ko\": true,\n\t\"kk\": true,\n\t\"ja\": true,\n\t\"it\": true,\n\t\"id\": true,\n\t\"hu\": true,\n\t\"hr\": true,\n\t\"he\": true,\n\t\"fr\": true,\n\t\"fi\": true,\n\t\"es\": true,\n\t\"el\": true,\n\t\"de\": true,\n\t\"da\": true,\n\t\"cs\": true,\n\t\"ca\": true,\n\t\"bg\": true,\n\t\"az\": true,\n\t\"ar\": true\n\t});\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 3.bundle.js","define([\n\t\"require\",\n\t\"dojo/_base/array\", // array.forEach\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/Deferred\", // Deferred\n\t\"dojo/i18n\", // i18n.getLocalization\n\t\"dojo/dom-attr\", // domAttr.set\n\t\"dojo/dom-class\", // domClass.add\n\t\"dojo/dom-geometry\",\n\t\"dojo/dom-style\", // domStyle.set, get\n\t\"dojo/keys\", // keys.F1 keys.F15 keys.TAB\n\t\"dojo/_base/lang\", // lang.getObject lang.hitch\n\t\"dojo/sniff\", // has(\"ie\") has(\"mac\") has(\"webkit\")\n\t\"dojo/string\", // string.substitute\n\t\"dojo/topic\", // topic.publish()\n\t\"./_Container\",\n\t\"./Toolbar\",\n\t\"./ToolbarSeparator\",\n\t\"./layout/_LayoutWidget\",\n\t\"./form/ToggleButton\",\n\t\"./_editor/_Plugin\",\n\t\"./_editor/plugins/EnterKeyHandling\",\n\t\"./_editor/html\",\n\t\"./_editor/range\",\n\t\"./_editor/RichText\",\n\t\"./main\", // dijit._scopeName\n\t\"dojo/i18n!./_editor/nls/commands\"\n], function(require, array, declare, Deferred, i18n, domAttr, domClass, domGeometry, domStyle,\n\t\t\tkeys, lang, has, string, topic,\n\t\t\t_Container, Toolbar, ToolbarSeparator, _LayoutWidget, ToggleButton,\n\t\t\t_Plugin, EnterKeyHandling, html, rangeapi, RichText, dijit){\n\n\t// module:\n\t//\t\tdijit/Editor\n\n\tvar Editor = declare(\"dijit.Editor\", RichText, {\n\t\t// summary:\n\t\t//\t\tA rich text Editing widget\n\t\t//\n\t\t// description:\n\t\t//\t\tThis widget provides basic WYSIWYG editing features, based on the browser's\n\t\t//\t\tunderlying rich text editing capability, accompanied by a toolbar (`dijit.Toolbar`).\n\t\t//\t\tA plugin model is available to extend the editor's capabilities as well as the\n\t\t//\t\tthe options available in the toolbar.  Content generation may vary across\n\t\t//\t\tbrowsers, and clipboard operations may have different results, to name\n\t\t//\t\ta few limitations.  Note: this widget should not be used with the HTML\n\t\t//\t\t&lt;TEXTAREA&gt; tag -- see dijit/_editor/RichText for details.\n\n\t\t// plugins: [const] Object[]\n\t\t//\t\tA list of plugin names (as strings) or instances (as objects)\n\t\t//\t\tfor this widget.\n\t\t//\n\t\t//\t\tWhen declared in markup, it might look like:\n\t\t//\t|\tplugins=\"['bold',{name:'dijit._editor.plugins.FontChoice', command:'fontName', generic:true}]\"\n\t\tplugins: null,\n\n\t\t// extraPlugins: [const] Object[]\n\t\t//\t\tA list of extra plugin names which will be appended to plugins array\n\t\textraPlugins: null,\n\n\t\tconstructor: function(/*===== params, srcNodeRef =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tCreate the widget.\n\t\t\t// params: Object|null\n\t\t\t//\t\tInitial settings for any of the attributes, except readonly attributes.\n\t\t\t// srcNodeRef: DOMNode\n\t\t\t//\t\tThe editor replaces the specified DOMNode.\n\n\t\t\tif(!lang.isArray(this.plugins)){\n\t\t\t\tthis.plugins = [\"undo\", \"redo\", \"|\", \"cut\", \"copy\", \"paste\", \"|\", \"bold\", \"italic\", \"underline\", \"strikethrough\", \"|\",\n\t\t\t\t\t\"insertOrderedList\", \"insertUnorderedList\", \"indent\", \"outdent\", \"|\", \"justifyLeft\", \"justifyRight\", \"justifyCenter\", \"justifyFull\",\n\t\t\t\t\tEnterKeyHandling /*, \"createLink\"*/];\n\t\t\t}\n\n\t\t\tthis._plugins = [];\n\t\t\tthis._editInterval = this.editActionInterval * 1000;\n\n\t\t\t//IE will always lose focus when other element gets focus, while for FF and safari,\n\t\t\t//when no iframe is used, focus will be lost whenever another element gets focus.\n\t\t\t//For IE, we can connect to onBeforeDeactivate, which will be called right before\n\t\t\t//the focus is lost, so we can obtain the selected range. For other browsers,\n\t\t\t//no equivalent of onBeforeDeactivate, so we need to do two things to make sure\n\t\t\t//selection is properly saved before focus is lost: 1) when user clicks another\n\t\t\t//element in the page, in which case we listen to mousedown on the entire page and\n\t\t\t//see whether user clicks out of a focus editor, if so, save selection (focus will\n\t\t\t//only lost after onmousedown event is fired, so we can obtain correct caret pos.)\n\t\t\t//2) when user tabs away from the editor, which is handled in onKeyDown below.\n\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\tthis.events.push(\"onBeforeDeactivate\");\n\t\t\t\tthis.events.push(\"onBeforeActivate\");\n\t\t\t}\n\t\t},\n\n\t\tpostMixInProperties: function(){\n\t\t\t// summary:\n\t\t\t//\tExtension to make sure a deferred is in place before certain functions\n\t\t\t//\texecute, like making sure all the plugins are properly inserted.\n\n\t\t\t// Set up a deferred so that the value isn't applied to the editor\n\t\t\t// until all the plugins load, needed to avoid timing condition\n\t\t\t// reported in #10537.\n\t\t\tthis.setValueDeferred = new Deferred();\n\t\t\tthis.inherited(arguments);\n\t\t},\n\n\t\tpostCreate: function(){\n\t\t\tthis.inherited(arguments);\n\n\t\t\t//for custom undo/redo, if enabled.\n\t\t\tthis._steps = this._steps.slice(0);\n\t\t\tthis._undoedSteps = this._undoedSteps.slice(0);\n\n\t\t\tif(lang.isArray(this.extraPlugins)){\n\t\t\t\tthis.plugins = this.plugins.concat(this.extraPlugins);\n\t\t\t}\n\n\t\t\tthis.commands = i18n.getLocalization(\"dijit._editor\", \"commands\", this.lang);\n\n\t\t\tif(has(\"webkit\")){\n\t\t\t\t// Disable selecting the entire editor by inadvertent double-clicks.\n\t\t\t\t// on buttons, title bar, etc.  Otherwise clicking too fast on\n\t\t\t\t// a button such as undo/redo selects the entire editor.\n\t\t\t\tdomStyle.set(this.domNode, \"KhtmlUserSelect\", \"none\");\n\t\t\t}\n\t\t},\n\n\t\tstartup: function(){\n\n\t\t\tthis.inherited(arguments);\n\n\t\t\tif(!this.toolbar){\n\t\t\t\t// if we haven't been assigned a toolbar, create one\n\t\t\t\tthis.toolbar = new Toolbar({\n\t\t\t\t\townerDocument: this.ownerDocument,\n\t\t\t\t\tdir: this.dir,\n\t\t\t\t\tlang: this.lang,\n\t\t\t\t\t\"aria-label\": this.id\n\t\t\t\t});\n\t\t\t\tthis.header.appendChild(this.toolbar.domNode);\n\t\t\t}\n\n\t\t\tarray.forEach(this.plugins, this.addPlugin, this);\n\n\t\t\t// Okay, denote the value can now be set.\n\t\t\tthis.setValueDeferred.resolve(true);\n\n\t\t\tdomClass.add(this.iframe.parentNode, \"dijitEditorIFrameContainer\");\n\t\t\tdomClass.add(this.iframe, \"dijitEditorIFrame\");\n\t\t\tdomAttr.set(this.iframe, \"allowTransparency\", true);\n\n\t\t\tthis.toolbar.startup();\n\t\t\tthis.onNormalizedDisplayChanged(); //update toolbar button status\n\t\t},\n\n\t\tdestroy: function(){\n\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\tif(p && p.destroy){\n\t\t\t\t\tp.destroy();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._plugins = [];\n\t\t\tthis.toolbar.destroyRecursive();\n\t\t\tdelete this.toolbar;\n\t\t\tthis.inherited(arguments);\n\t\t},\n\t\taddPlugin: function(/*String||Object||Function*/ plugin, /*Integer?*/ index){\n\t\t\t// summary:\n\t\t\t//\t\ttakes a plugin name as a string or a plugin instance and\n\t\t\t//\t\tadds it to the toolbar and associates it with this editor\n\t\t\t//\t\tinstance. The resulting plugin is added to the Editor's\n\t\t\t//\t\tplugins array. If index is passed, it's placed in the plugins\n\t\t\t//\t\tarray at that index. No big magic, but a nice helper for\n\t\t\t//\t\tpassing in plugin names via markup.\n\t\t\t// plugin:\n\t\t\t//\t\tString, args object, plugin instance, or plugin constructor\n\t\t\t// args:\n\t\t\t//\t\tThis object will be passed to the plugin constructor\n\t\t\t// index:\n\t\t\t//\t\tUsed when creating an instance from\n\t\t\t//\t\tsomething already in this.plugins. Ensures that the new\n\t\t\t//\t\tinstance is assigned to this.plugins at that index.\n\t\t\tvar args = lang.isString(plugin) ? {name: plugin} : lang.isFunction(plugin) ? {ctor: plugin} : plugin;\n\t\t\tif(!args.setEditor){\n\t\t\t\tvar o = {\"args\": args, \"plugin\": null, \"editor\": this};\n\t\t\t\tif(args.name){\n\t\t\t\t\t// search registry for a plugin factory matching args.name, if it's not there then\n\t\t\t\t\t// fallback to 1.0 API:\n\t\t\t\t\t// ask all loaded plugin modules to fill in o.plugin if they can (ie, if they implement args.name)\n\t\t\t\t\t// remove fallback for 2.0.\n\t\t\t\t\tif(_Plugin.registry[args.name]){\n\t\t\t\t\t\to.plugin = _Plugin.registry[args.name](args);\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttopic.publish(dijit._scopeName + \".Editor.getPlugin\", o);\t// publish\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!o.plugin){\n\t\t\t\t\ttry{\n\t\t\t\t\t\t// TODO: remove lang.getObject() call in 2.0\n\t\t\t\t\t\tvar pc = args.ctor || lang.getObject(args.name) || require(args.name);\n\t\t\t\t\t\tif(pc){\n\t\t\t\t\t\t\to.plugin = new pc(args);\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\tthrow new Error(this.id + \": cannot find plugin [\" + args.name + \"]\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!o.plugin){\n\t\t\t\t\tthrow new Error(this.id + \": cannot find plugin [\" + args.name + \"]\");\n\t\t\t\t}\n\t\t\t\tplugin = o.plugin;\n\t\t\t}\n\t\t\tif(arguments.length > 1){\n\t\t\t\tthis._plugins[index] = plugin;\n\t\t\t}else{\n\t\t\t\tthis._plugins.push(plugin);\n\t\t\t}\n\t\t\tplugin.setEditor(this);\n\t\t\tif(lang.isFunction(plugin.setToolbar)){\n\t\t\t\tplugin.setToolbar(this.toolbar);\n\t\t\t}\n\t\t},\n\n\t\t//the following 2 functions are required to make the editor play nice under a layout widget, see #4070\n\n\t\tresize: function(size){\n\t\t\t// summary:\n\t\t\t//\t\tResize the editor to the specified size, see `dijit/layout/_LayoutWidget.resize()`\n\t\t\tif(size){\n\t\t\t\t// we've been given a height/width for the entire editor (toolbar + contents), calls layout()\n\t\t\t\t// to split the allocated size between the toolbar and the contents\n\t\t\t\t_LayoutWidget.prototype.resize.apply(this, arguments);\n\t\t\t}\n\t\t\t/*\n\t\t\t else{\n\t\t\t // do nothing, the editor is already laid out correctly.   The user has probably specified\n\t\t\t // the height parameter, which was used to set a size on the iframe\n\t\t\t }\n\t\t\t */\n\t\t},\n\t\tlayout: function(){\n\t\t\t// summary:\n\t\t\t//\t\tCalled from `dijit/layout/_LayoutWidget.resize()`.  This shouldn't be called directly\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\t// Converts the iframe (or rather the <div> surrounding it) to take all the available space\n\t\t\t// except what's needed for the header (toolbars) and footer (breadcrumbs, etc).\n\t\t\t// A class was added to the iframe container and some themes style it, so we have to\n\t\t\t// calc off the added margins and padding too. See tracker: #10662\n\t\t\tvar areaHeight = (this._contentBox.h -\n\t\t\t\t(this.getHeaderHeight() + this.getFooterHeight() +\n\t\t\t\t\tdomGeometry.getPadBorderExtents(this.iframe.parentNode).h +\n\t\t\t\t\tdomGeometry.getMarginExtents(this.iframe.parentNode).h));\n\t\t\tthis.editingArea.style.height = areaHeight + \"px\";\n\t\t\tif(this.iframe){\n\t\t\t\tthis.iframe.style.height = \"100%\";\n\t\t\t}\n\t\t\tthis._layoutMode = true;\n\t\t},\n\n\t\t_onIEMouseDown: function(/*Event*/ e){\n\t\t\t// summary:\n\t\t\t//\t\tIE only to prevent 2 clicks to focus\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar outsideClientArea;\n\t\t\t// IE 8's componentFromPoint is broken, which is a shame since it\n\t\t\t// was smaller code, but oh well.  We have to do this brute force\n\t\t\t// to detect if the click was scroller or not.\n\t\t\tvar b = this.document.body;\n\t\t\tvar clientWidth = b.clientWidth;\n\t\t\tvar clientHeight = b.clientHeight;\n\t\t\tvar clientLeft = b.clientLeft;\n\t\t\tvar offsetWidth = b.offsetWidth;\n\t\t\tvar offsetHeight = b.offsetHeight;\n\t\t\tvar offsetLeft = b.offsetLeft;\n\n\t\t\t//Check for vertical scroller click.\n\t\t\tif(/^rtl$/i.test(b.dir || \"\")){\n\t\t\t\tif(clientWidth < offsetWidth && e.x > clientWidth && e.x < offsetWidth){\n\t\t\t\t\t// Check the click was between width and offset width, if so, scroller\n\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// RTL mode, we have to go by the left offsets.\n\t\t\t\tif(e.x < clientLeft && e.x > offsetLeft){\n\t\t\t\t\t// Check the click was between width and offset width, if so, scroller\n\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!outsideClientArea){\n\t\t\t\t// Okay, might be horiz scroller, check that.\n\t\t\t\tif(clientHeight < offsetHeight && e.y > clientHeight && e.y < offsetHeight){\n\t\t\t\t\t// Horizontal scroller.\n\t\t\t\t\toutsideClientArea = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!outsideClientArea){\n\t\t\t\tdelete this._cursorToStart; // Remove the force to cursor to start position.\n\t\t\t\tdelete this._savedSelection; // new mouse position overrides old selection\n\t\t\t\tif(e.target.tagName == \"BODY\"){\n\t\t\t\t\tthis.defer(\"placeCursorAtEnd\");\n\t\t\t\t}\n\t\t\t\tthis.inherited(arguments);\n\t\t\t}\n\t\t},\n\t\tonBeforeActivate: function(){\n\t\t\tthis._restoreSelection();\n\t\t},\n\t\tonBeforeDeactivate: function(e){\n\t\t\t// summary:\n\t\t\t//\t\tCalled on IE right before focus is lost.   Saves the selected range.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this.customUndo){\n\t\t\t\tthis.endEditing(true);\n\t\t\t}\n\t\t\t//in IE, the selection will be lost when other elements get focus,\n\t\t\t//let's save focus before the editor is deactivated\n\t\t\tif(e.target.tagName != \"BODY\"){\n\t\t\t\tthis._saveSelection();\n\t\t\t}\n\t\t\t//console.log('onBeforeDeactivate',this);\n\t\t},\n\n\t\t/* beginning of custom undo/redo support */\n\n\t\t// customUndo: Boolean\n\t\t//\t\tWhether we shall use custom undo/redo support instead of the native\n\t\t//\t\tbrowser support. By default, we now use custom undo.  It works better\n\t\t//\t\tthan native browser support and provides a consistent behavior across\n\t\t//\t\tbrowsers with a minimal performance hit.  We already had the hit on\n\t\t//\t\tthe slowest browser, IE, anyway.\n\t\tcustomUndo: true,\n\n\t\t// editActionInterval: Integer\n\t\t//\t\tWhen using customUndo, not every keystroke will be saved as a step.\n\t\t//\t\tInstead typing (including delete) will be grouped together: after\n\t\t//\t\ta user stops typing for editActionInterval seconds, a step will be\n\t\t//\t\tsaved; if a user resume typing within editActionInterval seconds,\n\t\t//\t\tthe timeout will be restarted. By default, editActionInterval is 3\n\t\t//\t\tseconds.\n\t\teditActionInterval: 3,\n\n\t\tbeginEditing: function(cmd){\n\t\t\t// summary:\n\t\t\t//\t\tCalled to note that the user has started typing alphanumeric characters, if it's not already noted.\n\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(!this._inEditing){\n\t\t\t\tthis._inEditing = true;\n\t\t\t\tthis._beginEditing(cmd);\n\t\t\t}\n\t\t\tif(this.editActionInterval > 0){\n\t\t\t\tif(this._editTimer){\n\t\t\t\t\tthis._editTimer.remove();\n\t\t\t\t}\n\t\t\t\tthis._editTimer = this.defer(\"endEditing\", this._editInterval);\n\t\t\t}\n\t\t},\n\n\t\t// TODO: declaring these in the prototype is meaningless, just create in the constructor/postCreate\n\t\t_steps: [],\n\t\t_undoedSteps: [],\n\n\t\texecCommand: function(cmd){\n\t\t\t// summary:\n\t\t\t//\t\tMain handler for executing any commands to the editor, like paste, bold, etc.\n\t\t\t//\t\tCalled by plugins, but not meant to be called by end users.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(this.customUndo && (cmd == 'undo' || cmd == 'redo')){\n\t\t\t\treturn this[cmd]();\n\t\t\t}else{\n\t\t\t\tif(this.customUndo){\n\t\t\t\t\tthis.endEditing();\n\t\t\t\t\tthis._beginEditing();\n\t\t\t\t}\n\t\t\t\tvar r = this.inherited(arguments);\n\t\t\t\tif(this.customUndo){\n\t\t\t\t\tthis._endEditing();\n\t\t\t\t}\n\t\t\t\treturn r;\n\t\t\t}\n\t\t},\n\n\t\t_pasteImpl: function(){\n\t\t\t// summary:\n\t\t\t//\t\tOver-ride of paste command control to make execCommand cleaner\n\t\t\t// tags:\n\t\t\t//\t\tProtected\n\t\t\treturn this._clipboardCommand(\"paste\");\n\t\t},\n\n\t\t_cutImpl: function(){\n\t\t\t// summary:\n\t\t\t//\t\tOver-ride of cut command control to make execCommand cleaner\n\t\t\t// tags:\n\t\t\t//\t\tProtected\n\t\t\treturn this._clipboardCommand(\"cut\");\n\t\t},\n\n\t\t_copyImpl: function(){\n\t\t\t// summary:\n\t\t\t//\t\tOver-ride of copy command control to make execCommand cleaner\n\t\t\t// tags:\n\t\t\t//\t\tProtected\n\t\t\treturn this._clipboardCommand(\"copy\");\n\t\t},\n\n\t\t_clipboardCommand: function(cmd){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to handle processing clipboard commands (or at least try to).\n\t\t\t// tags:\n\t\t\t//\t\tPrivate\n\t\t\tvar r;\n\t\t\ttry{\n\t\t\t\t// Try to exec the superclass exec-command and see if it works.\n\t\t\t\tr = this.document.execCommand(cmd, false, null);\n\t\t\t\tif(has(\"webkit\") && !r){ //see #4598: webkit does not guarantee clipboard support from js\n\t\t\t\t\tthrow { code: 1011 }; // throw an object like Mozilla's error\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\t//TODO: when else might we get an exception?  Do we need the Mozilla test below?\n\t\t\t\tif(e.code == 1011 /* Mozilla: service denied */ ||\n\t\t\t\t\t(e.code == 9 && has(\"opera\") /* Opera not supported */)){\n\t\t\t\t\t// Warn user of platform limitation.  Cannot programmatically access clipboard. See ticket #4136\n\t\t\t\t\tvar sub = string.substitute,\n\t\t\t\t\t\taccel = {cut: 'X', copy: 'C', paste: 'V'};\n\t\t\t\t\talert(sub(this.commands.systemShortcut,\n\t\t\t\t\t\t[this.commands[cmd], sub(this.commands[has(\"mac\") ? 'appleKey' : 'ctrlKey'], [accel[cmd]])]));\n\t\t\t\t}\n\t\t\t\tr = false;\n\t\t\t}\n\t\t\treturn r;\n\t\t},\n\n\t\tqueryCommandEnabled: function(cmd){\n\t\t\t// summary:\n\t\t\t//\t\tReturns true if specified editor command is enabled.\n\t\t\t//\t\tUsed by the plugins to know when to highlight/not highlight buttons.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(this.customUndo && (cmd == 'undo' || cmd == 'redo')){\n\t\t\t\treturn cmd == 'undo' ? (this._steps.length > 1) : (this._undoedSteps.length > 0);\n\t\t\t}else{\n\t\t\t\treturn this.inherited(arguments);\n\t\t\t}\n\t\t},\n\t\t_moveToBookmark: function(b){\n\t\t\t// summary:\n\t\t\t//\t\tSelects the text specified in bookmark b\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar bookmark = b.mark;\n\t\t\tvar mark = b.mark;\n\t\t\tvar col = b.isCollapsed;\n\t\t\tvar r, sNode, eNode, sel;\n\t\t\tif(mark){\n\t\t\t\tif(has(\"ie\") < 9 || (has(\"ie\") === 9 && has(\"quirks\"))){\n\t\t\t\t\tif(lang.isArray(mark)){\n\t\t\t\t\t\t// IE CONTROL, have to use the native bookmark.\n\t\t\t\t\t\tbookmark = [];\n\t\t\t\t\t\tarray.forEach(mark, function(n){\n\t\t\t\t\t\t\tbookmark.push(rangeapi.getNode(n, this.editNode));\n\t\t\t\t\t\t}, this);\n\t\t\t\t\t\tthis.selection.moveToBookmark({mark: bookmark, isCollapsed: col});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(mark.startContainer && mark.endContainer){\n\t\t\t\t\t\t\t// Use the pseudo WC3 range API.  This works better for positions\n\t\t\t\t\t\t\t// than the IE native bookmark code.\n\t\t\t\t\t\t\tsel = rangeapi.getSelection(this.window);\n\t\t\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\t\tr = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\tsNode = rangeapi.getNode(mark.startContainer, this.editNode);\n\t\t\t\t\t\t\t\teNode = rangeapi.getNode(mark.endContainer, this.editNode);\n\t\t\t\t\t\t\t\tif(sNode && eNode){\n\t\t\t\t\t\t\t\t\t// Okay, we believe we found the position, so add it into the selection\n\t\t\t\t\t\t\t\t\t// There are cases where it may not be found, particularly in undo/redo, when\n\t\t\t\t\t\t\t\t\t// IE changes the underlying DOM on us (wraps text in a <p> tag or similar.\n\t\t\t\t\t\t\t\t\t// So, in those cases, don't bother restoring selection.\n\t\t\t\t\t\t\t\t\tr.setStart(sNode, mark.startOffset);\n\t\t\t\t\t\t\t\t\tr.setEnd(eNode, mark.endOffset);\n\t\t\t\t\t\t\t\t\tsel.addRange(r);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{//w3c range\n\t\t\t\t\tsel = rangeapi.getSelection(this.window);\n\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\tr = rangeapi.create(this.window);\n\t\t\t\t\t\tsNode = rangeapi.getNode(mark.startContainer, this.editNode);\n\t\t\t\t\t\teNode = rangeapi.getNode(mark.endContainer, this.editNode);\n\t\t\t\t\t\tif(sNode && eNode){\n\t\t\t\t\t\t\t// Okay, we believe we found the position, so add it into the selection\n\t\t\t\t\t\t\t// There are cases where it may not be found, particularly in undo/redo, when\n\t\t\t\t\t\t\t// formatting as been done and so on, so don't restore selection then.\n\t\t\t\t\t\t\tr.setStart(sNode, mark.startOffset);\n\t\t\t\t\t\t\tr.setEnd(eNode, mark.endOffset);\n\t\t\t\t\t\t\tsel.addRange(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_changeToStep: function(from, to){\n\t\t\t// summary:\n\t\t\t//\t\tReverts editor to \"to\" setting, from the undo stack.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tthis.setValue(to.text);\n\t\t\tvar b = to.bookmark;\n\t\t\tif(!b){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._moveToBookmark(b);\n\t\t},\n\t\tundo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for editor undo (ex: ctrl-z) operation\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar ret = false;\n\t\t\tif(!this._undoRedoActive){\n\t\t\t\tthis._undoRedoActive = true;\n\t\t\t\tthis.endEditing(true);\n\t\t\t\tvar s = this._steps.pop();\n\t\t\t\tif(s && this._steps.length > 0){\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis._changeToStep(s, this._steps[this._steps.length - 1]);\n\t\t\t\t\tthis._undoedSteps.push(s);\n\t\t\t\t\tthis.onDisplayChanged();\n\t\t\t\t\tdelete this._undoRedoActive;\n\t\t\t\t\tret = true;\n\t\t\t\t}\n\t\t\t\tdelete this._undoRedoActive;\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\t\tredo: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for editor redo (ex: ctrl-y) operation\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar ret = false;\n\t\t\tif(!this._undoRedoActive){\n\t\t\t\tthis._undoRedoActive = true;\n\t\t\t\tthis.endEditing(true);\n\t\t\t\tvar s = this._undoedSteps.pop();\n\t\t\t\tif(s && this._steps.length > 0){\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tthis._changeToStep(this._steps[this._steps.length - 1], s);\n\t\t\t\t\tthis._steps.push(s);\n\t\t\t\t\tthis.onDisplayChanged();\n\t\t\t\t\tret = true;\n\t\t\t\t}\n\t\t\t\tdelete this._undoRedoActive;\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\t\tendEditing: function(ignore_caret){\n\t\t\t// summary:\n\t\t\t//\t\tCalled to note that the user has stopped typing alphanumeric characters, if it's not already noted.\n\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this._editTimer){\n\t\t\t\tthis._editTimer = this._editTimer.remove();\n\t\t\t}\n\t\t\tif(this._inEditing){\n\t\t\t\tthis._endEditing(ignore_caret);\n\t\t\t\tthis._inEditing = false;\n\t\t\t}\n\t\t},\n\n\t\t_getBookmark: function(){\n\t\t\t// summary:\n\t\t\t//\t\tGet the currently selected text\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar b = this.selection.getBookmark();\n\t\t\tvar tmp = [];\n\t\t\tif(b && b.mark){\n\t\t\t\tvar mark = b.mark;\n\t\t\t\tif(has(\"ie\") < 9 || (has(\"ie\") === 9 && has(\"quirks\"))){\n\t\t\t\t\t// Try to use the pseudo range API on IE for better accuracy.\n\t\t\t\t\tvar sel = rangeapi.getSelection(this.window);\n\t\t\t\t\tif(!lang.isArray(mark)){\n\t\t\t\t\t\tif(sel){\n\t\t\t\t\t\t\tvar range;\n\t\t\t\t\t\t\tif(sel.rangeCount){\n\t\t\t\t\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(range){\n\t\t\t\t\t\t\t\tb.mark = range.cloneRange();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tb.mark = this.selection.getBookmark();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// Control ranges (img, table, etc), handle differently.\n\t\t\t\t\t\tarray.forEach(b.mark, function(n){\n\t\t\t\t\t\t\ttmp.push(rangeapi.getIndex(n, this.editNode).o);\n\t\t\t\t\t\t}, this);\n\t\t\t\t\t\tb.mark = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttry{\n\t\t\t\t\tif(b.mark && b.mark.startContainer){\n\t\t\t\t\t\ttmp = rangeapi.getIndex(b.mark.startContainer, this.editNode).o;\n\t\t\t\t\t\tb.mark = {startContainer: tmp,\n\t\t\t\t\t\t\tstartOffset: b.mark.startOffset,\n\t\t\t\t\t\t\tendContainer: b.mark.endContainer === b.mark.startContainer ? tmp : rangeapi.getIndex(b.mark.endContainer, this.editNode).o,\n\t\t\t\t\t\t\tendOffset: b.mark.endOffset};\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\tb.mark = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn b;\n\t\t},\n\t\t_beginEditing: function(){\n\t\t\t// summary:\n\t\t\t//\t\tCalled when the user starts typing alphanumeric characters.\n\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this._steps.length === 0){\n\t\t\t\t// You want to use the editor content without post filtering\n\t\t\t\t// to make sure selection restores right for the 'initial' state.\n\t\t\t\t// and undo is called.  So not using this.value, as it was 'processed'\n\t\t\t\t// and the line-up for selections may have been altered.\n\t\t\t\tthis._steps.push({'text': html.getChildrenHtml(this.editNode), 'bookmark': this._getBookmark()});\n\t\t\t}\n\t\t},\n\t\t_endEditing: function(){\n\t\t\t// summary:\n\t\t\t//\t\tCalled when the user stops typing alphanumeric characters.\n\t\t\t//\t\tDeals with saving undo; see editActionInterval parameter.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\t// Avoid filtering to make sure selections restore.\n\t\t\tvar v = html.getChildrenHtml(this.editNode);\n\n\t\t\tthis._undoedSteps = [];//clear undoed steps\n\t\t\tthis._steps.push({text: v, bookmark: this._getBookmark()});\n\t\t},\n\t\tonKeyDown: function(e){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for onkeydown event.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\t//We need to save selection if the user TAB away from this editor\n\t\t\t//no need to call _saveSelection for IE, as that will be taken care of in onBeforeDeactivate\n\t\t\tif(!has(\"ie\") && !this.iframe && e.keyCode == keys.TAB && !this.tabIndent){\n\t\t\t\tthis._saveSelection();\n\t\t\t}\n\t\t\tif(!this.customUndo){\n\t\t\t\tthis.inherited(arguments);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar k = e.keyCode;\n\t\t\tif(e.ctrlKey && !e.shiftKey && !e.altKey){//undo and redo only if the special right Alt + z/y are not pressed #5892\n\t\t\t\tif(k == 90 || k == 122){ //z, but also F11 key\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.undo();\n\t\t\t\t\treturn;\n\t\t\t\t}else if(k == 89 || k == 121){ //y\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.redo();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.inherited(arguments);\n\n\t\t\tswitch(k){\n\t\t\t\tcase keys.ENTER:\n\t\t\t\tcase keys.BACKSPACE:\n\t\t\t\tcase keys.DELETE:\n\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 88: //x\n\t\t\t\tcase 86: //v\n\t\t\t\t\tif(e.ctrlKey && !e.altKey && !e.metaKey){\n\t\t\t\t\t\tthis.endEditing();//end current typing step if any\n\t\t\t\t\t\tif(e.keyCode == 88){\n\t\t\t\t\t\t\tthis.beginEditing('cut');\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthis.beginEditing('paste');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//use timeout to trigger after the paste is complete\n\t\t\t\t\t\tthis.defer(\"endEditing\", 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t//pass through\n\t\t\t\tdefault:\n\t\t\t\t\tif(!e.ctrlKey && !e.altKey && !e.metaKey && (e.keyCode < keys.F1 || e.keyCode > keys.F15)){\n\t\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t//pass through\n\t\t\t\tcase keys.ALT:\n\t\t\t\t\tthis.endEditing();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keys.UP_ARROW:\n\t\t\t\tcase keys.DOWN_ARROW:\n\t\t\t\tcase keys.LEFT_ARROW:\n\t\t\t\tcase keys.RIGHT_ARROW:\n\t\t\t\tcase keys.HOME:\n\t\t\t\tcase keys.END:\n\t\t\t\tcase keys.PAGE_UP:\n\t\t\t\tcase keys.PAGE_DOWN:\n\t\t\t\t\tthis.endEditing(true);\n\t\t\t\t\tbreak;\n\t\t\t\t//maybe ctrl+backspace/delete, so don't endEditing when ctrl is pressed\n\t\t\t\tcase keys.CTRL:\n\t\t\t\tcase keys.SHIFT:\n\t\t\t\tcase keys.TAB:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\t_onBlur: function(){\n\t\t\t// summary:\n\t\t\t//\t\tCalled from focus manager when focus has moved away from this editor\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\t//this._saveSelection();\n\t\t\tthis.inherited(arguments);\n\t\t\tthis.endEditing(true);\n\t\t},\n\t\t_saveSelection: function(){\n\t\t\t// summary:\n\t\t\t//\t\tSave the currently selected text in _savedSelection attribute\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\ttry{\n\t\t\t\tthis._savedSelection = this._getBookmark();\n\t\t\t}catch(e){ /* Squelch any errors that occur if selection save occurs due to being hidden simultaneously. */\n\t\t\t}\n\t\t},\n\t\t_restoreSelection: function(){\n\t\t\t// summary:\n\t\t\t//\t\tRe-select the text specified in _savedSelection attribute;\n\t\t\t//\t\tsee _saveSelection().\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this._savedSelection){\n\t\t\t\t// Clear off cursor to start, we're deliberately going to a selection.\n\t\t\t\tdelete this._cursorToStart;\n\t\t\t\t// only restore the selection if the current range is collapsed\n\t\t\t\t// if not collapsed, then it means the editor does not lose\n\t\t\t\t// selection and there is no need to restore it\n\t\t\t\tif(this.selection.isCollapsed()){\n\t\t\t\t\tthis._moveToBookmark(this._savedSelection);\n\t\t\t\t}\n\t\t\t\tdelete this._savedSelection;\n\t\t\t}\n\t\t},\n\n\t\tonClick: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for when editor is clicked\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tthis.endEditing(true);\n\t\t\tthis.inherited(arguments);\n\t\t},\n\n\t\treplaceValue: function(/*String*/ html){\n\t\t\t// summary:\n\t\t\t//\t\tover-ride of replaceValue to support custom undo and stack maintenance.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(!this.customUndo){\n\t\t\t\tthis.inherited(arguments);\n\t\t\t}else{\n\t\t\t\tif(this.isClosed){\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.beginEditing();\n\t\t\t\t\tif(!html){\n\t\t\t\t\t\thtml = \"&#160;\";\t// &nbsp;\n\t\t\t\t\t}\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t\tthis.endEditing();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_setDisabledAttr: function(/*Boolean*/ value){\n\t\t\tthis.setValueDeferred.then(lang.hitch(this, function(){\n\t\t\t\tif((!this.disabled && value) || (!this._buttonEnabledPlugins && value)){\n\t\t\t\t\t// Disable editor: disable all enabled buttons and remember that list\n\t\t\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\t\t\tp.set(\"disabled\", true);\n\t\t\t\t\t});\n\t\t\t\t}else if(this.disabled && !value){\n\t\t\t\t\t// Restore plugins to being active.\n\t\t\t\t\tarray.forEach(this._plugins, function(p){\n\t\t\t\t\t\tp.set(\"disabled\", false);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.inherited(arguments);\n\t\t},\n\n\t\t_setStateClass: function(){\n\t\t\ttry{\n\t\t\t\tthis.inherited(arguments);\n\n\t\t\t\t// Let theme set the editor's text color based on editor enabled/disabled state.\n\t\t\t\t// We need to jump through hoops because the main document (where the theme CSS is)\n\t\t\t\t// is separate from the iframe's document.\n\t\t\t\tif(this.document && this.document.body){\n\t\t\t\t\tdomStyle.set(this.document.body, \"color\", domStyle.get(this.iframe, \"color\"));\n\t\t\t\t}\n\t\t\t}catch(e){ /* Squelch any errors caused by focus change if hidden during a state change */\n\t\t\t}\n\t\t}\n\t});\n\n\t// Register the \"default plugins\", ie, the built-in editor commands\n\tfunction simplePluginFactory(args){\n\t\treturn new _Plugin({ command: args.name });\n\t}\n\n\tfunction togglePluginFactory(args){\n\t\treturn new _Plugin({ buttonClass: ToggleButton, command: args.name });\n\t}\n\n\tlang.mixin(_Plugin.registry, {\n\t\t\"undo\": simplePluginFactory,\n\t\t\"redo\": simplePluginFactory,\n\t\t\"cut\": simplePluginFactory,\n\t\t\"copy\": simplePluginFactory,\n\t\t\"paste\": simplePluginFactory,\n\t\t\"insertOrderedList\": simplePluginFactory,\n\t\t\"insertUnorderedList\": simplePluginFactory,\n\t\t\"indent\": simplePluginFactory,\n\t\t\"outdent\": simplePluginFactory,\n\t\t\"justifyCenter\": simplePluginFactory,\n\t\t\"justifyFull\": simplePluginFactory,\n\t\t\"justifyLeft\": simplePluginFactory,\n\t\t\"justifyRight\": simplePluginFactory,\n\t\t\"delete\": simplePluginFactory,\n\t\t\"selectAll\": simplePluginFactory,\n\t\t\"removeFormat\": simplePluginFactory,\n\t\t\"unlink\": simplePluginFactory,\n\t\t\"insertHorizontalRule\": simplePluginFactory,\n\n\t\t\"bold\": togglePluginFactory,\n\t\t\"italic\": togglePluginFactory,\n\t\t\"underline\": togglePluginFactory,\n\t\t\"strikethrough\": togglePluginFactory,\n\t\t\"subscript\": togglePluginFactory,\n\t\t\"superscript\": togglePluginFactory,\n\n\t\t\"|\": function(){\n\t\t\treturn new _Plugin({\n\t\t\t\tsetEditor: function(editor){\n\t\t\t\t\tthis.editor = editor;\n\t\t\t\t\tthis.button = new ToolbarSeparator({ownerDocument: editor.ownerDocument});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n\treturn Editor;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/Editor.js\n// module id = 149\n// module chunks = 3","define([\n\t\"require\",\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/has\",\n\t\"dojo/keys\", // keys.LEFT_ARROW keys.RIGHT_ARROW\n\t\"dojo/ready\",\n\t\"./_Widget\",\n\t\"./_KeyNavContainer\",\n\t\"./_TemplatedMixin\"\n], function(require, declare, has, keys, ready, _Widget, _KeyNavContainer, _TemplatedMixin){\n\n\t// module:\n\t//\t\tdijit/Toolbar\n\n\n\t// Back compat w/1.6, remove for 2.0\n\tif(has(\"dijit-legacy-requires\")){\n\t\tready(0, function(){\n\t\t\tvar requires = [\"dijit/ToolbarSeparator\"];\n\t\t\trequire(requires);\t// use indirection so modules not rolled into a build\n\t\t});\n\t}\n\n\treturn declare(\"dijit.Toolbar\", [_Widget, _TemplatedMixin, _KeyNavContainer], {\n\t\t// summary:\n\t\t//\t\tA Toolbar widget, used to hold things like `dijit/Editor` buttons\n\n\t\ttemplateString:\n\t\t\t'<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">' +\n\t\t\t'</div>',\n\n\t\tbaseClass: \"dijitToolbar\",\n\n\t\t_onLeftArrow: function(){\n\t\t\tthis.focusPrev();\n\t\t},\n\n\t\t_onRightArrow: function(){\n\t\t\tthis.focusNext();\n\t\t}\n\t});\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/Toolbar.js\n// module id = 150\n// module chunks = 3","define([\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/dom\", // dom.setSelectable\n\t\"./_Widget\",\n\t\"./_TemplatedMixin\"\n], function(declare, dom, _Widget, _TemplatedMixin){\n\n\t// module:\n\t//\t\tdijit/ToolbarSeparator\n\n\n\treturn declare(\"dijit.ToolbarSeparator\", [_Widget, _TemplatedMixin], {\n\t\t// summary:\n\t\t//\t\tA spacer between two `dijit.Toolbar` items\n\n\t\ttemplateString: '<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>',\n\n\t\tbuildRendering: function(){\n\t\t\tthis.inherited(arguments);\n\t\t\tdom.setSelectable(this.domNode, false);\n\t\t},\n\n\t\tisFocusable: function(){\n\t\t\t// summary:\n\t\t\t//\t\tThis widget isn't focusable, so pass along that fact.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\treturn false;\n\t\t}\n\t});\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/ToolbarSeparator.js\n// module id = 151\n// module chunks = 3","define([\n\t\"dojo/_base/connect\", // connect.connect\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/_base/lang\", // lang.mixin, lang.hitch\n\t\"../Destroyable\",\n\t\"../form/Button\"\n], function(connect, declare, lang, Destroyable, Button){\n\n\t// module:\n\t//\t\tdijit/_editor/_Plugin\n\n\tvar _Plugin = declare(\"dijit._editor._Plugin\", Destroyable, {\n\t\t// summary:\n\t\t//\t\tBase class for a \"plugin\" to the editor, which is usually\n\t\t//\t\ta single button on the Toolbar and some associated code\n\n\t\tconstructor: function(args){\n\t\t\t// summary:\n\t\t\t//\t\tCreate the plugin.\n\t\t\t// args: Object?\n\t\t\t//\t\tInitial settings for any of the attributes.\n\n\t\t\tthis.params = args || {};\n\t\t\tlang.mixin(this, this.params);\n\t\t\tthis._attrPairNames = {};\n\t\t},\n\n\t\t// editor: [const] dijit.Editor\n\t\t//\t\tPoints to the parent editor\n\t\teditor: null,\n\n\t\t// iconClassPrefix: [const] String\n\t\t//\t\tThe CSS class name for the button node is formed from `iconClassPrefix` and `command`\n\t\ticonClassPrefix: \"dijitEditorIcon\",\n\n\t\t// button: dijit/_WidgetBase?\n\t\t//\t\tPointer to `dijit/form/Button` or other widget (ex: `dijit/form/FilteringSelect`)\n\t\t//\t\tthat is added to the toolbar to control this plugin.\n\t\t//\t\tIf not specified, will be created on initialization according to `buttonClass`\n\t\tbutton: null,\n\n\t\t// command: String\n\t\t//\t\tString like \"insertUnorderedList\", \"outdent\", \"justifyCenter\", etc. that represents an editor command.\n\t\t//\t\tPassed to editor.execCommand() if `useDefaultCommand` is true.\n\t\tcommand: \"\",\n\n\t\t// useDefaultCommand: Boolean\n\t\t//\t\tIf true, this plugin executes by calling Editor.execCommand() with the argument specified in `command`.\n\t\tuseDefaultCommand: true,\n\n\t\t// buttonClass: Widget Class\n\t\t//\t\tClass of widget (ex: dijit.form.Button or dijit/form/FilteringSelect)\n\t\t//\t\tthat is added to the toolbar to control this plugin.\n\t\t//\t\tThis is used to instantiate the button, unless `button` itself is specified directly.\n\t\tbuttonClass: Button,\n\n\t\t// disabled: Boolean\n\t\t//\t\tFlag to indicate if this plugin has been disabled and should do nothing\n\t\t//\t\thelps control button state, among other things.  Set via the setter api.\n\t\tdisabled: false,\n\n\t\tgetLabel: function(/*String*/key){\n\t\t\t// summary:\n\t\t\t//\t\tReturns the label to use for the button\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\treturn this.editor.commands[key];\t\t// String\n\t\t},\n\n\t\t_initButton: function(){\n\t\t\t// summary:\n\t\t\t//\t\tInitialize the button or other widget that will control this plugin.\n\t\t\t//\t\tThis code only works for plugins controlling built-in commands in the editor.\n\t\t\t// tags:\n\t\t\t//\t\tprotected extension\n\t\t\tif(this.command.length){\n\t\t\t\tvar label = this.getLabel(this.command),\n\t\t\t\t\teditor = this.editor,\n\t\t\t\t\tclassName = this.iconClassPrefix + \" \" + this.iconClassPrefix + this.command.charAt(0).toUpperCase() + this.command.substr(1);\n\t\t\t\tif(!this.button){\n\t\t\t\t\tvar props = lang.mixin({\n\t\t\t\t\t\tlabel: label,\n\t\t\t\t\t\townerDocument: editor.ownerDocument,\n\t\t\t\t\t\tdir: editor.dir,\n\t\t\t\t\t\tlang: editor.lang,\n\t\t\t\t\t\tshowLabel: false,\n\t\t\t\t\t\ticonClass: className,\n\t\t\t\t\t\tdropDown: this.dropDown,\n\t\t\t\t\t\ttabIndex: \"-1\"\n\t\t\t\t\t}, this.params || {});\n\n\t\t\t\t\t// Avoid creating Button with a name like \"dijit/editor/_plugins/ToggleDir\", since that name becomes\n\t\t\t\t\t// a global object, and then if the ToggleDir plugin is referenced again, _Plugin.js will\n\t\t\t\t\t// find the <input> rather than the ToggleDir module.\n\t\t\t\t\t// Not necessary in 2.0 once the getObject() call is removed from _Plugin.js.\n\t\t\t\t\tdelete props.name;\n\n\t\t\t\t\tthis.button = new this.buttonClass(props);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(this.get(\"disabled\") && this.button){\n\t\t\t\tthis.button.set(\"disabled\", this.get(\"disabled\"));\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function(){\n\t\t\tif(this.dropDown){\n\t\t\t\tthis.dropDown.destroyRecursive();\n\t\t\t}\n\n\t\t\tthis.inherited(arguments);\n\t\t},\n\n\t\tconnect: function(o, f, tf){\n\t\t\t// summary:\n\t\t\t//\t\tDeprecated.  Use this.own() with dojo/on or dojo/aspect.instead.\n\t\t\t//\n\t\t\t//\t\tMake a connect.connect() that is automatically disconnected when this plugin is destroyed.\n\t\t\t//\t\tSimilar to `dijit/_Widget.connect()`.\n\t\t\t// tags:\n\t\t\t//\t\tprotected deprecated\n\n\t\t\tthis.own(connect.connect(o, f, this, tf));\n\t\t},\n\n\t\tupdateState: function(){\n\t\t\t// summary:\n\t\t\t//\t\tChange state of the plugin to respond to events in the editor.\n\t\t\t// description:\n\t\t\t//\t\tThis is called on meaningful events in the editor, such as change of selection\n\t\t\t//\t\tor caret position (but not simple typing of alphanumeric keys).   It gives the\n\t\t\t//\t\tplugin a chance to update the CSS of its button.\n\t\t\t//\n\t\t\t//\t\tFor example, the \"bold\" plugin will highlight/unhighlight the bold button depending on whether the\n\t\t\t//\t\tcharacters next to the caret are bold or not.\n\t\t\t//\n\t\t\t//\t\tOnly makes sense when `useDefaultCommand` is true, as it calls Editor.queryCommandEnabled(`command`).\n\t\t\tvar e = this.editor,\n\t\t\t\tc = this.command,\n\t\t\t\tchecked, enabled;\n\t\t\tif(!e || !e.isLoaded || !c.length){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar disabled = this.get(\"disabled\");\n\t\t\tif(this.button){\n\t\t\t\ttry{\n\t\t\t\t\tenabled = !disabled && e.queryCommandEnabled(c);\n\t\t\t\t\tif(this.enabled !== enabled){\n\t\t\t\t\t\tthis.enabled = enabled;\n\t\t\t\t\t\tthis.button.set('disabled', !enabled);\n\t\t\t\t\t}\n\t\t\t\t\tif(enabled){\n\t\t\t\t\t\tif(typeof this.button.checked == 'boolean'){\n\t\t\t\t\t\t\tchecked = e.queryCommandState(c);\n\t\t\t\t\t\t\tif(this.checked !== checked){\n\t\t\t\t\t\t\t\tthis.checked = checked;\n\t\t\t\t\t\t\t\tthis.button.set('checked', e.queryCommandState(c));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\tconsole.log(e); // FIXME: we shouldn't have debug statements in our code.  Log as an error?\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsetEditor: function(/*dijit/Editor*/ editor){\n\t\t\t// summary:\n\t\t\t//\t\tTell the plugin which Editor it is associated with.\n\n\t\t\t// TODO: refactor code to just pass editor to constructor.\n\n\t\t\t// FIXME: detach from previous editor!!\n\t\t\tthis.editor = editor;\n\n\t\t\t// FIXME: prevent creating this if we don't need to (i.e., editor can't handle our command)\n\t\t\tthis._initButton();\n\n\t\t\t// Processing for buttons that execute by calling editor.execCommand()\n\t\t\tif(this.button && this.useDefaultCommand){\n\t\t\t\tif(this.editor.queryCommandAvailable(this.command)){\n\t\t\t\t\tthis.own(this.button.on(\"click\",\n\t\t\t\t\t\tlang.hitch(this.editor, \"execCommand\", this.command, this.commandArg)\n\t\t\t\t\t));\n\t\t\t\t}else{\n\t\t\t\t\t// hide button because editor doesn't support command (due to browser limitations)\n\t\t\t\t\tthis.button.domNode.style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.own(this.editor.on(\"NormalizedDisplayChanged\", lang.hitch(this, \"updateState\")));\n\t\t},\n\n\t\tsetToolbar: function(/*dijit/Toolbar*/ toolbar){\n\t\t\t// summary:\n\t\t\t//\t\tTell the plugin to add it's controller widget (often a button)\n\t\t\t//\t\tto the toolbar.  Does nothing if there is no controller widget.\n\n\t\t\t// TODO: refactor code to just pass toolbar to constructor.\n\n\t\t\tif(this.button){\n\t\t\t\ttoolbar.addChild(this.button);\n\t\t\t}\n\t\t\t// console.debug(\"adding\", this.button, \"to:\", toolbar);\n\t\t},\n\n\t\tset: function(/* attribute */ name, /* anything */ value){\n\t\t\t// summary:\n\t\t\t//\t\tSet a property on a plugin\n\t\t\t// name:\n\t\t\t//\t\tThe property to set.\n\t\t\t// value:\n\t\t\t//\t\tThe value to set in the property.\n\t\t\t// description:\n\t\t\t//\t\tSets named properties on a plugin which may potentially be handled by a\n\t\t\t//\t\tsetter in the plugin.\n\t\t\t//\t\tFor example, if the plugin has a properties \"foo\"\n\t\t\t//\t\tand \"bar\" and a method named \"_setFooAttr\", calling:\n\t\t\t//\t|\tplugin.set(\"foo\", \"Howdy!\");\n\t\t\t//\t\twould be equivalent to writing:\n\t\t\t//\t|\tplugin._setFooAttr(\"Howdy!\");\n\t\t\t//\t\tand:\n\t\t\t//\t|\tplugin.set(\"bar\", 3);\n\t\t\t//\t\twould be equivalent to writing:\n\t\t\t//\t|\tplugin.bar = 3;\n\t\t\t//\n\t\t\t//\t\tset() may also be called with a hash of name/value pairs, ex:\n\t\t\t//\t|\tplugin.set({\n\t\t\t//\t|\t\tfoo: \"Howdy\",\n\t\t\t//\t|\t\tbar: 3\n\t\t\t//\t|\t})\n\t\t\t//\t\tThis is equivalent to calling set(foo, \"Howdy\") and set(bar, 3)\n\t\t\tif(typeof name === \"object\"){\n\t\t\t\tfor(var x in name){\n\t\t\t\t\tthis.set(x, name[x]);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tvar names = this._getAttrNames(name);\n\t\t\tif(this[names.s]){\n\t\t\t\t// use the explicit setter\n\t\t\t\tvar result = this[names.s].apply(this, Array.prototype.slice.call(arguments, 1));\n\t\t\t}else{\n\t\t\t\tthis._set(name, value);\n\t\t\t}\n\t\t\treturn result || this;\n\t\t},\n\n\t\tget: function(name){\n\t\t\t// summary:\n\t\t\t//\t\tGet a property from a plugin.\n\t\t\t// name:\n\t\t\t//\t\tThe property to get.\n\t\t\t// description:\n\t\t\t//\t\tGet a named property from a plugin. The property may\n\t\t\t//\t\tpotentially be retrieved via a getter method. If no getter is defined, this\n\t\t\t//\t\tjust retrieves the object's property.\n\t\t\t//\t\tFor example, if the plugin has a properties \"foo\"\n\t\t\t//\t\tand \"bar\" and a method named \"_getFooAttr\", calling:\n\t\t\t//\t|\tplugin.get(\"foo\");\n\t\t\t//\t\twould be equivalent to writing:\n\t\t\t//\t|\tplugin._getFooAttr();\n\t\t\t//\t\tand:\n\t\t\t//\t|\tplugin.get(\"bar\");\n\t\t\t//\t\twould be equivalent to writing:\n\t\t\t//\t|\tplugin.bar;\n\t\t\tvar names = this._getAttrNames(name);\n\t\t\treturn this[names.g] ? this[names.g]() : this[name];\n\t\t},\n\n\t\t_setDisabledAttr: function(disabled){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to set the plugin state and call updateState to make sure the\n\t\t\t//\t\tbutton is updated appropriately.\n\t\t\tthis._set(\"disabled\", disabled);\n\t\t\tthis.updateState();\n\t\t},\n\n\t\t_getAttrNames: function(name){\n\t\t\t// summary:\n\t\t\t//\t\tHelper function for get() and set().\n\t\t\t//\t\tCaches attribute name values so we don't do the string ops every time.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar apn = this._attrPairNames;\n\t\t\tif(apn[name]){\n\t\t\t\treturn apn[name];\n\t\t\t}\n\t\t\tvar uc = name.charAt(0).toUpperCase() + name.substr(1);\n\t\t\treturn (apn[name] = {\n\t\t\t\ts: \"_set\" + uc + \"Attr\",\n\t\t\t\tg: \"_get\" + uc + \"Attr\"\n\t\t\t});\n\t\t},\n\n\t\t_set: function(/*String*/ name, /*anything*/ value){\n\t\t\t// summary:\n\t\t\t//\t\tHelper function to set new value for specified attribute\n\t\t\tthis[name] = value;\n\t\t}\n\t});\n\n\t// Hash mapping plugin name to factory, used for registering plugins\n\t_Plugin.registry = {};\n\n\treturn _Plugin;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/_Plugin.js\n// module id = 152\n// module chunks = 3","define([\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/dom-construct\", // domConstruct.destroy domConstruct.place\n\t\"dojo/keys\", // keys.ENTER\n\t\"dojo/_base/lang\",\n\t\"dojo/on\",\n\t\"dojo/sniff\", // has(\"ie\") has(\"mozilla\") has(\"webkit\")\n\t\"dojo/_base/window\", // win.withGlobal\n\t\"dojo/window\", // winUtils.scrollIntoView\n\t\"../_Plugin\",\n\t\"../RichText\",\n\t\"../range\"\n], function(declare, domConstruct, keys, lang, on, has, win, winUtils, _Plugin, RichText, rangeapi){\n\n\t// module:\n\t//\t\tdijit/_editor/plugins/EnterKeyHandling\n\n\treturn declare(\"dijit._editor.plugins.EnterKeyHandling\", _Plugin, {\n\t\t// summary:\n\t\t//\t\tThis plugin tries to make all browsers behave consistently with regard to\n\t\t//\t\thow ENTER behaves in the editor window.  It traps the ENTER key and alters\n\t\t//\t\tthe way DOM is constructed in certain cases to try to commonize the generated\n\t\t//\t\tDOM and behaviors across browsers.\n\t\t//\n\t\t// description:\n\t\t//\t\tThis plugin has three modes:\n\t\t//\n\t\t//\t\t- blockNodeForEnter=BR\n\t\t//\t\t- blockNodeForEnter=DIV\n\t\t//\t\t- blockNodeForEnter=P\n\t\t//\n\t\t//\t\tIn blockNodeForEnter=P, the ENTER key starts a new\n\t\t//\t\tparagraph, and shift-ENTER starts a new line in the current paragraph.\n\t\t//\t\tFor example, the input:\n\t\t//\n\t\t//\t|\tfirst paragraph <shift-ENTER>\n\t\t//\t|\tsecond line of first paragraph <ENTER>\n\t\t//\t|\tsecond paragraph\n\t\t//\n\t\t//\t\twill generate:\n\t\t//\n\t\t//\t|\t<p>\n\t\t//\t|\t\tfirst paragraph\n\t\t//\t|\t\t<br/>\n\t\t//\t|\t\tsecond line of first paragraph\n\t\t//\t|\t</p>\n\t\t//\t|\t<p>\n\t\t//\t|\t\tsecond paragraph\n\t\t//\t|\t</p>\n\t\t//\n\t\t//\t\tIn BR and DIV mode, the ENTER key conceptually goes to a new line in the\n\t\t//\t\tcurrent paragraph, and users conceptually create a new paragraph by pressing ENTER twice.\n\t\t//\t\tFor example, if the user enters text into an editor like this:\n\t\t//\n\t\t//\t|\t\tone <ENTER>\n\t\t//\t|\t\ttwo <ENTER>\n\t\t//\t|\t\tthree <ENTER>\n\t\t//\t|\t\t<ENTER>\n\t\t//\t|\t\tfour <ENTER>\n\t\t//\t|\t\tfive <ENTER>\n\t\t//\t|\t\tsix <ENTER>\n\t\t//\n\t\t//\t\tIt will appear on the screen as two 'paragraphs' of three lines each.  Markupwise, this generates:\n\t\t//\n\t\t//\t\tBR:\n\t\t//\t|\t\tone<br/>\n\t\t//\t|\t\ttwo<br/>\n\t\t//\t|\t\tthree<br/>\n\t\t//\t|\t\t<br/>\n\t\t//\t|\t\tfour<br/>\n\t\t//\t|\t\tfive<br/>\n\t\t//\t|\t\tsix<br/>\n\t\t//\n\t\t//\t\tDIV:\n\t\t//\t|\t\t<div>one</div>\n\t\t//\t|\t\t<div>two</div>\n\t\t//\t|\t\t<div>three</div>\n\t\t//\t|\t\t<div>&nbsp;</div>\n\t\t//\t|\t\t<div>four</div>\n\t\t//\t|\t\t<div>five</div>\n\t\t//\t|\t\t<div>six</div>\n\n\t\t// blockNodeForEnter: String\n\t\t//\t\tThis property decides the behavior of Enter key. It can be either P,\n\t\t//\t\tDIV, BR, or empty (which means disable this feature). Anything else\n\t\t//\t\twill trigger errors.  The default is 'BR'\n\t\t//\n\t\t//\t\tSee class description for more details.\n\t\tblockNodeForEnter: 'BR',\n\n\t\tconstructor: function(args){\n\t\t\tif(args){\n\t\t\t\tif(\"blockNodeForEnter\" in args){\n\t\t\t\t\targs.blockNodeForEnter = args.blockNodeForEnter.toUpperCase();\n\t\t\t\t}\n\t\t\t\tlang.mixin(this, args);\n\t\t\t}\n\t\t},\n\n\t\tsetEditor: function(editor){\n\t\t\t// Overrides _Plugin.setEditor().\n\t\t\tif(this.editor === editor){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.editor = editor;\n\t\t\tif(this.blockNodeForEnter == 'BR'){\n\t\t\t\t// While Moz has a mode tht mostly works, it's still a little different,\n\t\t\t\t// So, try to just have a common mode and be consistent.  Which means\n\t\t\t\t// we need to enable customUndo, if not already enabled.\n\t\t\t\tthis.editor.customUndo = true;\n\t\t\t\teditor.onLoadDeferred.then(lang.hitch(this, function(d){\n\t\t\t\t\tthis.own(on(editor.document, \"keydown\", lang.hitch(this, function(e){\n\t\t\t\t\t\tif(e.keyCode == keys.ENTER){\n\t\t\t\t\t\t\t// Just do it manually.  The handleEnterKey has a shift mode that\n\t\t\t\t\t\t\t// Always acts like <br>, so just use it.\n\t\t\t\t\t\t\tvar ne = lang.mixin({}, e);\n\t\t\t\t\t\t\tne.shiftKey = true;\n\t\t\t\t\t\t\tif(!this.handleEnterKey(ne)){\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t\tif(has(\"ie\") >= 9 && has(\"ie\") <= 10){\n\t\t\t\t\t\tthis.own(on(editor.document, \"paste\", lang.hitch(this, function(e){\n\t\t\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\n\t\t\t\t\t\t\t\t// Use the old range/selection code to kick IE 9 into updating\n\t\t\t\t\t\t\t\t// its range by moving it back, then forward, one 'character'.\n\t\t\t\t\t\t\t\tvar r = this.editor.document.selection.createRange();\n\t\t\t\t\t\t\t\tr.move('character', -1);\n\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t\tr.move('character', 1);\n\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t}), 0);\n\t\t\t\t\t\t})));\n\t\t\t\t\t}\n\t\t\t\t\treturn d;\n\t\t\t\t}));\n\t\t\t}else if(this.blockNodeForEnter){\n\t\t\t\t// add enter key handler\n\t\t\t\tvar h = lang.hitch(this, \"handleEnterKey\");\n\t\t\t\teditor.addKeyHandler(13, 0, 0, h); //enter\n\t\t\t\teditor.addKeyHandler(13, 0, 1, h); //shift+enter\n\t\t\t\tthis.own(this.editor.on('KeyPressed', lang.hitch(this, 'onKeyPressed')));\n\t\t\t}\n\t\t},\n\t\tonKeyPressed: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for after the user has pressed a key, and the display has been updated.\n\t\t\t//\t\tConnected to RichText's onKeyPressed() method.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this._checkListLater){\n\t\t\t\tif(this.editor.selection.isCollapsed()){\n\t\t\t\t\tvar liparent = this.editor.selection.getAncestorElement('LI');\n\t\t\t\t\tif(!liparent){\n\t\t\t\t\t\t// circulate the undo detection code by calling RichText::execCommand directly\n\t\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'formatblock', this.blockNodeForEnter);\n\t\t\t\t\t\t// set the innerHTML of the new block node\n\t\t\t\t\t\tvar block = this.editor.selection.getAncestorElement(this.blockNodeForEnter);\n\t\t\t\t\t\tif(block){\n\t\t\t\t\t\t\tblock.innerHTML = this.bogusHtmlContent;\n\t\t\t\t\t\t\tif(has(\"ie\") <= 9){\n\t\t\t\t\t\t\t\t// move to the start by moving backwards one char\n\t\t\t\t\t\t\t\tvar r = this.editor.document.selection.createRange();\n\t\t\t\t\t\t\t\tr.move('character', -1);\n\t\t\t\t\t\t\t\tr.select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tconsole.error('onKeyPressed: Cannot find the new block node'); // FIXME\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t\tif(liparent.parentNode.parentNode.nodeName == 'LI'){\n\t\t\t\t\t\t\t\tliparent = liparent.parentNode.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar fc = liparent.firstChild;\n\t\t\t\t\t\tif(fc && fc.nodeType == 1 && (fc.nodeName == 'UL' || fc.nodeName == 'OL')){\n\t\t\t\t\t\t\tliparent.insertBefore(fc.ownerDocument.createTextNode('\\xA0'), fc);\n\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\tnewrange.setStart(liparent.firstChild, 0);\n\t\t\t\t\t\t\tvar selection = rangeapi.getSelection(this.editor.window, true);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._checkListLater = false;\n\t\t\t}\n\t\t\tif(this._pressedEnterInBlock){\n\t\t\t\t// the new created is the original current P, so we have previousSibling below\n\t\t\t\tif(this._pressedEnterInBlock.previousSibling){\n\t\t\t\t\tthis.removeTrailingBr(this._pressedEnterInBlock.previousSibling);\n\t\t\t\t}\n\t\t\t\tdelete this._pressedEnterInBlock;\n\t\t\t}\n\t\t},\n\n\t\t// bogusHtmlContent: [private] String\n\t\t//\t\tHTML to stick into a new empty block\n\t\tbogusHtmlContent: '&#160;', // &nbsp;\n\n\t\t// blockNodes: [private] Regex\n\t\t//\t\tRegex for testing if a given tag is a block level (display:block) tag\n\t\tblockNodes: /^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,\n\n\t\thandleEnterKey: function(e){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for enter key events when blockNodeForEnter is DIV or P.\n\t\t\t// description:\n\t\t\t//\t\tManually handle enter key event to make the behavior consistent across\n\t\t\t//\t\tall supported browsers. See class description for details.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar selection, range, newrange, startNode, endNode, brNode, doc = this.editor.document, br, rs, txt;\n\t\t\tif(e.shiftKey){        // shift+enter always generates <br>\n\t\t\t\tvar parent = this.editor.selection.getParentElement();\n\t\t\t\tvar header = rangeapi.getAncestor(parent, this.blockNodes);\n\t\t\t\tif(header){\n\t\t\t\t\tif(header.tagName == 'LI'){\n\t\t\t\t\t\treturn true; // let browser handle\n\t\t\t\t\t}\n\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\tif(!range.collapsed){\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t}\n\t\t\t\t\tif(rangeapi.atBeginningOfContainer(header, range.startContainer, range.startOffset)){\n\t\t\t\t\t\tbr = doc.createElement('br');\n\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\theader.insertBefore(br, header.firstChild);\n\t\t\t\t\t\tnewrange.setStartAfter(br);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t}else if(rangeapi.atEndOfContainer(header, range.startContainer, range.startOffset)){\n\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\tbr = doc.createElement('br');\n\t\t\t\t\t\theader.appendChild(br);\n\t\t\t\t\t\theader.appendChild(doc.createTextNode('\\xA0'));\n\t\t\t\t\t\tnewrange.setStart(header.lastChild, 0);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, range.startOffset));\n\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(range.startOffset));\n\t\t\t\t\t\t\tbrNode = doc.createElement(\"br\");\n\n\t\t\t\t\t\t\tif(endNode.nodeValue == \"\" && has(\"webkit\")){\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode('\\xA0')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\tdomConstruct.place(brNode, startNode, \"after\");\n\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true; // let browser handle\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\tif(range && range.startContainer){\n\t\t\t\t\t\t\tif(!range.collapsed){\n\t\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t\t\t\t// Text node, we have to split it.\n\n\t\t\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\n\t\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t\t\tbrNode = doc.createElement(\"br\");\n\n\t\t\t\t\t\t\t\tif(!endNode.length){\n\t\t\t\t\t\t\t\t\t// Create dummy text with a &nbsp to go after the BR, to prevent IE crash.\n\t\t\t\t\t\t\t\t\t// See https://bugs.dojotoolkit.org/ticket/12008 for details.\n\t\t\t\t\t\t\t\t\tendNode = doc.createTextNode('\\xA0');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomConstruct.place(brNode, startNode, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(endNode, endNode.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.editor.selection.collapse(true);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tvar targetNode;\n\t\t\t\t\t\t\t\tif(range.startOffset >= 0){\n\t\t\t\t\t\t\t\t\ttargetNode = rs.childNodes[range.startOffset];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar brNode = doc.createElement(\"br\");\n\t\t\t\t\t\t\t\tvar endNode = doc.createTextNode('\\xA0');\n\t\t\t\t\t\t\t\tif(!targetNode){\n\t\t\t\t\t\t\t\t\trs.appendChild(brNode);\n\t\t\t\t\t\t\t\t\trs.appendChild(endNode);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tdomConstruct.place(brNode, targetNode, \"before\");\n\t\t\t\t\t\t\t\t\tdomConstruct.place(endNode, brNode, \"after\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(endNode, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(endNode, endNode.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.editor.selection.collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// \\xA0 dummy text node remains, but is stripped before get(\"value\")\n\t\t\t\t\t\t\t// by RichText._stripTrailingEmptyNodes().  Still, could we just use a plain\n\t\t\t\t\t\t\t// space (\" \") instead?\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// don't change this: do not call this.execCommand, as that may have other logic in subclass\n\t\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'inserthtml', '<br>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar _letBrowserHandle = true;\n\n\t\t\t// first remove selection\n\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\trange = selection.getRangeAt(0);\n\t\t\tif(!range.collapsed){\n\t\t\t\trange.deleteContents();\n\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t}\n\n\t\t\tvar block = rangeapi.getBlockAncestor(range.endContainer, null, this.editor.editNode);\n\t\t\tvar blockNode = block.blockNode;\n\n\t\t\t// if this is under a LI or the parent of the blockNode is LI, just let browser to handle it\n\t\t\tif((this._checkListLater = (blockNode && (blockNode.nodeName == 'LI' || blockNode.parentNode.nodeName == 'LI')))){\n\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\tthis._pressedEnterInBlock = blockNode;\n\t\t\t\t}\n\t\t\t\t// if this li only contains spaces, set the content to empty so the browser will outdent this item\n\t\t\t\tif(/^(\\s|&nbsp;|&#160;|\\xA0|<span\\b[^>]*\\bclass=['\"]Apple-style-span['\"][^>]*>(\\s|&nbsp;|&#160;|\\xA0)<\\/span>)?(<br>)?$/.test(blockNode.innerHTML)){\n\t\t\t\t\t// empty LI node\n\t\t\t\t\tblockNode.innerHTML = '';\n\t\t\t\t\tif(has(\"webkit\")){ // WebKit tosses the range when innerHTML is reset\n\t\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\t\tnewrange.setStart(blockNode, 0);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t}\n\t\t\t\t\tthis._checkListLater = false; // nothing to check since the browser handles outdent\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// text node directly under body, let's wrap them in a node\n\t\t\tif(!block.blockNode || block.blockNode === this.editor.editNode){\n\t\t\t\ttry{\n\t\t\t\t\tRichText.prototype.execCommand.call(this.editor, 'formatblock', this.blockNodeForEnter);\n\t\t\t\t}catch(e2){ /*squelch FF3 exception bug when editor content is a single BR*/\n\t\t\t\t}\n\t\t\t\t// get the newly created block node\n\t\t\t\t// FIXME\n\t\t\t\tblock = {blockNode: this.editor.selection.getAncestorElement(this.blockNodeForEnter),\n\t\t\t\t\tblockContainer: this.editor.editNode};\n\t\t\t\tif(block.blockNode){\n\t\t\t\t\tif(block.blockNode != this.editor.editNode &&\n\t\t\t\t\t\t(!(block.blockNode.textContent || block.blockNode.innerHTML).replace(/^\\s+|\\s+$/g, \"\").length)){\n\t\t\t\t\t\tthis.removeTrailingBr(block.blockNode);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}else{    // we shouldn't be here if formatblock worked\n\t\t\t\t\tblock.blockNode = this.editor.editNode;\n\t\t\t\t}\n\t\t\t\tselection = rangeapi.getSelection(this.editor.window);\n\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t}\n\n\t\t\tvar newblock = doc.createElement(this.blockNodeForEnter);\n\t\t\tnewblock.innerHTML = this.bogusHtmlContent;\n\t\t\tthis.removeTrailingBr(block.blockNode);\n\t\t\tvar endOffset = range.endOffset;\n\t\t\tvar node = range.endContainer;\n\t\t\tif(node.length < endOffset){\n\t\t\t\t//We are not checking the right node, try to locate the correct one\n\t\t\t\tvar ret = this._adjustNodeAndOffset(node, endOffset);\n\t\t\t\tnode = ret.node;\n\t\t\t\tendOffset = ret.offset;\n\t\t\t}\n\t\t\tif(rangeapi.atEndOfContainer(block.blockNode, node, endOffset)){\n\t\t\t\tif(block.blockNode === block.blockContainer){\n\t\t\t\t\tblock.blockNode.appendChild(newblock);\n\t\t\t\t}else{\n\t\t\t\t\tdomConstruct.place(newblock, block.blockNode, \"after\");\n\t\t\t\t}\n\t\t\t\t_letBrowserHandle = false;\n\t\t\t\t// lets move caret to the newly created block\n\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\tselection.removeAllRanges();\n\t\t\t\tselection.addRange(newrange);\n\t\t\t\tif(this.editor.height){\n\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t}\n\t\t\t}else if(rangeapi.atBeginningOfContainer(block.blockNode,\n\t\t\t\trange.startContainer, range.startOffset)){\n\t\t\t\tdomConstruct.place(newblock, block.blockNode, block.blockNode === block.blockContainer ? \"first\" : \"before\");\n\t\t\t\tif(newblock.nextSibling && this.editor.height){\n\t\t\t\t\t// position input caret - mostly WebKit needs this\n\t\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\t\tnewrange.setStart(newblock.nextSibling, 0);\n\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t// browser does not scroll the caret position into view, do it manually\n\t\t\t\t\twinUtils.scrollIntoView(newblock.nextSibling);\n\t\t\t\t}\n\t\t\t\t_letBrowserHandle = false;\n\t\t\t}else{ //press enter in the middle of P/DIV/Whatever/\n\t\t\t\tif(block.blockNode === block.blockContainer){\n\t\t\t\t\tblock.blockNode.appendChild(newblock);\n\t\t\t\t}else{\n\t\t\t\t\tdomConstruct.place(newblock, block.blockNode, \"after\");\n\t\t\t\t}\n\t\t\t\t_letBrowserHandle = false;\n\n\t\t\t\t// Clone any block level styles.\n\t\t\t\tif(block.blockNode.style){\n\t\t\t\t\tif(newblock.style){\n\t\t\t\t\t\tif(block.blockNode.style.cssText){\n\t\t\t\t\t\t\tnewblock.style.cssText = block.blockNode.style.cssText;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Okay, we probably have to split.\n\t\t\t\trs = range.startContainer;\n\t\t\t\tvar firstNodeMoved;\n\t\t\t\tif(rs && rs.nodeType == 3){\n\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\tvar nodeToMove, tNode;\n\t\t\t\t\tendOffset = range.endOffset;\n\t\t\t\t\tif(rs.length < endOffset){\n\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, endOffset);\n\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\tendOffset = ret.offset;\n\t\t\t\t\t}\n\n\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, endOffset));\n\t\t\t\t\tendNode = doc.createTextNode(txt.substring(endOffset, txt.length));\n\n\t\t\t\t\t// Place the split, then remove original nodes.\n\t\t\t\t\tdomConstruct.place(startNode, rs, \"before\");\n\t\t\t\t\tdomConstruct.place(endNode, rs, \"after\");\n\t\t\t\t\tdomConstruct.destroy(rs);\n\n\t\t\t\t\t// Okay, we split the text.  Now we need to see if we're\n\t\t\t\t\t// parented to the block element we're splitting and if\n\t\t\t\t\t// not, we have to split all the way up.  Ugh.\n\t\t\t\t\tvar parentC = startNode.parentNode;\n\t\t\t\t\twhile(parentC !== block.blockNode){\n\t\t\t\t\t\tvar tg = parentC.tagName;\n\t\t\t\t\t\tvar newTg = doc.createElement(tg);\n\t\t\t\t\t\t// Clone over any 'style' data.\n\t\t\t\t\t\tif(parentC.style){\n\t\t\t\t\t\t\tif(newTg.style){\n\t\t\t\t\t\t\t\tif(parentC.style.cssText){\n\t\t\t\t\t\t\t\t\tnewTg.style.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// If font also need to clone over any font data.\n\t\t\t\t\t\tif(parentC.tagName === \"FONT\"){\n\t\t\t\t\t\t\tif(parentC.color){\n\t\t\t\t\t\t\t\tnewTg.color = parentC.color;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(parentC.face){\n\t\t\t\t\t\t\t\tnewTg.face = parentC.face;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(parentC.size){  // this check was necessary on IE\n\t\t\t\t\t\t\t\tnewTg.size = parentC.size;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\tnewTg.appendChild(nodeToMove);\n\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomConstruct.place(newTg, parentC, \"after\");\n\t\t\t\t\t\tstartNode = parentC;\n\t\t\t\t\t\tendNode = newTg;\n\t\t\t\t\t\tparentC = parentC.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lastly, move the split out tags to the new block.\n\t\t\t\t\t// as they should now be split properly.\n\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\tif(nodeToMove.nodeType == 1 || (nodeToMove.nodeType == 3 && nodeToMove.nodeValue)){\n\t\t\t\t\t\t// Non-blank text and non-text nodes need to clear out that blank space\n\t\t\t\t\t\t// before moving the contents.\n\t\t\t\t\t\tnewblock.innerHTML = \"\";\n\t\t\t\t\t}\n\t\t\t\t\tfirstNodeMoved = nodeToMove;\n\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\tnewblock.appendChild(nodeToMove);\n\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//lets move caret to the newly created block\n\t\t\t\tnewrange = rangeapi.create(this.editor.window);\n\t\t\t\tvar nodeForCursor;\n\t\t\t\tvar innerMostFirstNodeMoved = firstNodeMoved;\n\t\t\t\tif(this.blockNodeForEnter !== 'BR'){\n\t\t\t\t\twhile(innerMostFirstNodeMoved){\n\t\t\t\t\t\tnodeForCursor = innerMostFirstNodeMoved;\n\t\t\t\t\t\ttNode = innerMostFirstNodeMoved.firstChild;\n\t\t\t\t\t\tinnerMostFirstNodeMoved = tNode;\n\t\t\t\t\t}\n\t\t\t\t\tif(nodeForCursor && nodeForCursor.parentNode){\n\t\t\t\t\t\tnewblock = nodeForCursor.parentNode;\n\t\t\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\tif(this.editor.height){\n\t\t\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\t\t\tthis._pressedEnterInBlock = block.blockNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t_letBrowserHandle = true;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tnewrange.setStart(newblock, 0);\n\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\tif(this.editor.height){\n\t\t\t\t\t\twinUtils.scrollIntoView(newblock);\n\t\t\t\t\t}\n\t\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t\t// press enter in middle of P may leave a trailing <br/>, let's remove it later\n\t\t\t\t\t\tthis._pressedEnterInBlock = block.blockNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn _letBrowserHandle;\n\t\t},\n\n\t\t_adjustNodeAndOffset: function(/*DomNode*/node, /*Int*/offset){\n\t\t\t// summary:\n\t\t\t//\t\tIn the case there are multiple text nodes in a row the offset may not be within the node.  If the offset is larger than the node length, it will attempt to find\n\t\t\t//\t\tthe next text sibling until it locates the text node in which the offset refers to\n\t\t\t// node:\n\t\t\t//\t\tThe node to check.\n\t\t\t// offset:\n\t\t\t//\t\tThe position to find within the text node\n\t\t\t// tags:\n\t\t\t//\t\tprivate.\n\t\t\twhile(node.length < offset && node.nextSibling && node.nextSibling.nodeType == 3){\n\t\t\t\t//Adjust the offset and node in the case of multiple text nodes in a row\n\t\t\t\toffset = offset - node.length;\n\t\t\t\tnode = node.nextSibling;\n\t\t\t}\n\t\t\treturn {\"node\": node, \"offset\": offset};\n\t\t},\n\n\t\tremoveTrailingBr: function(container){\n\t\t\t// summary:\n\t\t\t//\t\tIf last child of container is a `<br>`, then remove it.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar para = /P|DIV|LI/i.test(container.tagName) ?\n\t\t\t\tcontainer : this.editor.selection.getParentOfType(container, ['P', 'DIV', 'LI']);\n\n\t\t\tif(!para){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(para.lastChild){\n\t\t\t\tif((para.childNodes.length > 1 && para.lastChild.nodeType == 3 && /^[\\s\\xAD]*$/.test(para.lastChild.nodeValue)) ||\n\t\t\t\t\tpara.lastChild.tagName == 'BR'){\n\n\t\t\t\t\tdomConstruct.destroy(para.lastChild);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!para.childNodes.length){\n\t\t\t\tpara.innerHTML = this.bogusHtmlContent;\n\t\t\t}\n\t\t}\n\t});\n\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/plugins/EnterKeyHandling.js\n// module id = 153\n// module chunks = 3","define([\n\t\"dojo/_base/array\", // array.forEach array.indexOf array.some\n\t\"dojo/_base/config\", // config\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/_base/Deferred\", // Deferred\n\t\"dojo/dom\", // dom.byId\n\t\"dojo/dom-attr\", // domAttr.set or get\n\t\"dojo/dom-class\", // domClass.add domClass.remove\n\t\"dojo/dom-construct\", // domConstruct.create domConstruct.destroy domConstruct.place\n\t\"dojo/dom-geometry\", // domGeometry.position\n\t\"dojo/dom-style\", // domStyle.getComputedStyle domStyle.set\n\t\"dojo/_base/kernel\", // kernel.deprecated\n\t\"dojo/keys\", // keys.BACKSPACE keys.TAB\n\t\"dojo/_base/lang\", // lang.clone lang.hitch lang.isArray lang.isFunction lang.isString lang.trim\n\t\"dojo/on\", // on()\n\t\"dojo/query\", // query\n\t\"dojo/domReady\",\n\t\"dojo/sniff\", // has(\"ie\") has(\"mozilla\") has(\"opera\") has(\"safari\") has(\"webkit\")\n\t\"dojo/topic\", // topic.publish() (publish)\n\t\"dojo/_base/unload\", // unload\n\t\"dojo/_base/url\", // url\n\t\"dojo/window\", // winUtils.get()\n\t\"../_Widget\",\n\t\"../_CssStateMixin\",\n\t\"../selection\",\n\t\"./range\",\n\t\"./html\",\n\t\"../focus\",\n\t\"../main\"    // dijit._scopeName\n], function(array, config, declare, Deferred, dom, domAttr, domClass, domConstruct, domGeometry, domStyle,\n\t\t\tkernel, keys, lang, on, query, domReady, has, topic, unload, _Url, winUtils,\n\t\t\t_Widget, _CssStateMixin, selectionapi, rangeapi, htmlapi, focus, dijit){\n\n\t// module:\n\t//\t\tdijit/_editor/RichText\n\n\t// If you want to allow for rich text saving with back/forward actions, you must add a text area to your page with\n\t// the id==dijit._scopeName + \"._editor.RichText.value\" (typically \"dijit/_editor/RichText.value). For example,\n\t// something like this will work:\n\t//\n\t//\t<textarea id=\"dijit._editor.RichText.value\" style=\"display:none;position:absolute;top:-100px;left:-100px;height:3px;width:3px;overflow:hidden;\"></textarea>\n\n\tvar RichText = declare(\"dijit._editor.RichText\", [_Widget, _CssStateMixin], {\n\t\t// summary:\n\t\t//\t\tdijit/_editor/RichText is the core of dijit.Editor, which provides basic\n\t\t//\t\tWYSIWYG editing features.\n\t\t//\n\t\t// description:\n\t\t//\t\tdijit/_editor/RichText is the core of dijit.Editor, which provides basic\n\t\t//\t\tWYSIWYG editing features. It also encapsulates the differences\n\t\t//\t\tof different js engines for various browsers.  Do not use this widget\n\t\t//\t\twith an HTML &lt;TEXTAREA&gt; tag, since the browser unescapes XML escape characters,\n\t\t//\t\tlike &lt;.  This can have unexpected behavior and lead to security issues\n\t\t//\t\tsuch as scripting attacks.\n\t\t//\n\t\t// tags:\n\t\t//\t\tprivate\n\n\t\tconstructor: function(params /*===== , srcNodeRef =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tCreate the widget.\n\t\t\t// params: Object|null\n\t\t\t//\t\tInitial settings for any of the widget attributes, except readonly attributes.\n\t\t\t// srcNodeRef: DOMNode\n\t\t\t//\t\tThe widget replaces the specified DOMNode.\n\n\t\t\t// contentPreFilters: Function(String)[]\n\t\t\t//\t\tPre content filter function register array.\n\t\t\t//\t\tthese filters will be executed before the actual\n\t\t\t//\t\tediting area gets the html content.\n\t\t\tthis.contentPreFilters = [];\n\n\t\t\t// contentPostFilters: Function(String)[]\n\t\t\t//\t\tpost content filter function register array.\n\t\t\t//\t\tThese will be used on the resulting html\n\t\t\t//\t\tfrom contentDomPostFilters. The resulting\n\t\t\t//\t\tcontent is the final html (returned by getValue()).\n\t\t\tthis.contentPostFilters = [];\n\n\t\t\t// contentDomPreFilters: Function(DomNode)[]\n\t\t\t//\t\tPre content dom filter function register array.\n\t\t\t//\t\tThese filters are applied after the result from\n\t\t\t//\t\tcontentPreFilters are set to the editing area.\n\t\t\tthis.contentDomPreFilters = [];\n\n\t\t\t// contentDomPostFilters: Function(DomNode)[]\n\t\t\t//\t\tPost content dom filter function register array.\n\t\t\t//\t\tThese filters are executed on the editing area dom.\n\t\t\t//\t\tThe result from these will be passed to contentPostFilters.\n\t\t\tthis.contentDomPostFilters = [];\n\n\t\t\t// editingAreaStyleSheets: dojo._URL[]\n\t\t\t//\t\tarray to store all the stylesheets applied to the editing area\n\t\t\tthis.editingAreaStyleSheets = [];\n\n\t\t\t// Make a copy of this.events before we start writing into it, otherwise we\n\t\t\t// will modify the prototype which leads to bad things on pages w/multiple editors\n\t\t\tthis.events = [].concat(this.events);\n\n\t\t\tthis._keyHandlers = {};\n\n\t\t\tif(params && lang.isString(params.value)){\n\t\t\t\tthis.value = params.value;\n\t\t\t}\n\n\t\t\tthis.onLoadDeferred = new Deferred();\n\t\t},\n\n\t\tbaseClass: \"dijitEditor\",\n\n\t\t// inheritWidth: Boolean\n\t\t//\t\twhether to inherit the parent's width or simply use 100%\n\t\tinheritWidth: false,\n\n\t\t// focusOnLoad: [deprecated] Boolean\n\t\t//\t\tFocus into this widget when the page is loaded\n\t\tfocusOnLoad: false,\n\n\t\t// name: String?\n\t\t//\t\tSpecifies the name of a (hidden) `<textarea>` node on the page that's used to save\n\t\t//\t\tthe editor content on page leave.   Used to restore editor contents after navigating\n\t\t//\t\tto a new page and then hitting the back button.\n\t\tname: \"\",\n\n\t\t// styleSheets: [const] String\n\t\t//\t\tsemicolon (\";\") separated list of css files for the editing area\n\t\tstyleSheets: \"\",\n\n\t\t// height: String\n\t\t//\t\tSet height to fix the editor at a specific height, with scrolling.\n\t\t//\t\tBy default, this is 300px.  If you want to have the editor always\n\t\t//\t\tresizes to accommodate the content, use AlwaysShowToolbar plugin\n\t\t//\t\tand set height=\"\".  If this editor is used within a layout widget,\n\t\t//\t\tset height=\"100%\".\n\t\theight: \"300px\",\n\n\t\t// minHeight: String\n\t\t//\t\tThe minimum height that the editor should have.\n\t\tminHeight: \"1em\",\n\n\t\t// isClosed: [private] Boolean\n\t\tisClosed: true,\n\n\t\t// isLoaded: [private] Boolean\n\t\tisLoaded: false,\n\n\t\t// _SEPARATOR: [private] String\n\t\t//\t\tUsed to concat contents from multiple editors into a single string,\n\t\t//\t\tso they can be saved into a single `<textarea>` node.  See \"name\" attribute.\n\t\t_SEPARATOR: \"@@**%%__RICHTEXTBOUNDRY__%%**@@\",\n\n\t\t// _NAME_CONTENT_SEP: [private] String\n\t\t//\t\tUSed to separate name from content.  Just a colon isn't safe.\n\t\t_NAME_CONTENT_SEP: \"@@**%%:%%**@@\",\n\n\t\t// onLoadDeferred: [readonly] dojo/promise/Promise\n\t\t//\t\tDeferred which is fired when the editor finishes loading.\n\t\t//\t\tCall myEditor.onLoadDeferred.then(callback) it to be informed\n\t\t//\t\twhen the rich-text area initialization is finalized.\n\t\tonLoadDeferred: null,\n\n\t\t// isTabIndent: Boolean\n\t\t//\t\tMake tab key and shift-tab indent and outdent rather than navigating.\n\t\t//\t\tCaution: sing this makes web pages inaccessible to users unable to use a mouse.\n\t\tisTabIndent: false,\n\n\t\t// disableSpellCheck: [const] Boolean\n\t\t//\t\tWhen true, disables the browser's native spell checking, if supported.\n\t\t//\t\tWorks only in Firefox.\n\t\tdisableSpellCheck: false,\n\n\t\tpostCreate: function(){\n\t\t\tif(\"textarea\" === this.domNode.tagName.toLowerCase()){\n\t\t\t\tconsole.warn(\"RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.\");\n\t\t\t}\n\n\t\t\t// Push in the builtin filters now, making them the first executed, but not over-riding anything\n\t\t\t// users passed in.  See: #6062\n\t\t\tthis.contentPreFilters = [\n\t\t\t\tlang.trim,\t// avoid IE10 problem hitting ENTER on last line when there's a trailing \\n.\n\t\t\t\tlang.hitch(this, \"_preFixUrlAttributes\")\n\t\t\t].concat(this.contentPreFilters);\n\t\t\tif(has(\"mozilla\")){\n\t\t\t\tthis.contentPreFilters = [this._normalizeFontStyle].concat(this.contentPreFilters);\n\t\t\t\tthis.contentPostFilters = [this._removeMozBogus].concat(this.contentPostFilters);\n\t\t\t}\n\t\t\tif(has(\"webkit\")){\n\t\t\t\t// Try to clean up WebKit bogus artifacts.  The inserted classes\n\t\t\t\t// made by WebKit sometimes messes things up.\n\t\t\t\tthis.contentPreFilters = [this._removeWebkitBogus].concat(this.contentPreFilters);\n\t\t\t\tthis.contentPostFilters = [this._removeWebkitBogus].concat(this.contentPostFilters);\n\t\t\t}\n\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\t// IE generates <strong> and <em> but we want to normalize to <b> and <i>\n\t\t\t\t// Still happens in IE11!\n\t\t\t\tthis.contentPostFilters = [this._normalizeFontStyle].concat(this.contentPostFilters);\n\t\t\t\tthis.contentDomPostFilters = [lang.hitch(this, \"_stripBreakerNodes\")].concat(this.contentDomPostFilters);\n\t\t\t}\n\t\t\tthis.contentDomPostFilters = [lang.hitch(this, \"_stripTrailingEmptyNodes\")].concat(this.contentDomPostFilters);\n\t\t\tthis.inherited(arguments);\n\n\t\t\ttopic.publish(dijit._scopeName + \"._editor.RichText::init\", this);\n\t\t},\n\n\t\tstartup: function(){\n\t\t\tthis.inherited(arguments);\n\n\t\t\t// Don't call open() until startup() because we need to be attached to the DOM, and also if we are the\n\t\t\t// child of a StackContainer, let StackContainer._setupChild() do DOM manipulations before iframe is\n\t\t\t// created, to avoid duplicate onload call.\n\t\t\tthis.open();\n\t\t\tthis.setupDefaultShortcuts();\n\t\t},\n\n\t\tsetupDefaultShortcuts: function(){\n\t\t\t// summary:\n\t\t\t//\t\tAdd some default key handlers\n\t\t\t// description:\n\t\t\t//\t\tOverwrite this to setup your own handlers. The default\n\t\t\t//\t\timplementation does not use Editor commands, but directly\n\t\t\t//\t\texecutes the builtin commands within the underlying browser\n\t\t\t//\t\tsupport.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar exec = lang.hitch(this, function(cmd, arg){\n\t\t\t\treturn function(){\n\t\t\t\t\treturn !this.execCommand(cmd, arg);\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tvar ctrlKeyHandlers = {\n\t\t\t\tb: exec(\"bold\"),\n\t\t\t\ti: exec(\"italic\"),\n\t\t\t\tu: exec(\"underline\"),\n\t\t\t\ta: exec(\"selectall\"),\n\t\t\t\ts: function(){\n\t\t\t\t\tthis.save(true);\n\t\t\t\t},\n\t\t\t\tm: function(){\n\t\t\t\t\tthis.isTabIndent = !this.isTabIndent;\n\t\t\t\t},\n\n\t\t\t\t\"1\": exec(\"formatblock\", \"h1\"),\n\t\t\t\t\"2\": exec(\"formatblock\", \"h2\"),\n\t\t\t\t\"3\": exec(\"formatblock\", \"h3\"),\n\t\t\t\t\"4\": exec(\"formatblock\", \"h4\"),\n\n\t\t\t\t\"\\\\\": exec(\"insertunorderedlist\")\n\t\t\t};\n\n\t\t\tif(!has(\"ie\")){\n\t\t\t\tctrlKeyHandlers.Z = exec(\"redo\"); //FIXME: undo?\n\t\t\t}\n\n\t\t\tvar key;\n\t\t\tfor(key in ctrlKeyHandlers){\n\t\t\t\tthis.addKeyHandler(key, true, false, ctrlKeyHandlers[key]);\n\t\t\t}\n\t\t},\n\n\t\t// events: [private] String[]\n\t\t//\t\t events which should be connected to the underlying editing area\n\t\tevents: [\"onKeyDown\", \"onKeyUp\"], // onClick handled specially\n\n\t\t// captureEvents: [deprecated] String[]\n\t\t//\t\t Events which should be connected to the underlying editing\n\t\t//\t\t area, events in this array will be addListener with\n\t\t//\t\t capture=true.\n\t\t// TODO: looking at the code I don't see any distinction between events and captureEvents,\n\t\t// so get rid of this for 2.0 if not sooner\n\t\tcaptureEvents: [],\n\n\t\t_editorCommandsLocalized: false,\n\t\t_localizeEditorCommands: function(){\n\t\t\t// summary:\n\t\t\t//\t\tWhen IE is running in a non-English locale, the API actually changes,\n\t\t\t//\t\tso that we have to say (for example) danraku instead of p (for paragraph).\n\t\t\t//\t\tHandle that here.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(RichText._editorCommandsLocalized){\n\t\t\t\t// Use the already generate cache of mappings.\n\t\t\t\tthis._local2NativeFormatNames = RichText._local2NativeFormatNames;\n\t\t\t\tthis._native2LocalFormatNames = RichText._native2LocalFormatNames;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tRichText._editorCommandsLocalized = true;\n\t\t\tRichText._local2NativeFormatNames = {};\n\t\t\tRichText._native2LocalFormatNames = {};\n\t\t\tthis._local2NativeFormatNames = RichText._local2NativeFormatNames;\n\t\t\tthis._native2LocalFormatNames = RichText._native2LocalFormatNames;\n\t\t\t//in IE, names for blockformat is locale dependent, so we cache the values here\n\n\t\t\t//put p after div, so if IE returns Normal, we show it as paragraph\n\t\t\t//We can distinguish p and div if IE returns Normal, however, in order to detect that,\n\t\t\t//we have to call this.document.selection.createRange().parentElement() or such, which\n\t\t\t//could slow things down. Leave it as it is for now\n\t\t\tvar formats = ['div', 'p', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'ol', 'ul', 'address'];\n\t\t\tvar localhtml = \"\", format, i = 0;\n\t\t\twhile((format = formats[i++])){\n\t\t\t\t//append a <br> after each element to separate the elements more reliably\n\t\t\t\tif(format.charAt(1) !== 'l'){\n\t\t\t\t\tlocalhtml += \"<\" + format + \"><span>content</span></\" + format + \"><br/>\";\n\t\t\t\t}else{\n\t\t\t\t\tlocalhtml += \"<\" + format + \"><li>content</li></\" + format + \"><br/>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t// queryCommandValue returns empty if we hide editNode, so move it out of screen temporary\n\t\t\t// Also, IE9 does weird stuff unless we do it inside the editor iframe.\n\t\t\tvar style = { position: \"absolute\", top: \"0px\", zIndex: 10, opacity: 0.01 };\n\t\t\tvar div = domConstruct.create('div', {style: style, innerHTML: localhtml});\n\t\t\tthis.ownerDocumentBody.appendChild(div);\n\n\t\t\t// IE9 has a timing issue with doing this right after setting\n\t\t\t// the inner HTML, so put a delay in.\n\t\t\tvar inject = lang.hitch(this, function(){\n\t\t\t\tvar node = div.firstChild;\n\t\t\t\twhile(node){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tthis.selection.selectElement(node.firstChild);\n\t\t\t\t\t\tvar nativename = node.tagName.toLowerCase();\n\t\t\t\t\t\tthis._local2NativeFormatNames[nativename] = document.queryCommandValue(\"formatblock\");\n\t\t\t\t\t\tthis._native2LocalFormatNames[this._local2NativeFormatNames[nativename]] = nativename;\n\t\t\t\t\t\tnode = node.nextSibling.nextSibling;\n\t\t\t\t\t\t//console.log(\"Mapped: \", nativename, \" to: \", this._local2NativeFormatNames[nativename]);\n\t\t\t\t\t}catch(e){ /*Sqelch the occasional IE9 error */\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdomConstruct.destroy(div);\n\t\t\t});\n\t\t\tthis.defer(inject);\n\t\t},\n\n\t\topen: function(/*DomNode?*/ element){\n\t\t\t// summary:\n\t\t\t//\t\tTransforms the node referenced in this.domNode into a rich text editing\n\t\t\t//\t\tnode.\n\t\t\t// description:\n\t\t\t//\t\tSets up the editing area asynchronously. This will result in\n\t\t\t//\t\tthe creation and replacement with an iframe.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tif(!this.onLoadDeferred || this.onLoadDeferred.fired >= 0){\n\t\t\t\tthis.onLoadDeferred = new Deferred();\n\t\t\t}\n\n\t\t\tif(!this.isClosed){\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t\ttopic.publish(dijit._scopeName + \"._editor.RichText::open\", this);\n\n\t\t\tif(arguments.length === 1 && element.nodeName){ // else unchanged\n\t\t\t\tthis.domNode = element;\n\t\t\t}\n\n\t\t\tvar dn = this.domNode;\n\n\t\t\t// Compute initial value of the editor\n\t\t\tvar html;\n\t\t\tif(lang.isString(this.value)){\n\t\t\t\t// Allow setting the editor content programmatically instead of\n\t\t\t\t// relying on the initial content being contained within the target\n\t\t\t\t// domNode.\n\t\t\t\thtml = this.value;\n\t\t\t\tdn.innerHTML = \"\";\n\t\t\t}else if(dn.nodeName && dn.nodeName.toLowerCase() == \"textarea\"){\n\t\t\t\t// if we were created from a textarea, then we need to create a\n\t\t\t\t// new editing harness node.\n\t\t\t\tvar ta = (this.textarea = dn);\n\t\t\t\tthis.name = ta.name;\n\t\t\t\thtml = ta.value;\n\t\t\t\tdn = this.domNode = this.ownerDocument.createElement(\"div\");\n\t\t\t\tdn.setAttribute('widgetId', this.id);\n\t\t\t\tta.removeAttribute('widgetId');\n\t\t\t\tdn.cssText = ta.cssText;\n\t\t\t\tdn.className += \" \" + ta.className;\n\t\t\t\tdomConstruct.place(dn, ta, \"before\");\n\t\t\t\tvar tmpFunc = lang.hitch(this, function(){\n\t\t\t\t\t//some browsers refuse to submit display=none textarea, so\n\t\t\t\t\t//move the textarea off screen instead\n\t\t\t\t\tdomStyle.set(ta, {\n\t\t\t\t\t\tdisplay: \"block\",\n\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\ttop: \"-1000px\"\n\t\t\t\t\t});\n\n\t\t\t\t\tif(has(\"ie\")){ //nasty IE bug: abnormal formatting if overflow is not hidden\n\t\t\t\t\t\tvar s = ta.style;\n\t\t\t\t\t\tthis.__overflow = s.overflow;\n\t\t\t\t\t\ts.overflow = \"hidden\";\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis.defer(tmpFunc, 10);\n\t\t\t\t}else{\n\t\t\t\t\ttmpFunc();\n\t\t\t\t}\n\n\t\t\t\tif(ta.form){\n\t\t\t\t\tvar resetValue = ta.value;\n\t\t\t\t\tthis.reset = function(){\n\t\t\t\t\t\tvar current = this.getValue();\n\t\t\t\t\t\tif(current !== resetValue){\n\t\t\t\t\t\t\tthis.replaceValue(resetValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\ton(ta.form, \"submit\", lang.hitch(this, function(){\n\t\t\t\t\t\t// Copy value to the <textarea> so it gets submitted along with form.\n\t\t\t\t\t\t// FIXME: should we be calling close() here instead?\n\t\t\t\t\t\tdomAttr.set(ta, 'disabled', this.disabled); // don't submit the value if disabled\n\t\t\t\t\t\tta.value = this.getValue();\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\thtml = htmlapi.getChildrenHtml(dn);\n\t\t\t\tdn.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis.value = html;\n\n\t\t\t// If we're a list item we have to put in a blank line to force the\n\t\t\t// bullet to nicely align at the top of text\n\t\t\tif(dn.nodeName && dn.nodeName === \"LI\"){\n\t\t\t\tdn.innerHTML = \" <br>\";\n\t\t\t}\n\n\t\t\t// Construct the editor div structure.\n\t\t\tthis.header = dn.ownerDocument.createElement(\"div\");\n\t\t\tdn.appendChild(this.header);\n\t\t\tthis.editingArea = dn.ownerDocument.createElement(\"div\");\n\t\t\tdn.appendChild(this.editingArea);\n\t\t\tthis.footer = dn.ownerDocument.createElement(\"div\");\n\t\t\tdn.appendChild(this.footer);\n\n\t\t\tif(!this.name){\n\t\t\t\tthis.name = this.id + \"_AUTOGEN\";\n\t\t\t}\n\n\t\t\t// User has pressed back/forward button so we lost the text in the editor, but it's saved\n\t\t\t// in a hidden <textarea> (which contains the data for all the editors on this page),\n\t\t\t// so get editor value from there\n\t\t\tif(this.name !== \"\" && (!config[\"useXDomain\"] || config[\"allowXdRichTextSave\"])){\n\t\t\t\tvar saveTextarea = dom.byId(dijit._scopeName + \"._editor.RichText.value\");\n\t\t\t\tif(saveTextarea && saveTextarea.value !== \"\"){\n\t\t\t\t\tvar datas = saveTextarea.value.split(this._SEPARATOR), i = 0, dat;\n\t\t\t\t\twhile((dat = datas[i++])){\n\t\t\t\t\t\tvar data = dat.split(this._NAME_CONTENT_SEP);\n\t\t\t\t\t\tif(data[0] === this.name){\n\t\t\t\t\t\t\tthis.value = data[1];\n\t\t\t\t\t\t\tdatas = datas.splice(i, 1);\n\t\t\t\t\t\t\tsaveTextarea.value = datas.join(this._SEPARATOR);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!RichText._globalSaveHandler){\n\t\t\t\t\tRichText._globalSaveHandler = {};\n\t\t\t\t\tunload.addOnUnload(function(){\n\t\t\t\t\t\tvar id;\n\t\t\t\t\t\tfor(id in RichText._globalSaveHandler){\n\t\t\t\t\t\t\tvar f = RichText._globalSaveHandler[id];\n\t\t\t\t\t\t\tif(lang.isFunction(f)){\n\t\t\t\t\t\t\t\tf();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tRichText._globalSaveHandler[this.id] = lang.hitch(this, \"_saveContent\");\n\t\t\t}\n\n\t\t\tthis.isClosed = false;\n\n\t\t\tvar ifr = (this.editorObject = this.iframe = this.ownerDocument.createElement('iframe'));\n\t\t\tifr.id = this.id + \"_iframe\";\n\t\t\tifr.style.border = \"none\";\n\t\t\tifr.style.width = \"100%\";\n\t\t\tif(this._layoutMode){\n\t\t\t\t// iframe should be 100% height, thus getting it's height from surrounding\n\t\t\t\t// <div> (which has the correct height set by Editor)\n\t\t\t\tifr.style.height = \"100%\";\n\t\t\t}else{\n\t\t\t\tif(has(\"ie\") >= 7){\n\t\t\t\t\tif(this.height){\n\t\t\t\t\t\tifr.style.height = this.height;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.minHeight){\n\t\t\t\t\t\tifr.style.minHeight = this.minHeight;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tifr.style.height = this.height ? this.height : this.minHeight;\n\t\t\t\t}\n\t\t\t}\n\t\t\tifr.frameBorder = 0;\n\t\t\tifr._loadFunc = lang.hitch(this, function(w){\n\t\t\t\t// This method is called when the editor is first loaded and also if the Editor's\n\t\t\t\t// dom node is repositioned. Unfortunately repositioning the Editor tends to\n\t\t\t\t// clear the iframe's contents, so we can't just no-op in that case.\n\n\t\t\t\tthis.window = w;\n\t\t\t\tthis.document = w.document;\n\n\t\t\t\t// instantiate class to access selected text in editor's iframe\n\t\t\t\tthis.selection = new selectionapi.SelectionManager(w);\n\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\tthis._localizeEditorCommands();\n\t\t\t\t}\n\n\t\t\t\t// Do final setup and set contents of editor.\n\t\t\t\t// Use get(\"value\") rather than html in case _loadFunc() is being called for a second time\n\t\t\t\t// because editor's DOMNode was repositioned.\n\t\t\t\tthis.onLoad(this.get(\"value\"));\n\t\t\t});\n\n\t\t\t// Attach iframe to document, and set the initial (blank) content.\n\t\t\tvar src = this._getIframeDocTxt().replace(/\\\\/g, \"\\\\\\\\\").replace(/'/g, \"\\\\'\"),\n\t\t\t\ts;\n\n\t\t\t// IE10 and earlier will throw an \"Access is denied\" error when attempting to access the parent frame if\n\t\t\t// document.domain has been set, unless the child frame also has the same document.domain set. The child frame\n\t\t\t// can only set document.domain while the document is being constructed using open/write/close; attempting to\n\t\t\t// set it later results in a different \"This method can't be used in this context\" error. See #17529\n\t\t\tif (has(\"ie\") < 11) {\n\t\t\t\ts = 'javascript:document.open();try{parent.window;}catch(e){document.domain=\"' + document.domain + '\";}' +\n\t\t\t\t\t'document.write(\\'' + src + '\\');document.close()';\n\t\t\t}\n\t\t\telse {\n\t\t\t\ts = \"javascript: '\" + src + \"'\";\n\t\t\t}\n\n\t\t\tif(has(\"ie\") == 9){\n\t\t\t\t// On IE9, attach to document before setting the content, to avoid problem w/iframe running in\n\t\t\t\t// wrong security context, see #16633.\n\t\t\t\tthis.editingArea.appendChild(ifr);\n\t\t\t\tifr.src = s;\n\t\t\t}else{\n\t\t\t\t// For other browsers, set src first, especially for IE6/7 where attaching first gives a warning on\n\t\t\t\t// https:// about \"this page contains secure and insecure items, do you want to view both?\"\n\t\t\t\tifr.setAttribute('src', s);\n\t\t\t\tthis.editingArea.appendChild(ifr);\n\t\t\t}\n\n\t\t\t// TODO: this is a guess at the default line-height, kinda works\n\t\t\tif(dn.nodeName === \"LI\"){\n\t\t\t\tdn.lastChild.style.marginTop = \"-1.2em\";\n\t\t\t}\n\n\t\t\tdomClass.add(this.domNode, this.baseClass);\n\t\t},\n\n\t\t//static cache variables shared among all instance of this class\n\t\t_local2NativeFormatNames: {},\n\t\t_native2LocalFormatNames: {},\n\n\t\t_getIframeDocTxt: function(){\n\t\t\t// summary:\n\t\t\t//\t\tGenerates the boilerplate text of the document inside the iframe (ie, `<html><head>...</head><body/></html>`).\n\t\t\t//\t\tEditor content (if not blank) should be added afterwards.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar _cs = domStyle.getComputedStyle(this.domNode);\n\n\t\t\t// The contents inside of <body>.  The real contents are set later via a call to setValue().\n\t\t\t// In auto-expand mode, need a wrapper div for AlwaysShowToolbar plugin to correctly\n\t\t\t// expand/contract the editor as the content changes.\n\t\t\tvar html = \"<div id='dijitEditorBody'></div>\";\n\n\t\t\tvar font = [ _cs.fontWeight, _cs.fontSize, _cs.fontFamily ].join(\" \");\n\n\t\t\t// line height is tricky - applying a units value will mess things up.\n\t\t\t// if we can't get a non-units value, bail out.\n\t\t\tvar lineHeight = _cs.lineHeight;\n\t\t\tif(lineHeight.indexOf(\"px\") >= 0){\n\t\t\t\tlineHeight = parseFloat(lineHeight) / parseFloat(_cs.fontSize);\n\t\t\t\t// console.debug(lineHeight);\n\t\t\t}else if(lineHeight.indexOf(\"em\") >= 0){\n\t\t\t\tlineHeight = parseFloat(lineHeight);\n\t\t\t}else{\n\t\t\t\t// If we can't get a non-units value, just default\n\t\t\t\t// it to the CSS spec default of 'normal'.  Seems to\n\t\t\t\t// work better, esp on IE, than '1.0'\n\t\t\t\tlineHeight = \"normal\";\n\t\t\t}\n\t\t\tvar userStyle = \"\";\n\t\t\tvar self = this;\n\t\t\tthis.style.replace(/(^|;)\\s*(line-|font-?)[^;]+/ig, function(match){\n\t\t\t\tmatch = match.replace(/^;/ig, \"\") + ';';\n\t\t\t\tvar s = match.split(\":\")[0];\n\t\t\t\tif(s){\n\t\t\t\t\ts = lang.trim(s);\n\t\t\t\t\ts = s.toLowerCase();\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar sC = \"\";\n\t\t\t\t\tfor(i = 0; i < s.length; i++){\n\t\t\t\t\t\tvar c = s.charAt(i);\n\t\t\t\t\t\tswitch(c){\n\t\t\t\t\t\t\tcase \"-\":\n\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\tc = s.charAt(i).toUpperCase();\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tsC += c;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomStyle.set(self.domNode, sC, \"\");\n\t\t\t\t}\n\t\t\t\tuserStyle += match + ';';\n\t\t\t});\n\n\n\t\t\t// need to find any associated label element, aria-label, or aria-labelledby and update iframe document title\n\t\t\tvar label = query('label[for=\"' + this.id + '\"]');\n\t\t\tvar title = \"\";\n\t\t\tif(label.length){\n\t\t\t\ttitle = label[0].innerHTML;\n\t\t\t}else if(this[\"aria-label\"]){\n\t\t\t\ttitle = this[\"aria-label\"];\n\t\t\t}else if(this[\"aria-labelledby\"]){\n\t\t\t\ttitle = dom.byId(this[\"aria-labelledby\"]).innerHTML;\n\t\t\t}\n\n\t\t\t// Now that we have the title, also set it as the title attribute on the iframe\n\t\t\tthis.iframe.setAttribute(\"title\", title);\n\n\t\t\treturn [\n\t\t\t\t\"<!DOCTYPE html>\",\n\t\t\t\tthis.isLeftToRight() ? \"<html lang='\" + this.lang + \"'>\\n<head>\\n\" : \"<html dir='rtl' lang='\" + this.lang + \"'>\\n<head>\\n\",\n\t\t\t\ttitle ? \"<title>\" + title + \"</title>\" : \"\",\n\t\t\t\t\"<meta http-equiv='Content-Type' content='text/html'>\\n\",\n\t\t\t\t\"<style>\\n\",\n\t\t\t\t\"\\tbody,html {\\n\",\n\t\t\t\t\"\\t\\tbackground:transparent;\\n\",\n\t\t\t\t\"\\t\\tpadding: 1px 0 0 0;\\n\",\n\t\t\t\t\"\\t\\tmargin: -1px 0 0 0;\\n\", // remove extraneous vertical scrollbar on safari and firefox\n\t\t\t\t\"\\t}\\n\",\n\t\t\t\t\"\\tbody,html,#dijitEditorBody { outline: none; }\",\n\n\t\t\t\t// Set <body> to expand to full size of editor, so clicking anywhere will work.\n\t\t\t\t// Except in auto-expand mode, in which case the editor expands to the size of <body>.\n\t\t\t\t// Also determine how scrollers should be applied.  In autoexpand mode (height = \"\") no scrollers on y at all.\n\t\t\t\t// But in fixed height mode we want both x/y scrollers.\n\t\t\t\t// Scrollers go on <body> since it's been set to height: 100%.\n\t\t\t\t\"html { height: 100%; width: 100%; overflow: hidden; }\\n\",\t// scroll bar is on #dijitEditorBody, shouldn't be on <html>\n\t\t\t\tthis.height ? \"\\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\\n\" :\n\t\t\t\t\t\"\\tbody,#dijitEditorBody { min-height: \" + this.minHeight + \"; width: 100%; overflow-x: auto; overflow-y: hidden; }\\n\",\n\n\t\t\t\t// TODO: left positioning will cause contents to disappear out of view\n\t\t\t\t//\t   if it gets too wide for the visible area\n\t\t\t\t\"\\tbody{\\n\",\n\t\t\t\t\"\\t\\ttop:0px;\\n\",\n\t\t\t\t\"\\t\\tleft:0px;\\n\",\n\t\t\t\t\"\\t\\tright:0px;\\n\",\n\t\t\t\t\"\\t\\tfont:\", font, \";\\n\",\n\t\t\t\t((this.height || has(\"opera\")) ? \"\" : \"\\t\\tposition: fixed;\\n\"),\n\t\t\t\t\"\\t\\tline-height:\", lineHeight, \";\\n\",\n\t\t\t\t\"\\t}\\n\",\n\t\t\t\t\"\\tp{ margin: 1em 0; }\\n\",\n\n\t\t\t\t\"\\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\\n\",\n\t\t\t\t// Can't set min-height in IE9, it puts layout on li, which puts move/resize handles.\n\t\t\t\t(!has(\"ie\") ? \"\\tli{ min-height:1.2em; }\\n\" : \"\"),\n\t\t\t\t\"</style>\\n\",\n\t\t\t\tthis._applyEditingAreaStyleSheets(), \"\\n\",\n\t\t\t\t\"</head>\\n<body role='main' \",\n\n\t\t\t\t// Onload handler fills in real editor content.\n\t\t\t\t// On IE9, sometimes onload is called twice, and the first time frameElement is null (test_FullScreen.html)\n\t\t\t\t\"onload='frameElement && frameElement._loadFunc(window,document)' \",\n\t\t\t\t\"style='\" + userStyle + \"'>\", html, \"</body>\\n</html>\"\n\t\t\t].join(\"\"); // String\n\t\t},\n\n\t\t_applyEditingAreaStyleSheets: function(){\n\t\t\t// summary:\n\t\t\t//\t\tapply the specified css files in styleSheets\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar files = [];\n\t\t\tif(this.styleSheets){\n\t\t\t\tfiles = this.styleSheets.split(';');\n\t\t\t\tthis.styleSheets = '';\n\t\t\t}\n\n\t\t\t//empty this.editingAreaStyleSheets here, as it will be filled in addStyleSheet\n\t\t\tfiles = files.concat(this.editingAreaStyleSheets);\n\t\t\tthis.editingAreaStyleSheets = [];\n\n\t\t\tvar text = '', i = 0, url, ownerWindow = winUtils.get(this.ownerDocument);\n\t\t\twhile((url = files[i++])){\n\t\t\t\tvar abstring = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t\tthis.editingAreaStyleSheets.push(abstring);\n\t\t\t\ttext += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + abstring + '\"/>';\n\t\t\t}\n\t\t\treturn text;\n\t\t},\n\n\t\taddStyleSheet: function(/*dojo/_base/url*/ uri){\n\t\t\t// summary:\n\t\t\t//\t\tadd an external stylesheet for the editing area\n\t\t\t// uri:\n\t\t\t//\t\tUrl of the external css file\n\t\t\tvar url = uri.toString(), ownerWindow = winUtils.get(this.ownerDocument);\n\n\t\t\t//if uri is relative, then convert it to absolute so that it can be resolved correctly in iframe\n\t\t\tif(url.charAt(0) === '.' || (url.charAt(0) !== '/' && !uri.host)){\n\t\t\t\turl = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t}\n\n\t\t\tif(array.indexOf(this.editingAreaStyleSheets, url) > -1){\n//\t\t\tconsole.debug(\"dijit/_editor/RichText.addStyleSheet(): Style sheet \"+url+\" is already applied\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.editingAreaStyleSheets.push(url);\n\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\tif(this.document.createStyleSheet){ //IE\n\t\t\t\t\tthis.document.createStyleSheet(url);\n\t\t\t\t}else{ //other browser\n\t\t\t\t\tvar head = this.document.getElementsByTagName(\"head\")[0];\n\t\t\t\t\tvar stylesheet = this.document.createElement(\"link\");\n\t\t\t\t\tstylesheet.rel = \"stylesheet\";\n\t\t\t\t\tstylesheet.type = \"text/css\";\n\t\t\t\t\tstylesheet.href = url;\n\t\t\t\t\thead.appendChild(stylesheet);\n\t\t\t\t}\n\t\t\t}));\n\t\t},\n\n\t\tremoveStyleSheet: function(/*dojo/_base/url*/ uri){\n\t\t\t// summary:\n\t\t\t//\t\tremove an external stylesheet for the editing area\n\t\t\tvar url = uri.toString(), ownerWindow = winUtils.get(this.ownerDocument);\n\t\t\t//if uri is relative, then convert it to absolute so that it can be resolved correctly in iframe\n\t\t\tif(url.charAt(0) === '.' || (url.charAt(0) !== '/' && !uri.host)){\n\t\t\t\turl = (new _Url(ownerWindow.location, url)).toString();\n\t\t\t}\n\t\t\tvar index = array.indexOf(this.editingAreaStyleSheets, url);\n\t\t\tif(index === -1){\n//\t\t\tconsole.debug(\"dijit/_editor/RichText.removeStyleSheet(): Style sheet \"+url+\" has not been applied\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdelete this.editingAreaStyleSheets[index];\n\t\t\tquery('link[href=\"' + url + '\"]', this.window.document).orphan();\n\t\t},\n\n\t\t// disabled: Boolean\n\t\t//\t\tThe editor is disabled; the text cannot be changed.\n\t\tdisabled: false,\n\n\t\t_mozSettingProps: {'styleWithCSS': false},\n\t\t_setDisabledAttr: function(/*Boolean*/ value){\n\t\t\tvalue = !!value;\n\t\t\tthis._set(\"disabled\", value);\n\t\t\tif(!this.isLoaded){\n\t\t\t\treturn;\n\t\t\t} // this method requires init to be complete\n\t\t\tvar preventIEfocus = has(\"ie\") && (this.isLoaded || !this.focusOnLoad);\n\t\t\tif(preventIEfocus){\n\t\t\t\tthis.editNode.unselectable = \"on\";\n\t\t\t}\n\t\t\tthis.editNode.contentEditable = !value;\n\t\t\tthis.editNode.tabIndex = value ? \"-1\" : this.tabIndex;\n\t\t\tif(preventIEfocus){\n\t\t\t\tthis.defer(function(){\n\t\t\t\t\tif(this.editNode){        // guard in case widget destroyed before timeout\n\t\t\t\t\t\tthis.editNode.unselectable = \"off\";\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(has(\"mozilla\") && !value && this._mozSettingProps){\n\t\t\t\tvar ps = this._mozSettingProps;\n\t\t\t\tvar n;\n\t\t\t\tfor(n in ps){\n\t\t\t\t\tif(ps.hasOwnProperty(n)){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tthis.document.execCommand(n, false, ps[n]);\n\t\t\t\t\t\t}catch(e2){\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._disabledOK = true;\n\t\t},\n\n\t\t/* Event handlers\n\t\t *****************/\n\n\t\tonLoad: function(/*String*/ html){\n\t\t\t// summary:\n\t\t\t//\t\tHandler after the iframe finishes loading.\n\t\t\t// html: String\n\t\t\t//\t\tEditor contents should be set to this value\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(!this.window.__registeredWindow){\n\t\t\t\tthis.window.__registeredWindow = true;\n\t\t\t\tthis._iframeRegHandle = focus.registerIframe(this.iframe);\n\t\t\t}\n\n\t\t\t// there's a wrapper div around the content, see _getIframeDocTxt().\n\t\t\tthis.editNode = this.document.body.firstChild;\n\t\t\tvar _this = this;\n\n\t\t\t// Helper code so IE and FF skip over focusing on the <iframe> and just focus on the inner <div>.\n\t\t\t// See #4996 IE wants to focus the BODY tag.\n\t\t\tthis.beforeIframeNode = domConstruct.place(\"<div tabIndex=-1></div>\", this.iframe, \"before\");\n\t\t\tthis.afterIframeNode = domConstruct.place(\"<div tabIndex=-1></div>\", this.iframe, \"after\");\n\t\t\tthis.iframe.onfocus = this.document.onfocus = function(){\n\t\t\t\t_this.editNode.focus();\n\t\t\t};\n\n\t\t\tthis.focusNode = this.editNode; // for InlineEditBox\n\n\n\t\t\tvar events = this.events.concat(this.captureEvents);\n\t\t\tvar ap = this.iframe ? this.document : this.editNode;\n\t\t\tthis.own.apply(this,\n\t\t\t\tarray.map(events, function(item){\n\t\t\t\t\tvar type = item.toLowerCase().replace(/^on/, \"\");\n\t\t\t\t\treturn on(ap, type, lang.hitch(this, item));\n\t\t\t\t}, this)\n\t\t\t);\n\n\t\t\tthis.own(\n\t\t\t\t// mouseup in the margin does not generate an onclick event\n\t\t\t\ton(ap, \"mouseup\", lang.hitch(this, \"onClick\"))\n\t\t\t);\n\n\t\t\tif(has(\"ie\")){ // IE contentEditable\n\t\t\t\tthis.own(on(this.document, \"mousedown\", lang.hitch(this, \"_onIEMouseDown\"))); // #4996 fix focus\n\n\t\t\t\t// give the node Layout on IE\n\t\t\t\t// TODO: this may no longer be needed, since we've reverted IE to using an iframe,\n\t\t\t\t// not contentEditable.   Removing it would also probably remove the need for creating\n\t\t\t\t// the extra <div> in _getIframeDocTxt()\n\t\t\t\tthis.editNode.style.zoom = 1.0;\n\t\t\t}\n\n\t\t\tif(has(\"webkit\")){\n\t\t\t\t//WebKit sometimes doesn't fire right on selections, so the toolbar\n\t\t\t\t//doesn't update right.  Therefore, help it out a bit with an additional\n\t\t\t\t//listener.  A mouse up will typically indicate a display change, so fire this\n\t\t\t\t//and get the toolbar to adapt.  Reference: #9532\n\t\t\t\tthis._webkitListener = this.own(on(this.document, \"mouseup\", lang.hitch(this, \"onDisplayChanged\")))[0];\n\t\t\t\tthis.own(on(this.document, \"mousedown\", lang.hitch(this, function(e){\n\t\t\t\t\tvar t = e.target;\n\t\t\t\t\tif(t && (t === this.document.body || t === this.document)){\n\t\t\t\t\t\t// Since WebKit uses the inner DIV, we need to check and set position.\n\t\t\t\t\t\t// See: #12024 as to why the change was made.\n\t\t\t\t\t\tthis.defer(\"placeCursorAtEnd\");\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t}\n\n\t\t\tif(has(\"ie\")){\n\t\t\t\t// Try to make sure 'hidden' elements aren't visible in edit mode (like browsers other than IE\n\t\t\t\t// do).  See #9103\n\t\t\t\ttry{\n\t\t\t\t\tthis.document.execCommand('RespectVisibilityInDesign', true, null);\n\t\t\t\t}catch(e){/* squelch */\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.isLoaded = true;\n\n\t\t\tthis.set('disabled', this.disabled); // initialize content to editable (or not)\n\n\t\t\t// Note that setValue() call will only work after isLoaded is set to true (above)\n\n\t\t\t// Set up a function to allow delaying the setValue until a callback is fired\n\t\t\t// This ensures extensions like dijit.Editor have a way to hold the value set\n\t\t\t// until plugins load (and do things like register filters).\n\t\t\tvar setContent = lang.hitch(this, function(){\n\t\t\t\tthis.setValue(html);\n\n\t\t\t\t// Tell app that the Editor has finished loading.  isFulfilled() check avoids spurious\n\t\t\t\t// console warning when this function is called repeatedly because Editor DOMNode was moved.\n\t\t\t\tif(this.onLoadDeferred && !this.onLoadDeferred.isFulfilled()){\n\t\t\t\t\tthis.onLoadDeferred.resolve(true);\n\t\t\t\t}\n\n\t\t\t\tthis.onDisplayChanged();\n\t\t\t\tif(this.focusOnLoad){\n\t\t\t\t\t// after the document loads, then set focus after updateInterval expires so that\n\t\t\t\t\t// onNormalizedDisplayChanged has run to avoid input caret issues\n\t\t\t\t\tdomReady(lang.hitch(this, \"defer\", \"focus\", this.updateInterval));\n\t\t\t\t}\n\t\t\t\t// Save off the initial content now\n\t\t\t\tthis.value = this.getValue(true);\n\t\t\t});\n\t\t\tif(this.setValueDeferred){\n\t\t\t\tthis.setValueDeferred.then(setContent);\n\t\t\t}else{\n\t\t\t\tsetContent();\n\t\t\t}\n\t\t},\n\n\t\tonKeyDown: function(/* Event */ e){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for keydown event\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\t// Modifier keys should not cause the onKeyPressed event because they do not cause any change to the\n\t\t\t// display\n\t\t\tif(e.keyCode === keys.SHIFT ||\n\t\t\t   e.keyCode === keys.ALT ||\n\t\t\t   e.keyCode === keys.META ||\n\t\t\t   e.keyCode === keys.CTRL){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(e.keyCode === keys.TAB && this.isTabIndent){\n\t\t\t\t//prevent tab from moving focus out of editor\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\n\t\t\t\t// FIXME: this is a poor-man's indent/outdent. It would be\n\t\t\t\t// better if it added 4 \"&nbsp;\" chars in an undoable way.\n\t\t\t\t// Unfortunately pasteHTML does not prove to be undoable\n\t\t\t\tif(this.queryCommandEnabled((e.shiftKey ? \"outdent\" : \"indent\"))){\n\t\t\t\t\tthis.execCommand((e.shiftKey ? \"outdent\" : \"indent\"));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Make tab and shift-tab skip over the <iframe>, going from the nested <div> to the toolbar\n\t\t\t// or next element after the editor\n\t\t\tif(e.keyCode == keys.TAB && !this.isTabIndent && !e.ctrlKey && !e.altKey){\n\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t// focus the <iframe> so the browser will shift-tab away from it instead\n\t\t\t\t\tthis.beforeIframeNode.focus();\n\t\t\t\t}else{\n\t\t\t\t\t// focus node after the <iframe> so the browser will tab away from it instead\n\t\t\t\t\tthis.afterIframeNode.focus();\n\t\t\t\t}\n\n\t\t\t\t// Prevent onKeyPressed from firing in order to avoid triggering a display change event when the\n\t\t\t\t// editor is tabbed away; this fixes toolbar controls being inappropriately disabled in IE9+\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(has(\"ie\") < 9 && e.keyCode === keys.BACKSPACE && this.document.selection.type === \"Control\"){\n\t\t\t\t// IE has a bug where if a non-text object is selected in the editor,\n\t\t\t\t// hitting backspace would act as if the browser's back button was\n\t\t\t\t// clicked instead of deleting the object. see #1069\n\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.execCommand(\"delete\");\n\t\t\t}\n\n\t\t\tif(has(\"ff\")){\n\t\t\t\tif(e.keyCode === keys.PAGE_UP || e.keyCode === keys.PAGE_DOWN){\n\t\t\t\t\tif(this.editNode.clientHeight >= this.editNode.scrollHeight){\n\t\t\t\t\t\t// Stop the event to prevent firefox from trapping the cursor when there is no scroll bar.\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar handlers = this._keyHandlers[e.keyCode],\n\t\t\t\targs = arguments;\n\n\t\t\tif(handlers && !e.altKey){\n\t\t\t\tarray.some(handlers, function(h){\n\t\t\t\t\t// treat meta- same as ctrl-, for benefit of mac users\n\t\t\t\t\tif(!(h.shift ^ e.shiftKey) && !(h.ctrl ^ (e.ctrlKey || e.metaKey))){\n\t\t\t\t\t\tif(!h.handler.apply(this, args)){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\t// function call after the character has been inserted\n\t\t\tthis.defer(\"onKeyPressed\", 1);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tonKeyUp: function(/*===== e =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for onkeyup event\n\t\t\t// tags:\n\t\t\t//\t\tcallback\n\t\t},\n\n\t\tsetDisabled: function(/*Boolean*/ disabled){\n\t\t\t// summary:\n\t\t\t//\t\tDeprecated, use set('disabled', ...) instead.\n\t\t\t// tags:\n\t\t\t//\t\tdeprecated\n\t\t\tkernel.deprecated('dijit.Editor::setDisabled is deprecated', 'use dijit.Editor::attr(\"disabled\",boolean) instead', 2.0);\n\t\t\tthis.set('disabled', disabled);\n\t\t},\n\t\t_setValueAttr: function(/*String*/ value){\n\t\t\t// summary:\n\t\t\t//\t\tRegisters that attr(\"value\", foo) should call setValue(foo)\n\t\t\tthis.setValue(value);\n\t\t},\n\t\t_setDisableSpellCheckAttr: function(/*Boolean*/ disabled){\n\t\t\tif(this.document){\n\t\t\t\tdomAttr.set(this.document.body, \"spellcheck\", !disabled);\n\t\t\t}else{\n\t\t\t\t// try again after the editor is finished loading\n\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\tdomAttr.set(this.document.body, \"spellcheck\", !disabled);\n\t\t\t\t}));\n\t\t\t}\n\t\t\tthis._set(\"disableSpellCheck\", disabled);\n\t\t},\n\n\t\taddKeyHandler: function(/*String|Number*/ key, /*Boolean*/ ctrl, /*Boolean*/ shift, /*Function*/ handler){\n\t\t\t// summary:\n\t\t\t//\t\tAdd a handler for a keyboard shortcut\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(typeof key == \"string\"){\n\t\t\t\t// Something like Ctrl-B.  Since using keydown event, we need to convert string to a number.\n\t\t\t\tkey = key.toUpperCase().charCodeAt(0);\n\t\t\t}\n\n\t\t\tif(!lang.isArray(this._keyHandlers[key])){\n\t\t\t\tthis._keyHandlers[key] = [];\n\t\t\t}\n\n\t\t\tthis._keyHandlers[key].push({\n\t\t\t\tshift: shift || false,\n\t\t\t\tctrl: ctrl || false,\n\t\t\t\thandler: handler\n\t\t\t});\n\t\t},\n\n\t\tonKeyPressed: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for after the user has pressed a key, and the display has been updated.\n\t\t\t//\t\t(Runs on a timer so that it runs after the display is updated)\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tthis.onDisplayChanged(/*e*/); // can't pass in e\n\t\t},\n\n\t\tonClick: function(/*Event*/ e){\n\t\t\t// summary:\n\t\t\t//\t\tHandler for when the user clicks.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\t// console.info('onClick',this._tryDesignModeOn);\n\t\t\tthis.onDisplayChanged(e);\n\t\t},\n\n\t\t_onIEMouseDown: function(){\n\t\t\t// summary:\n\t\t\t//\t\tIE only to prevent 2 clicks to focus\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(!this.focused && !this.disabled){\n\t\t\t\tthis.focus();\n\t\t\t}\n\t\t},\n\n\t\t_onBlur: function(e){\n\t\t\t// summary:\n\t\t\t//\t\tCalled from focus manager when focus has moved away from this editor\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\t// Workaround IE problem when you blur the browser windows while an editor is focused: IE hangs\n\t\t\t// when you focus editor #1, blur the browser window, and then click editor #0.  See #16939.\n\t\t\tif(has(\"ie\") || has(\"trident\")){\n\t\t\t\tthis.defer(function(){\n\t\t\t\t\tif(!focus.curNode){\n\t\t\t\t\t\tthis.ownerDocumentBody.focus();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.inherited(arguments);\n\n\t\t\tvar newValue = this.getValue(true);\n\t\t\tif(newValue !== this.value){\n\t\t\t\tthis.onChange(newValue);\n\t\t\t}\n\t\t\tthis._set(\"value\", newValue);\n\t\t},\n\n\t\t_onFocus: function(/*Event*/ e){\n\t\t\t// summary:\n\t\t\t//\t\tCalled from focus manager when focus has moved into this editor\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\t// console.info('_onFocus')\n\t\t\tif(!this.disabled){\n\t\t\t\tif(!this._disabledOK){\n\t\t\t\t\tthis.set('disabled', false);\n\t\t\t\t}\n\t\t\t\tthis.inherited(arguments);\n\t\t\t}\n\t\t},\n\n\t\t// TODO: remove in 2.0\n\t\tblur: function(){\n\t\t\t// summary:\n\t\t\t//\t\tRemove focus from this instance.\n\t\t\t// tags:\n\t\t\t//\t\tdeprecated\n\t\t\tif(!has(\"ie\") && this.window.document.documentElement && this.window.document.documentElement.focus){\n\t\t\t\tthis.window.document.documentElement.focus();\n\t\t\t}else if(this.ownerDocumentBody.focus){\n\t\t\t\tthis.ownerDocumentBody.focus();\n\t\t\t}\n\t\t},\n\n\t\tfocus: function(){\n\t\t\t// summary:\n\t\t\t//\t\tMove focus to this editor\n\t\t\tif(!this.isLoaded){\n\t\t\t\tthis.focusOnLoad = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(has(\"ie\") < 9){\n\t\t\t\t//this.editNode.focus(); -> causes IE to scroll always (strict and quirks mode) to the top the Iframe\n\t\t\t\t// if we fire the event manually and let the browser handle the focusing, the latest\n\t\t\t\t// cursor position is focused like in FF\n\t\t\t\tthis.iframe.fireEvent('onfocus', document.createEventObject()); // createEventObject/fireEvent only in IE < 11\n\t\t\t}else{\n\t\t\t\t// Firefox and chrome\n\t\t\t\tthis.editNode.focus();\n\t\t\t}\n\t\t},\n\n\t\t// _lastUpdate: 0,\n\t\tupdateInterval: 200,\n\t\t_updateTimer: null,\n\t\tonDisplayChanged: function(/*Event*/ /*===== e =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis event will be fired every time the display context\n\t\t\t//\t\tchanges and the result needs to be reflected in the UI.\n\t\t\t// description:\n\t\t\t//\t\tIf you don't want to have update too often,\n\t\t\t//\t\tonNormalizedDisplayChanged should be used instead\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\t// var _t=new Date();\n\t\t\tif(this._updateTimer){\n\t\t\t\tthis._updateTimer.remove();\n\t\t\t}\n\t\t\tthis._updateTimer = this.defer(\"onNormalizedDisplayChanged\", this.updateInterval);\n\n\t\t\t// Technically this should trigger a call to watch(\"value\", ...) registered handlers,\n\t\t\t// but getValue() is too slow to call on every keystroke so we don't.\n\t\t},\n\t\tonNormalizedDisplayChanged: function(){\n\t\t\t// summary:\n\t\t\t//\t\tThis event is fired every updateInterval ms or more\n\t\t\t// description:\n\t\t\t//\t\tIf something needs to happen immediately after a\n\t\t\t//\t\tuser change, please use onDisplayChanged instead.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tdelete this._updateTimer;\n\t\t},\n\t\tonChange: function(/*===== newContent =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis is fired if and only if the editor loses focus and\n\t\t\t//\t\tthe content is changed.\n\t\t},\n\t\t_normalizeCommand: function(/*String*/ cmd, /*Anything?*/argument){\n\t\t\t// summary:\n\t\t\t//\t\tUsed as the advice function to map our\n\t\t\t//\t\tnormalized set of commands to those supported by the target\n\t\t\t//\t\tbrowser.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar command = cmd.toLowerCase();\n\t\t\tif(command === \"formatblock\"){\n\t\t\t\tif(has(\"safari\") && argument === undefined){\n\t\t\t\t\tcommand = \"heading\";\n\t\t\t\t}\n\t\t\t}else if(command === \"hilitecolor\" && !has(\"mozilla\")){\n\t\t\t\tcommand = \"backcolor\";\n\t\t\t}\n\n\t\t\treturn command;\n\t\t},\n\n\t\t_qcaCache: {},\n\t\tqueryCommandAvailable: function(/*String*/ command){\n\t\t\t// summary:\n\t\t\t//\t\tTests whether a command is supported by the host. Clients\n\t\t\t//\t\tSHOULD check whether a command is supported before attempting\n\t\t\t//\t\tto use it, behaviour for unsupported commands is undefined.\n\t\t\t// command:\n\t\t\t//\t\tThe command to test for\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\t// memoizing version. See _queryCommandAvailable for computing version\n\t\t\tvar ca = this._qcaCache[command];\n\t\t\tif(ca !== undefined){\n\t\t\t\treturn ca;\n\t\t\t}\n\t\t\treturn (this._qcaCache[command] = this._queryCommandAvailable(command));\n\t\t},\n\n\t\t_queryCommandAvailable: function(/*String*/ command){\n\t\t\t// summary:\n\t\t\t//\t\tSee queryCommandAvailable().\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar ie = 1;\n\t\t\tvar mozilla = 1 << 1;\n\t\t\tvar webkit = 1 << 2;\n\t\t\tvar opera = 1 << 3;\n\n\t\t\tfunction isSupportedBy(browsers){\n\t\t\t\treturn {\n\t\t\t\t\tie: Boolean(browsers & ie),\n\t\t\t\t\tmozilla: Boolean(browsers & mozilla),\n\t\t\t\t\twebkit: Boolean(browsers & webkit),\n\t\t\t\t\topera: Boolean(browsers & opera)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar supportedBy = null;\n\n\t\t\tswitch(command.toLowerCase()){\n\t\t\t\tcase \"bold\":\n\t\t\t\tcase \"italic\":\n\t\t\t\tcase \"underline\":\n\t\t\t\tcase \"subscript\":\n\t\t\t\tcase \"superscript\":\n\t\t\t\tcase \"fontname\":\n\t\t\t\tcase \"fontsize\":\n\t\t\t\tcase \"forecolor\":\n\t\t\t\tcase \"hilitecolor\":\n\t\t\t\tcase \"justifycenter\":\n\t\t\t\tcase \"justifyfull\":\n\t\t\t\tcase \"justifyleft\":\n\t\t\t\tcase \"justifyright\":\n\t\t\t\tcase \"delete\":\n\t\t\t\tcase \"selectall\":\n\t\t\t\tcase \"toggledir\":\n\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie | webkit | opera);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"createlink\":\n\t\t\t\tcase \"unlink\":\n\t\t\t\tcase \"removeformat\":\n\t\t\t\tcase \"inserthorizontalrule\":\n\t\t\t\tcase \"insertimage\":\n\t\t\t\tcase \"insertorderedlist\":\n\t\t\t\tcase \"insertunorderedlist\":\n\t\t\t\tcase \"indent\":\n\t\t\t\tcase \"outdent\":\n\t\t\t\tcase \"formatblock\":\n\t\t\t\tcase \"inserthtml\":\n\t\t\t\tcase \"undo\":\n\t\t\t\tcase \"redo\":\n\t\t\t\tcase \"strikethrough\":\n\t\t\t\tcase \"tabindent\":\n\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie | opera | webkit);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"blockdirltr\":\n\t\t\t\tcase \"blockdirrtl\":\n\t\t\t\tcase \"dirltr\":\n\t\t\t\tcase \"dirrtl\":\n\t\t\t\tcase \"inlinedirltr\":\n\t\t\t\tcase \"inlinedirrtl\":\n\t\t\t\t\tsupportedBy = isSupportedBy(ie);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"cut\":\n\t\t\t\tcase \"copy\":\n\t\t\t\tcase \"paste\":\n\t\t\t\t\tsupportedBy = isSupportedBy(ie | mozilla | webkit | opera);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"inserttable\":\n\t\t\t\t\tsupportedBy = isSupportedBy(mozilla | ie);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"insertcell\":\n\t\t\t\tcase \"insertcol\":\n\t\t\t\tcase \"insertrow\":\n\t\t\t\tcase \"deletecells\":\n\t\t\t\tcase \"deletecols\":\n\t\t\t\tcase \"deleterows\":\n\t\t\t\tcase \"mergecells\":\n\t\t\t\tcase \"splitcell\":\n\t\t\t\t\tsupportedBy = isSupportedBy(ie | mozilla);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn ((has(\"ie\") || has(\"trident\")) && supportedBy.ie) ||\n\t\t\t\t(has(\"mozilla\") && supportedBy.mozilla) ||\n\t\t\t\t(has(\"webkit\") && supportedBy.webkit) ||\n\t\t\t\t(has(\"opera\") && supportedBy.opera);\t// Boolean return true if the command is supported, false otherwise\n\t\t},\n\n\t\texecCommand: function(/*String*/ command, argument){\n\t\t\t// summary:\n\t\t\t//\t\tExecutes a command in the Rich Text area\n\t\t\t// command:\n\t\t\t//\t\tThe command to execute\n\t\t\t// argument:\n\t\t\t//\t\tAn optional argument to the command\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar returnValue;\n\n\t\t\t//focus() is required for IE to work\n\t\t\t//In addition, focus() makes sure after the execution of\n\t\t\t//the command, the editor receives the focus as expected\n\t\t\tif(this.focused){\n\t\t\t\t// put focus back in the iframe, unless focus has somehow been shifted out of the editor completely\n\t\t\t\tthis.focus();\n\t\t\t}\n\n\t\t\tcommand = this._normalizeCommand(command, argument);\n\n\t\t\tif(argument !== undefined){\n\t\t\t\tif(command === \"heading\"){\n\t\t\t\t\tthrow new Error(\"unimplemented\");\n\t\t\t\t}else if(command === \"formatblock\" && (has(\"ie\") || has(\"trident\"))){\n\t\t\t\t\targument = '<' + argument + '>';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Check to see if we have any over-rides for commands, they will be functions on this\n\t\t\t//widget of the form _commandImpl.  If we don't, fall through to the basic native\n\t\t\t//exec command of the browser.\n\t\t\tvar implFunc = \"_\" + command + \"Impl\";\n\t\t\tif(this[implFunc]){\n\t\t\t\treturnValue = this[implFunc](argument);\n\t\t\t}else{\n\t\t\t\targument = arguments.length > 1 ? argument : null;\n\t\t\t\tif(argument || command !== \"createlink\"){\n\t\t\t\t\treturnValue = this.document.execCommand(command, false, argument);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onDisplayChanged();\n\t\t\treturn returnValue;\n\t\t},\n\n\t\tqueryCommandEnabled: function(/*String*/ command){\n\t\t\t// summary:\n\t\t\t//\t\tCheck whether a command is enabled or not.\n\t\t\t// command:\n\t\t\t//\t\tThe command to execute\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tcommand = this._normalizeCommand(command);\n\n\t\t\t//Check to see if we have any over-rides for commands, they will be functions on this\n\t\t\t//widget of the form _commandEnabledImpl.  If we don't, fall through to the basic native\n\t\t\t//command of the browser.\n\t\t\tvar implFunc = \"_\" + command + \"EnabledImpl\";\n\n\t\t\tif(this[implFunc]){\n\t\t\t\treturn  this[implFunc](command);\n\t\t\t}else{\n\t\t\t\treturn this._browserQueryCommandEnabled(command);\n\t\t\t}\n\t\t},\n\n\t\tqueryCommandState: function(command){\n\t\t\t// summary:\n\t\t\t//\t\tCheck the state of a given command and returns true or false.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcommand = this._normalizeCommand(command);\n\t\t\ttry{\n\t\t\t\treturn this.document.queryCommandState(command);\n\t\t\t}catch(e){\n\t\t\t\t//Squelch, occurs if editor is hidden on FF 3 (and maybe others.)\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tqueryCommandValue: function(command){\n\t\t\t// summary:\n\t\t\t//\t\tCheck the value of a given command. This matters most for\n\t\t\t//\t\tcustom selections and complex values like font value setting.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(this.disabled || !this._disabledOK){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar r;\n\t\t\tcommand = this._normalizeCommand(command);\n\t\t\tif((has(\"ie\") || has(\"trident\")) && command === \"formatblock\"){\n\t\t\t\tr = this._native2LocalFormatNames[this.document.queryCommandValue(command)];\n\t\t\t}else if(has(\"mozilla\") && command === \"hilitecolor\"){\n\t\t\t\tvar oldValue;\n\t\t\t\ttry{\n\t\t\t\t\toldValue = this.document.queryCommandValue(\"styleWithCSS\");\n\t\t\t\t}catch(e){\n\t\t\t\t\toldValue = false;\n\t\t\t\t}\n\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, true);\n\t\t\t\tr = this.document.queryCommandValue(command);\n\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, oldValue);\n\t\t\t}else{\n\t\t\t\tr = this.document.queryCommandValue(command);\n\t\t\t}\n\t\t\treturn r;\n\t\t},\n\n\t\t// Misc.\n\n\t\t_sCall: function(name, args){\n\t\t\t// summary:\n\t\t\t//\t\tDeprecated, remove for 2.0.   New code should access this.selection directly.\n\t\t\t//\t\tRun the named method of dijit/selection over the\n\t\t\t//\t\tcurrent editor instance's window, with the passed args.\n\t\t\t// tags:\n\t\t\t//\t\tprivate deprecated\n\n\t\t\treturn this.selection[name].apply(this.selection, args);\n\t\t},\n\n\t\t// FIXME: this is a TON of code duplication. Why?\n\n\t\tplaceCursorAtStart: function(){\n\t\t\t// summary:\n\t\t\t//\t\tPlace the cursor at the start of the editing area.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tthis.focus();\n\n\t\t\t//see comments in placeCursorAtEnd\n\t\t\tvar isvalid = false;\n\t\t\tif(has(\"mozilla\")){\n\t\t\t\t// TODO:  Is this branch even necessary?\n\t\t\t\tvar first = this.editNode.firstChild;\n\t\t\t\twhile(first){\n\t\t\t\t\tif(first.nodeType === 3){\n\t\t\t\t\t\tif(first.nodeValue.replace(/^\\s+|\\s+$/g, \"\").length > 0){\n\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\tthis.selection.selectElement(first);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(first.nodeType === 1){\n\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\tvar tg = first.tagName ? first.tagName.toLowerCase() : \"\";\n\t\t\t\t\t\t// Collapse before childless tags.\n\t\t\t\t\t\tif(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){\n\t\t\t\t\t\t\tthis.selection.selectElement(first);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// Collapse inside tags with children.\n\t\t\t\t\t\t\tthis.selection.selectElementChildren(first);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tisvalid = true;\n\t\t\t\tthis.selection.selectElementChildren(this.editNode);\n\t\t\t}\n\t\t\tif(isvalid){\n\t\t\t\tthis.selection.collapse(true);\n\t\t\t}\n\t\t},\n\n\t\tplaceCursorAtEnd: function(){\n\t\t\t// summary:\n\t\t\t//\t\tPlace the cursor at the end of the editing area.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tthis.focus();\n\n\t\t\t//In mozilla, if last child is not a text node, we have to use\n\t\t\t// selectElementChildren on this.editNode.lastChild otherwise the\n\t\t\t// cursor would be placed at the end of the closing tag of\n\t\t\t//this.editNode.lastChild\n\t\t\tvar isvalid = false;\n\t\t\tif(has(\"mozilla\")){\n\t\t\t\tvar last = this.editNode.lastChild;\n\t\t\t\twhile(last){\n\t\t\t\t\tif(last.nodeType === 3){\n\t\t\t\t\t\tif(last.nodeValue.replace(/^\\s+|\\s+$/g, \"\").length > 0){\n\t\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\t\tthis.selection.selectElement(last);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(last.nodeType === 1){\n\t\t\t\t\t\tisvalid = true;\n\t\t\t\t\t\tthis.selection.selectElement(last.lastChild || last);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlast = last.previousSibling;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tisvalid = true;\n\t\t\t\tthis.selection.selectElementChildren(this.editNode);\n\t\t\t}\n\t\t\tif(isvalid){\n\t\t\t\tthis.selection.collapse(false);\n\t\t\t}\n\t\t},\n\n\t\tgetValue: function(/*Boolean?*/ nonDestructive){\n\t\t\t// summary:\n\t\t\t//\t\tReturn the current content of the editing area (post filters\n\t\t\t//\t\tare applied).  Users should call get('value') instead.\n\t\t\t// nonDestructive:\n\t\t\t//\t\tdefaults to false. Should the post-filtering be run over a copy\n\t\t\t//\t\tof the live DOM? Most users should pass \"true\" here unless they\n\t\t\t//\t\t*really* know that none of the installed filters are going to\n\t\t\t//\t\tmess up the editing session.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(this.textarea){\n\t\t\t\tif(this.isClosed || !this.isLoaded){\n\t\t\t\t\treturn this.textarea.value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.isLoaded ? this._postFilterContent(null, nonDestructive) : this.value;\n\t\t},\n\t\t_getValueAttr: function(){\n\t\t\t// summary:\n\t\t\t//\t\tHook to make attr(\"value\") work\n\t\t\treturn this.getValue(true);\n\t\t},\n\n\t\tsetValue: function(/*String*/ html){\n\t\t\t// summary:\n\t\t\t//\t\tThis function sets the content. No undo history is preserved.\n\t\t\t//\t\tUsers should use set('value', ...) instead.\n\t\t\t// tags:\n\t\t\t//\t\tdeprecated\n\n\t\t\t// TODO: remove this and getValue() for 2.0, and move code to _setValueAttr()\n\n\t\t\tif(!this.isLoaded){\n\t\t\t\t// try again after the editor is finished loading\n\t\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\t\tthis.setValue(html);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(this.textarea && (this.isClosed || !this.isLoaded)){\n\t\t\t\tthis.textarea.value = html;\n\t\t\t}else{\n\t\t\t\thtml = this._preFilterContent(html);\n\t\t\t\tvar node = this.isClosed ? this.domNode : this.editNode;\n\n\t\t\t\tnode.innerHTML = html;\n\t\t\t\tthis._preDomFilterContent(node);\n\t\t\t}\n\n\t\t\tthis.onDisplayChanged();\n\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t},\n\n\t\treplaceValue: function(/*String*/ html){\n\t\t\t// summary:\n\t\t\t//\t\tThis function set the content while trying to maintain the undo stack\n\t\t\t//\t\t(now only works fine with Moz, this is identical to setValue in all\n\t\t\t//\t\tother browsers)\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\n\t\t\tif(this.isClosed){\n\t\t\t\tthis.setValue(html);\n\t\t\t}else if(this.window && this.window.getSelection && !has(\"mozilla\")){ // Safari\n\t\t\t\t// look ma! it's a totally f'd browser!\n\t\t\t\tthis.setValue(html);\n\t\t\t}else if(this.window && this.window.getSelection){ // Moz\n\t\t\t\thtml = this._preFilterContent(html);\n\t\t\t\tthis.execCommand(\"selectall\");\n\t\t\t\tthis.execCommand(\"inserthtml\", html);\n\t\t\t\tthis._preDomFilterContent(this.editNode);\n\t\t\t}else if(this.document && this.document.selection){//IE\n\t\t\t\t//In IE, when the first element is not a text node, say\n\t\t\t\t//an <a> tag, when replacing the content of the editing\n\t\t\t\t//area, the <a> tag will be around all the content\n\t\t\t\t//so for now, use setValue for IE too\n\t\t\t\tthis.setValue(html);\n\t\t\t}\n\n\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t},\n\n\t\t_preFilterContent: function(/*String*/ html){\n\t\t\t// summary:\n\t\t\t//\t\tFilter the input before setting the content of the editing\n\t\t\t//\t\tarea. DOM pre-filtering may happen after this\n\t\t\t//\t\tstring-based filtering takes place but as of 1.2, this is not\n\t\t\t//\t\tguaranteed for operations such as the inserthtml command.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar ec = html;\n\t\t\tarray.forEach(this.contentPreFilters, function(ef){\n\t\t\t\tif(ef){\n\t\t\t\t\tec = ef(ec);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ec;\n\t\t},\n\t\t_preDomFilterContent: function(/*DomNode*/ dom){\n\t\t\t// summary:\n\t\t\t//\t\tfilter the input's live DOM. All filter operations should be\n\t\t\t//\t\tconsidered to be \"live\" and operating on the DOM that the user\n\t\t\t//\t\twill be interacting with in their editing session.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tdom = dom || this.editNode;\n\t\t\tarray.forEach(this.contentDomPreFilters, function(ef){\n\t\t\t\tif(ef && lang.isFunction(ef)){\n\t\t\t\t\tef(dom);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t},\n\n\t\t_postFilterContent: function(/*DomNode|DomNode[]|String?*/ dom, /*Boolean?*/ nonDestructive){\n\t\t\t// summary:\n\t\t\t//\t\tfilter the output after getting the content of the editing area\n\t\t\t//\n\t\t\t// description:\n\t\t\t//\t\tpost-filtering allows plug-ins and users to specify any number\n\t\t\t//\t\tof transforms over the editor's content, enabling many common\n\t\t\t//\t\tuse-cases such as transforming absolute to relative URLs (and\n\t\t\t//\t\tvice-versa), ensuring conformance with a particular DTD, etc.\n\t\t\t//\t\tThe filters are registered in the contentDomPostFilters and\n\t\t\t//\t\tcontentPostFilters arrays. Each item in the\n\t\t\t//\t\tcontentDomPostFilters array is a function which takes a DOM\n\t\t\t//\t\tNode or array of nodes as its only argument and returns the\n\t\t\t//\t\tsame. It is then passed down the chain for further filtering.\n\t\t\t//\t\tThe contentPostFilters array behaves the same way, except each\n\t\t\t//\t\tmember operates on strings. Together, the DOM and string-based\n\t\t\t//\t\tfiltering allow the full range of post-processing that should\n\t\t\t//\t\tbe necessaray to enable even the most agressive of post-editing\n\t\t\t//\t\tconversions to take place.\n\t\t\t//\n\t\t\t//\t\tIf nonDestructive is set to \"true\", the nodes are cloned before\n\t\t\t//\t\tfiltering proceeds to avoid potentially destructive transforms\n\t\t\t//\t\tto the content which may still needed to be edited further.\n\t\t\t//\t\tOnce DOM filtering has taken place, the serialized version of\n\t\t\t//\t\tthe DOM which is passed is run through each of the\n\t\t\t//\t\tcontentPostFilters functions.\n\t\t\t//\n\t\t\t// dom:\n\t\t\t//\t\ta node, set of nodes, which to filter using each of the current\n\t\t\t//\t\tmembers of the contentDomPostFilters and contentPostFilters arrays.\n\t\t\t//\n\t\t\t// nonDestructive:\n\t\t\t//\t\tdefaults to \"false\". If true, ensures that filtering happens on\n\t\t\t//\t\ta clone of the passed-in content and not the actual node\n\t\t\t//\t\titself.\n\t\t\t//\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar ec;\n\t\t\tif(!lang.isString(dom)){\n\t\t\t\tdom = dom || this.editNode;\n\t\t\t\tif(this.contentDomPostFilters.length){\n\t\t\t\t\tif(nonDestructive){\n\t\t\t\t\t\tdom = lang.clone(dom);\n\t\t\t\t\t}\n\t\t\t\t\tarray.forEach(this.contentDomPostFilters, function(ef){\n\t\t\t\t\t\tdom = ef(dom);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tec = htmlapi.getChildrenHtml(dom);\n\t\t\t}else{\n\t\t\t\tec = dom;\n\t\t\t}\n\n\t\t\tif(!lang.trim(ec.replace(/^\\xA0\\xA0*/, '').replace(/\\xA0\\xA0*$/, '')).length){\n\t\t\t\tec = \"\";\n\t\t\t}\n\n\t\t\tarray.forEach(this.contentPostFilters, function(ef){\n\t\t\t\tec = ef(ec);\n\t\t\t});\n\n\t\t\treturn ec;\n\t\t},\n\n\t\t_saveContent: function(){\n\t\t\t// summary:\n\t\t\t//\t\tSaves the content in an onunload event if the editor has not been closed\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tvar saveTextarea = dom.byId(dijit._scopeName + \"._editor.RichText.value\");\n\t\t\tif(saveTextarea){\n\t\t\t\tif(saveTextarea.value){\n\t\t\t\t\tsaveTextarea.value += this._SEPARATOR;\n\t\t\t\t}\n\t\t\t\tsaveTextarea.value += this.name + this._NAME_CONTENT_SEP + this.getValue(true);\n\t\t\t}\n\t\t},\n\n\n\t\tescapeXml: function(/*String*/ str, /*Boolean*/ noSingleQuotes){\n\t\t\t// summary:\n\t\t\t//\t\tAdds escape sequences for special characters in XML.\n\t\t\t//\t\tOptionally skips escapes for single quotes\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tstr = str.replace(/&/gm, \"&amp;\").replace(/</gm, \"&lt;\").replace(/>/gm, \"&gt;\").replace(/\"/gm, \"&quot;\");\n\t\t\tif(!noSingleQuotes){\n\t\t\t\tstr = str.replace(/'/gm, \"&#39;\");\n\t\t\t}\n\t\t\treturn str; // string\n\t\t},\n\n\t\tgetNodeHtml: function(/* DomNode */ node){\n\t\t\t// summary:\n\t\t\t//\t\tDeprecated.   Use dijit/_editor/html::_getNodeHtml() instead.\n\t\t\t// tags:\n\t\t\t//\t\tdeprecated\n\t\t\tkernel.deprecated('dijit.Editor::getNodeHtml is deprecated', 'use dijit/_editor/html::getNodeHtml instead', 2);\n\t\t\treturn htmlapi.getNodeHtml(node); // String\n\t\t},\n\n\t\tgetNodeChildrenHtml: function(/* DomNode */ dom){\n\t\t\t// summary:\n\t\t\t//\t\tDeprecated.   Use dijit/_editor/html::getChildrenHtml() instead.\n\t\t\t// tags:\n\t\t\t//\t\tdeprecated\n\t\t\tkernel.deprecated('dijit.Editor::getNodeChildrenHtml is deprecated', 'use dijit/_editor/html::getChildrenHtml instead', 2);\n\t\t\treturn htmlapi.getChildrenHtml(dom);\n\t\t},\n\n\t\tclose: function(/*Boolean?*/ save){\n\t\t\t// summary:\n\t\t\t//\t\tKills the editor and optionally writes back the modified contents to the\n\t\t\t//\t\telement from which it originated.\n\t\t\t// save:\n\t\t\t//\t\tWhether or not to save the changes. If false, the changes are discarded.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\n\t\t\tif(this.isClosed){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!arguments.length){\n\t\t\t\tsave = true;\n\t\t\t}\n\t\t\tif(save){\n\t\t\t\tthis._set(\"value\", this.getValue(true));\n\t\t\t}\n\n\t\t\t// line height is squashed for iframes\n\t\t\t// FIXME: why was this here? if(this.iframe){ this.domNode.style.lineHeight = null; }\n\n\t\t\tif(this.interval){\n\t\t\t\tclearInterval(this.interval);\n\t\t\t}\n\n\t\t\tif(this._webkitListener){\n\t\t\t\t// Cleanup of WebKit fix: #9532\n\t\t\t\tthis._webkitListener.remove();\n\t\t\t\tdelete this._webkitListener;\n\t\t\t}\n\n\t\t\t// Guard against memory leaks on IE (see #9268)\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis.iframe.onfocus = null;\n\t\t\t}\n\t\t\tthis.iframe._loadFunc = null;\n\n\t\t\tif(this._iframeRegHandle){\n\t\t\t\tthis._iframeRegHandle.remove();\n\t\t\t\tdelete this._iframeRegHandle;\n\t\t\t}\n\n\t\t\tif(this.textarea){\n\t\t\t\tvar s = this.textarea.style;\n\t\t\t\ts.position = \"\";\n\t\t\t\ts.left = s.top = \"\";\n\t\t\t\tif(has(\"ie\")){\n\t\t\t\t\ts.overflow = this.__overflow;\n\t\t\t\t\tthis.__overflow = null;\n\t\t\t\t}\n\t\t\t\tthis.textarea.value = this.value;\n\t\t\t\tdomConstruct.destroy(this.domNode);\n\t\t\t\tthis.domNode = this.textarea;\n\t\t\t}else{\n\t\t\t\t// Note that this destroys the iframe\n\t\t\t\tthis.domNode.innerHTML = this.value;\n\t\t\t}\n\t\t\tdelete this.iframe;\n\n\t\t\tdomClass.remove(this.domNode, this.baseClass);\n\t\t\tthis.isClosed = true;\n\t\t\tthis.isLoaded = false;\n\n\t\t\tdelete this.editNode;\n\t\t\tdelete this.focusNode;\n\n\t\t\tif(this.window && this.window._frameElement){\n\t\t\t\tthis.window._frameElement = null;\n\t\t\t}\n\n\t\t\tthis.window = null;\n\t\t\tthis.document = null;\n\t\t\tthis.editingArea = null;\n\t\t\tthis.editorObject = null;\n\t\t},\n\n\t\tdestroy: function(){\n\t\t\tif(!this.isClosed){\n\t\t\t\tthis.close(false);\n\t\t\t}\n\t\t\tif(this._updateTimer){\n\t\t\t\tthis._updateTimer.remove();\n\t\t\t}\n\t\t\tthis.inherited(arguments);\n\t\t\tif(RichText._globalSaveHandler){\n\t\t\t\tdelete RichText._globalSaveHandler[this.id];\n\t\t\t}\n\t\t},\n\n\t\t_removeMozBogus: function(/* String */ html){\n\t\t\t// summary:\n\t\t\t//\t\tPost filter to remove unwanted HTML attributes generated by mozilla\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\treturn html.replace(/\\stype=\"_moz\"/gi, '').replace(/\\s_moz_dirty=\"\"/gi, '').replace(/_moz_resizing=\"(true|false)\"/gi, ''); // String\n\t\t},\n\t\t_removeWebkitBogus: function(/* String */ html){\n\t\t\t// summary:\n\t\t\t//\t\tPost filter to remove unwanted HTML attributes generated by webkit\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\thtml = html.replace(/\\sclass=\"webkit-block-placeholder\"/gi, '');\n\t\t\thtml = html.replace(/\\sclass=\"apple-style-span\"/gi, '');\n\t\t\t// For some reason copy/paste sometime adds extra meta tags for charset on\n\t\t\t// webkit (chrome) on mac.They need to be removed.  See: #12007\"\n\t\t\thtml = html.replace(/<meta charset=\\\"utf-8\\\" \\/>/gi, '');\n\t\t\treturn html; // String\n\t\t},\n\t\t_normalizeFontStyle: function(/* String */ html){\n\t\t\t// summary:\n\t\t\t//\t\tConvert 'strong' and 'em' to 'b' and 'i'.\n\t\t\t// description:\n\t\t\t//\t\tMoz can not handle strong/em tags correctly, so to help\n\t\t\t//\t\tmozilla and also to normalize output, convert them to 'b' and 'i'.\n\t\t\t//\n\t\t\t//\t\tNote the IE generates 'strong' and 'em' rather than 'b' and 'i'\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\treturn html.replace(/<(\\/)?strong([ \\>])/gi, '<$1b$2')\n\t\t\t\t.replace(/<(\\/)?em([ \\>])/gi, '<$1i$2'); // String\n\t\t},\n\n\t\t_preFixUrlAttributes: function(/* String */ html){\n\t\t\t// summary:\n\t\t\t//\t\tPre-filter to do fixing to href attributes on `<a>` and `<img>` tags\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\treturn html.replace(/(?:(<a(?=\\s).*?\\shref=)(\"|')(.*?)\\2)|(?:(<a\\s.*?href=)([^\"'][^ >]+))/gi,\n\t\t\t\t'$1$4$2$3$5$2 _djrealurl=$2$3$5$2')\n\t\t\t\t.replace(/(?:(<img(?=\\s).*?\\ssrc=)(\"|')(.*?)\\2)|(?:(<img\\s.*?src=)([^\"'][^ >]+))/gi,\n\t\t\t\t'$1$4$2$3$5$2 _djrealurl=$2$3$5$2'); // String\n\t\t},\n\n\t\t/*****************************************************************************\n\t\t The following functions implement HTML manipulation commands for various\n\t\t browser/contentEditable implementations.  The goal of them is to enforce\n\t\t standard behaviors of them.\n\t\t ******************************************************************************/\n\n\t\t/*** queryCommandEnabled implementations ***/\n\n\t\t_browserQueryCommandEnabled: function(command){\n\t\t\t// summary:\n\t\t\t//\t\tImplementation to call to the native queryCommandEnabled of the browser.\n\t\t\t// command:\n\t\t\t//\t\tThe command to check.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(!command){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar elem = has(\"ie\") < 9 ? this.document.selection.createRange() : this.document;\n\t\t\ttry{\n\t\t\t\treturn elem.queryCommandEnabled(command);\n\t\t\t}catch(e){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\t_createlinkEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the test for if the create link\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"opera\")){\n\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\tif(sel.isCollapsed){\n\t\t\t\t\tenabled = true;\n\t\t\t\t}else{\n\t\t\t\t\tenabled = this.document.queryCommandEnabled(\"createlink\");\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"createlink\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t_unlinkEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the test for if the unlink\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"mozilla\") || has(\"webkit\")){\n\t\t\t\tenabled = this.selection.hasAncestorElement(\"a\");\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"unlink\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t_inserttableEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the test for if the inserttable\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"mozilla\") || has(\"webkit\")){\n\t\t\t\tenabled = true;\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"inserttable\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t_cutEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the test for if the cut\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"webkit\")){\n\t\t\t\t// WebKit deems clipboard activity as a security threat and natively would return false\n\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\tif(sel){\n\t\t\t\t\tsel = sel.toString();\n\t\t\t\t}\n\t\t\t\tenabled = !!sel;\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"cut\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t_copyEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the test for if the copy\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"webkit\")){\n\t\t\t\t// WebKit deems clipboard activity as a security threat and natively would return false\n\t\t\t\tvar sel = this.window.getSelection();\n\t\t\t\tif(sel){\n\t\t\t\t\tsel = sel.toString();\n\t\t\t\t}\n\t\t\t\tenabled = !!sel;\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"copy\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t_pasteEnabledImpl: function(/*===== argument =====*/){\n\t\t\t// summary:c\n\t\t\t//\t\tThis function implements the test for if the paste\n\t\t\t//\t\tcommand should be enabled or not.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar enabled = true;\n\t\t\tif(has(\"webkit\")){\n\t\t\t\treturn true;\n\t\t\t}else{\n\t\t\t\tenabled = this._browserQueryCommandEnabled(\"paste\");\n\t\t\t}\n\t\t\treturn enabled;\n\t\t},\n\n\t\t/*** execCommand implementations ***/\n\n\t\t_inserthorizontalruleImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the insertion of HTML 'HR' tags.\n\t\t\t//\t\tinto a point on the page.  IE doesn't to it right, so\n\t\t\t//\t\twe have to use an alternate form\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(has(\"ie\")){\n\t\t\t\treturn this._inserthtmlImpl(\"<hr>\");\n\t\t\t}\n\t\t\treturn this.document.execCommand(\"inserthorizontalrule\", false, argument);\n\t\t},\n\n\t\t_unlinkImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the unlink of an 'a' tag.\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif((this.queryCommandEnabled(\"unlink\")) && (has(\"mozilla\") || has(\"webkit\"))){\n\t\t\t\tvar a = this.selection.getAncestorElement(\"a\");\n\t\t\t\tthis.selection.selectElement(a);\n\t\t\t\treturn this.document.execCommand(\"unlink\", false, null);\n\t\t\t}\n\t\t\treturn this.document.execCommand(\"unlink\", false, argument);\n\t\t},\n\n\t\t_hilitecolorImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the hilitecolor command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar returnValue;\n\t\t\tvar isApplied = this._handleTextColorOrProperties(\"hilitecolor\", argument);\n\t\t\tif(!isApplied){\n\t\t\t\tif(has(\"mozilla\")){\n\t\t\t\t\t// mozilla doesn't support hilitecolor properly when useCSS is\n\t\t\t\t\t// set to false (bugzilla #279330)\n\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, true);\n\t\t\t\t\tconsole.log(\"Executing color command.\");\n\t\t\t\t\treturnValue = this.document.execCommand(\"hilitecolor\", false, argument);\n\t\t\t\t\tthis.document.execCommand(\"styleWithCSS\", false, false);\n\t\t\t\t}else{\n\t\t\t\t\treturnValue = this.document.execCommand(\"hilitecolor\", false, argument);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn returnValue;\n\t\t},\n\n\t\t_backcolorImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the backcolor command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(has(\"ie\")){\n\t\t\t\t// Tested under IE 6 XP2, no problem here, comment out\n\t\t\t\t// IE weirdly collapses ranges when we exec these commands, so prevent it\n\t\t\t\t//\tvar tr = this.document.selection.createRange();\n\t\t\t\targument = argument ? argument : null;\n\t\t\t}\n\t\t\tvar isApplied = this._handleTextColorOrProperties(\"backcolor\", argument);\n\t\t\tif(!isApplied){\n\t\t\t\tisApplied = this.document.execCommand(\"backcolor\", false, argument);\n\t\t\t}\n\t\t\treturn isApplied;\n\t\t},\n\n\t\t_forecolorImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the forecolor command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tif(has(\"ie\")){\n\t\t\t\t// Tested under IE 6 XP2, no problem here, comment out\n\t\t\t\t// IE weirdly collapses ranges when we exec these commands, so prevent it\n\t\t\t\t//\tvar tr = this.document.selection.createRange();\n\t\t\t\targument = argument ? argument : null;\n\t\t\t}\n\t\t\tvar isApplied = false;\n\t\t\tisApplied = this._handleTextColorOrProperties(\"forecolor\", argument);\n\t\t\tif(!isApplied){\n\t\t\t\tisApplied = this.document.execCommand(\"forecolor\", false, argument);\n\t\t\t}\n\t\t\treturn isApplied;\n\t\t},\n\n\t\t_inserthtmlImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the insertion of HTML content into\n\t\t\t//\t\ta point on the page.\n\t\t\t// argument:\n\t\t\t//\t\tThe content to insert, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\targument = this._preFilterContent(argument);\n\t\t\tvar rv = true;\n\t\t\tif(has(\"ie\") < 9){\n\t\t\t\tvar insertRange = this.document.selection.createRange();\n\t\t\t\tif(this.document.selection.type.toUpperCase() === 'CONTROL'){\n\t\t\t\t\tvar n = insertRange.item(0);\n\t\t\t\t\twhile(insertRange.length){\n\t\t\t\t\t\tinsertRange.remove(insertRange.item(0));\n\t\t\t\t\t}\n\t\t\t\t\tn.outerHTML = argument;\n\t\t\t\t}else{\n\t\t\t\t\tinsertRange.pasteHTML(argument);\n\t\t\t\t}\n\t\t\t\tinsertRange.select();\n\t\t\t}else if(has(\"trident\") < 8){\n\t\t\t\tvar insertRange;\n\t\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\t\tif(selection && selection.rangeCount && selection.getRangeAt){\n\t\t\t\t\tinsertRange = selection.getRangeAt(0);\n\t\t\t\t\tinsertRange.deleteContents();\n\n\t\t\t\t\tvar div = domConstruct.create('div');\n\t\t\t\t\tdiv.innerHTML = argument;\n\t\t\t\t\tvar node, lastNode;\n\t\t\t\t\tvar n = this.document.createDocumentFragment();\n\t\t\t\t\twhile((node = div.firstChild)){\n\t\t\t\t\t\tlastNode = n.appendChild(node);\n\t\t\t\t\t}\n\t\t\t\t\tinsertRange.insertNode(n);\n\t\t\t\t\tif(lastNode) {\n\t\t\t\t\t\tinsertRange = insertRange.cloneRange();\n\t\t\t\t\t\tinsertRange.setStartAfter(lastNode);\n\t\t\t\t\t\tinsertRange.collapse(false);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(insertRange);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(has(\"mozilla\") && !argument.length){\n\t\t\t\t//mozilla can not inserthtml an empty html to delete current selection\n\t\t\t\t//so we delete the selection instead in this case\n\t\t\t\tthis.selection.remove(); // FIXME\n\t\t\t}else{\n\t\t\t\trv = this.document.execCommand(\"inserthtml\", false, argument);\n\t\t\t}\n\t\t\treturn rv;\n\t\t},\n\n\t\t_boldImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the bold command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"bold\");\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"bold\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_italicImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the italic command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"italic\");\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"italic\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_underlineImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the underline command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"underline\");\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"underline\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_strikethroughImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the strikethrough command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"strikethrough\");\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"strikethrough\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_superscriptImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the superscript command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"superscript\");\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"superscript\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_subscriptImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements an over-ride of the superscript command.\n\t\t\t// argument:\n\t\t\t//\t\tNot used, operates by selection.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tthis._adaptIESelection();\n\t\t\t\tapplied = this._adaptIEFormatAreaAndExec(\"subscript\");\n\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"subscript\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_fontnameImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the fontname command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar isApplied;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tisApplied = this._handleTextColorOrProperties(\"fontname\", argument);\n\t\t\t}\n\t\t\tif(!isApplied){\n\t\t\t\tisApplied = this.document.execCommand(\"fontname\", false, argument);\n\t\t\t}\n\t\t\treturn isApplied;\n\t\t},\n\n\t\t_fontsizeImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the fontsize command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar isApplied;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tisApplied = this._handleTextColorOrProperties(\"fontsize\", argument);\n\t\t\t}\n\t\t\tif(!isApplied){\n\t\t\t\tisApplied = this.document.execCommand(\"fontsize\", false, argument);\n\t\t\t}\n\t\t\treturn isApplied;\n\t\t},\n\n\t\t_insertorderedlistImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the insertorderedlist command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tapplied = this._adaptIEList(\"insertorderedlist\", argument);\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"insertorderedlist\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\t_insertunorderedlistImpl: function(argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function implements the insertunorderedlist command\n\t\t\t// argument:\n\t\t\t//\t\targuments to the exec command, if any.\n\t\t\t// tags:\n\t\t\t//\t\tprotected\n\t\t\tvar applied = false;\n\t\t\tif(has(\"ie\")){\n\t\t\t\tapplied = this._adaptIEList(\"insertunorderedlist\", argument);\n\t\t\t}\n\t\t\tif(!applied){\n\t\t\t\tapplied = this.document.execCommand(\"insertunorderedlist\", false, argument);\n\t\t\t}\n\t\t\treturn applied;\n\t\t},\n\n\t\tgetHeaderHeight: function(){\n\t\t\t// summary:\n\t\t\t//\t\tA function for obtaining the height of the header node\n\t\t\treturn this._getNodeChildrenHeight(this.header); // Number\n\t\t},\n\n\t\tgetFooterHeight: function(){\n\t\t\t// summary:\n\t\t\t//\t\tA function for obtaining the height of the footer node\n\t\t\treturn this._getNodeChildrenHeight(this.footer); // Number\n\t\t},\n\n\t\t_getNodeChildrenHeight: function(node){\n\t\t\t// summary:\n\t\t\t//\t\tAn internal function for computing the cumulative height of all child nodes of 'node'\n\t\t\t// node:\n\t\t\t//\t\tThe node to process the children of;\n\t\t\tvar h = 0;\n\t\t\tif(node && node.childNodes){\n\t\t\t\t// IE didn't compute it right when position was obtained on the node directly is some cases,\n\t\t\t\t// so we have to walk over all the children manually.\n\t\t\t\tvar i;\n\t\t\t\tfor(i = 0; i < node.childNodes.length; i++){\n\t\t\t\t\tvar size = domGeometry.position(node.childNodes[i]);\n\t\t\t\t\th += size.h;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn h; // Number\n\t\t},\n\n\t\t_isNodeEmpty: function(node, startOffset){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to test if a node is devoid of real content.\n\t\t\t// node:\n\t\t\t//\t\tThe node to check.\n\t\t\t// tags:\n\t\t\t//\t\tprivate.\n\t\t\tif(node.nodeType === 1/*element*/){\n\t\t\t\tif(node.childNodes.length > 0){\n\t\t\t\t\treturn this._isNodeEmpty(node.childNodes[0], startOffset);\t// huh?   why test just first child?\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}else if(node.nodeType === 3/*text*/){\n\t\t\t\treturn (node.nodeValue.substring(startOffset) === \"\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t_removeStartingRangeFromRange: function(node, range){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to adjust selection range by removing the current\n\t\t\t//\t\tstart node.\n\t\t\t// node:\n\t\t\t//\t\tThe node to remove from the starting range.\n\t\t\t// range:\n\t\t\t//\t\tThe range to adapt.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(node.nextSibling){\n\t\t\t\trange.setStart(node.nextSibling, 0);\n\t\t\t}else{\n\t\t\t\tvar parent = node.parentNode;\n\t\t\t\twhile(parent && parent.nextSibling == null){\n\t\t\t\t\t//move up the tree until we find a parent that has another node, that node will be the next node\n\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t}\n\t\t\t\tif(parent){\n\t\t\t\t\trange.setStart(parent.nextSibling, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn range;\n\t\t},\n\n\t\t_adaptIESelection: function(){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to adapt the IE range by removing leading 'newlines'\n\t\t\t//\t\tNeeded to fix issue with bold/italics/underline not working if\n\t\t\t//\t\trange included leading 'newlines'.\n\t\t\t//\t\tIn IE, if a user starts a selection at the very end of a line,\n\t\t\t//\t\tthen the native browser commands will fail to execute correctly.\n\t\t\t//\t\tTo work around the issue,  we can remove all empty nodes from\n\t\t\t//\t\tthe start of the range selection.\n\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\tif(selection && selection.rangeCount && !selection.isCollapsed){\n\t\t\t\tvar range = selection.getRangeAt(0);\n\t\t\t\tvar firstNode = range.startContainer;\n\t\t\t\tvar startOffset = range.startOffset;\n\n\t\t\t\twhile(firstNode.nodeType === 3/*text*/ && startOffset >= firstNode.length && firstNode.nextSibling){\n\t\t\t\t\t//traverse the text nodes until we get to the one that is actually highlighted\n\t\t\t\t\tstartOffset = startOffset - firstNode.length;\n\t\t\t\t\tfirstNode = firstNode.nextSibling;\n\t\t\t\t}\n\n\t\t\t\t//Remove the starting ranges until the range does not start with an empty node.\n\t\t\t\tvar lastNode = null;\n\t\t\t\twhile(this._isNodeEmpty(firstNode, startOffset) && firstNode !== lastNode){\n\t\t\t\t\tlastNode = firstNode; //this will break the loop in case we can't find the next sibling\n\t\t\t\t\trange = this._removeStartingRangeFromRange(firstNode, range); //move the start container to the next node in the range\n\t\t\t\t\tfirstNode = range.startContainer;\n\t\t\t\t\tstartOffset = 0; //start at the beginning of the new starting range\n\t\t\t\t}\n\t\t\t\tselection.removeAllRanges();// this will work as long as users cannot select multiple ranges. I have not been able to do that in the editor.\n\t\t\t\tselection.addRange(range);\n\t\t\t}\n\t\t},\n\n\t\t_adaptIEFormatAreaAndExec: function(command){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to handle IE's quirkiness regarding how it handles\n\t\t\t//\t\tformat commands on a word.  This involves a lit of node splitting\n\t\t\t//\t\tand format cloning.\n\t\t\t// command:\n\t\t\t//\t\tThe format command, needed to check if the desired\n\t\t\t//\t\tcommand is true or not.\n\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\tvar doc = this.document;\n\t\t\tvar rs, ret, range, txt, startNode, endNode, breaker, sNode;\n\t\t\tif(command && selection && selection.isCollapsed){\n\t\t\t\tvar isApplied = this.queryCommandValue(command);\n\t\t\t\tif(isApplied){\n\n\t\t\t\t\t// We have to split backwards until we hit the format\n\t\t\t\t\tvar nNames = this._tagNamesForCommand(command);\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\tvar fs = range.startContainer;\n\t\t\t\t\tif(fs.nodeType === 3){\n\t\t\t\t\t\tvar offset = range.endOffset;\n\t\t\t\t\t\tif(fs.length < offset){\n\t\t\t\t\t\t\t//We are not looking from the right node, try to locate the correct one\n\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\tfs = ret.node;\n\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar topNode;\n\t\t\t\t\twhile(fs && fs !== this.editNode){\n\t\t\t\t\t\t// We have to walk back and see if this is still a format or not.\n\t\t\t\t\t\t// Hm, how do I do this?\n\t\t\t\t\t\tvar tName = fs.tagName ? fs.tagName.toLowerCase() : \"\";\n\t\t\t\t\t\tif(array.indexOf(nNames, tName) > -1){\n\t\t\t\t\t\t\ttopNode = fs;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfs = fs.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Okay, we have a stopping place, time to split things apart.\n\t\t\t\t\tif(topNode){\n\t\t\t\t\t\t// Okay, we know how far we have to split backwards, so we have to split now.\n\t\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\t\tvar newblock = doc.createElement(topNode.tagName);\n\t\t\t\t\t\tdomConstruct.place(newblock, topNode, \"after\");\n\t\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\t\tvar nodeToMove, tNode;\n\t\t\t\t\t\t\tvar endOffset = range.endOffset;\n\t\t\t\t\t\t\tif(rs.length < endOffset){\n\t\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, endOffset);\n\t\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\t\tendOffset = ret.offset;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, endOffset));\n\t\t\t\t\t\t\tvar endText = txt.substring(endOffset, txt.length);\n\t\t\t\t\t\t\tif(endText){\n\t\t\t\t\t\t\t\tendNode = doc.createTextNode(endText);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Place the split, then remove original nodes.\n\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"before\");\n\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\tdomConstruct.place(breaker, rs, \"after\");\n\t\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t\t\tendNode = breaker;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomConstruct.destroy(rs);\n\n\t\t\t\t\t\t\t// Okay, we split the text.  Now we need to see if we're\n\t\t\t\t\t\t\t// parented to the block element we're splitting and if\n\t\t\t\t\t\t\t// not, we have to split all the way up.  Ugh.\n\t\t\t\t\t\t\tvar parentC = startNode.parentNode;\n\t\t\t\t\t\t\tvar tagList = [];\n\t\t\t\t\t\t\tvar tagData;\n\t\t\t\t\t\t\twhile(parentC !== topNode){\n\t\t\t\t\t\t\t\tvar tg = parentC.tagName;\n\t\t\t\t\t\t\t\ttagData = {tagName: tg};\n\t\t\t\t\t\t\t\ttagList.push(tagData);\n\n\t\t\t\t\t\t\t\tvar newTg = doc.createElement(tg);\n\t\t\t\t\t\t\t\t// Clone over any 'style' data.\n\t\t\t\t\t\t\t\tif(parentC.style){\n\t\t\t\t\t\t\t\t\tif(newTg.style){\n\t\t\t\t\t\t\t\t\t\tif(parentC.style.cssText){\n\t\t\t\t\t\t\t\t\t\t\tnewTg.style.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\ttagData.cssText = parentC.style.cssText;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// If font also need to clone over any font data.\n\t\t\t\t\t\t\t\tif(parentC.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\tif(parentC.color){\n\t\t\t\t\t\t\t\t\t\tnewTg.color = parentC.color;\n\t\t\t\t\t\t\t\t\t\ttagData.color = parentC.color;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(parentC.face){\n\t\t\t\t\t\t\t\t\t\tnewTg.face = parentC.face;\n\t\t\t\t\t\t\t\t\t\ttagData.face = parentC.face;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(parentC.size){  // this check was necessary on IE\n\t\t\t\t\t\t\t\t\t\tnewTg.size = parentC.size;\n\t\t\t\t\t\t\t\t\t\ttagData.size = parentC.size;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(parentC.className){\n\t\t\t\t\t\t\t\t\tnewTg.className = parentC.className;\n\t\t\t\t\t\t\t\t\ttagData.className = parentC.className;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Now move end node and every sibling\n\t\t\t\t\t\t\t\t// after it over into the new tag.\n\t\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\t\t\t\tnewTg.appendChild(nodeToMove);\n\t\t\t\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(newTg.tagName == parentC.tagName){\n\t\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\t\tdomConstruct.place(breaker, parentC, \"after\");\n\t\t\t\t\t\t\t\t\tdomConstruct.place(newTg, breaker, \"after\");\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tdomConstruct.place(newTg, parentC, \"after\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstartNode = parentC;\n\t\t\t\t\t\t\t\tendNode = newTg;\n\t\t\t\t\t\t\t\tparentC = parentC.parentNode;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Lastly, move the split out all the split tags\n\t\t\t\t\t\t\t// to the new block as they should now be split properly.\n\t\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\t\tnodeToMove = endNode;\n\t\t\t\t\t\t\t\tif(nodeToMove.nodeType === 1 || (nodeToMove.nodeType === 3 && nodeToMove.nodeValue)){\n\t\t\t\t\t\t\t\t\t// Non-blank text and non-text nodes need to clear out that blank space\n\t\t\t\t\t\t\t\t\t// before moving the contents.\n\t\t\t\t\t\t\t\t\tnewblock.innerHTML = \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twhile(nodeToMove){\n\t\t\t\t\t\t\t\t\ttNode = nodeToMove.nextSibling;\n\t\t\t\t\t\t\t\t\tnewblock.appendChild(nodeToMove);\n\t\t\t\t\t\t\t\t\tnodeToMove = tNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// We had intermediate tags, we have to now recreate them inbetween the split\n\t\t\t\t\t\t\t// and restore what styles, classnames, etc, we can.\n\t\t\t\t\t\t\tvar newrange;\n\t\t\t\t\t\t\tif(tagList.length){\n\t\t\t\t\t\t\t\ttagData = tagList.pop();\n\t\t\t\t\t\t\t\tvar newContTag = doc.createElement(tagData.tagName);\n\t\t\t\t\t\t\t\tif(tagData.cssText && newContTag.style){\n\t\t\t\t\t\t\t\t\tnewContTag.style.cssText = tagData.cssText;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(tagData.className){\n\t\t\t\t\t\t\t\t\tnewContTag.className = tagData.className;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(tagData.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\tif(tagData.color){\n\t\t\t\t\t\t\t\t\t\tnewContTag.color = tagData.color;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.face){\n\t\t\t\t\t\t\t\t\t\tnewContTag.face = tagData.face;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.size){\n\t\t\t\t\t\t\t\t\t\tnewContTag.size = tagData.size;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomConstruct.place(newContTag, newblock, \"before\");\n\t\t\t\t\t\t\t\twhile(tagList.length){\n\t\t\t\t\t\t\t\t\ttagData = tagList.pop();\n\t\t\t\t\t\t\t\t\tvar newTgNode = doc.createElement(tagData.tagName);\n\t\t\t\t\t\t\t\t\tif(tagData.cssText && newTgNode.style){\n\t\t\t\t\t\t\t\t\t\tnewTgNode.style.cssText = tagData.cssText;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.className){\n\t\t\t\t\t\t\t\t\t\tnewTgNode.className = tagData.className;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(tagData.tagName === \"FONT\"){\n\t\t\t\t\t\t\t\t\t\tif(tagData.color){\n\t\t\t\t\t\t\t\t\t\t\tnewTgNode.color = tagData.color;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.face){\n\t\t\t\t\t\t\t\t\t\t\tnewTgNode.face = tagData.face;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(tagData.size){\n\t\t\t\t\t\t\t\t\t\t\tnewTgNode.size = tagData.size;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnewContTag.appendChild(newTgNode);\n\t\t\t\t\t\t\t\t\tnewContTag = newTgNode;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Okay, everything is theoretically split apart and removed from the content\n\t\t\t\t\t\t\t\t// so insert the dummy text to select, select it, then\n\t\t\t\t\t\t\t\t// clear to position cursor.\n\t\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\t\tnewContTag.appendChild(sNode);\n\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t// No extra tags, so we have to insert a breaker point and rely\n\t\t\t\t\t\t\t\t// on filters to remove it later.\n\t\t\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\t\t\tbreaker.className = \"ieFormatBreakerSpan\";\n\t\t\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t\t\tdomConstruct.place(breaker, newblock, \"before\");\n\t\t\t\t\t\t\t\tnewrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(!newblock.firstChild){\n\t\t\t\t\t\t\t\t// Empty, we don't need it.  Split was at end or similar\n\t\t\t\t\t\t\t\t// So, remove it.\n\t\t\t\t\t\t\t\tdomConstruct.destroy(newblock);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}else{\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\tvar endText = txt.substring(offset);\n\t\t\t\t\t\tif(endText !== \"\"){\n\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomConstruct.place(breaker, startNode, \"after\");\n\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\tdoc.execCommand(command);\n\t\t\t\t\t\tdomConstruct.place(breaker.firstChild, breaker, \"before\");\n\t\t\t\t\t\tdomConstruct.destroy(breaker);\n\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\tsNode.parentNode.innerHTML = \"\";\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\t_adaptIEList: function(command /*===== , argument =====*/){\n\t\t\t// summary:\n\t\t\t//\t\tThis function handles normalizing the IE list behavior as\n\t\t\t//\t\tmuch as possible.\n\t\t\t// command:\n\t\t\t//\t\tThe list command to execute.\n\t\t\t// argument:\n\t\t\t//\t\tAny additional argument.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\tif(selection.isCollapsed){\n\t\t\t\t// In the case of no selection, lets commonize the behavior and\n\t\t\t\t// make sure that it indents if needed.\n\t\t\t\tif(selection.rangeCount && !this.queryCommandValue(command)){\n\t\t\t\t\tvar range = selection.getRangeAt(0);\n\t\t\t\t\tvar sc = range.startContainer;\n\t\t\t\t\tif(sc && sc.nodeType == 3){\n\t\t\t\t\t\t// text node.  Lets see if there is a node before it that isn't\n\t\t\t\t\t\t// some sort of breaker.\n\t\t\t\t\t\tif(!range.startOffset){\n\t\t\t\t\t\t\t// We're at the beginning of a text area.  It may have been br split\n\t\t\t\t\t\t\t// Who knows?  In any event, we must create the list manually\n\t\t\t\t\t\t\t// or IE may shove too much into the list element.  It seems to\n\t\t\t\t\t\t\t// grab content before the text node too if it's br split.\n\t\t\t\t\t\t\t// Why can't IE work like everyone else?\n\n\t\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\t\tvar lType = \"ul\";\n\t\t\t\t\t\t\tif(command === \"insertorderedlist\"){\n\t\t\t\t\t\t\t\tlType = \"ol\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar list = this.document.createElement(lType);\n\t\t\t\t\t\t\tvar li = domConstruct.create(\"li\", null, list);\n\t\t\t\t\t\t\tdomConstruct.place(list, sc, \"before\");\n\t\t\t\t\t\t\t// Move in the text node as part of the li.\n\t\t\t\t\t\t\tli.appendChild(sc);\n\t\t\t\t\t\t\t// We need a br after it or the enter key handler\n\t\t\t\t\t\t\t// sometimes throws errors.\n\t\t\t\t\t\t\tdomConstruct.create(\"br\", null, list, \"after\");\n\t\t\t\t\t\t\t// Okay, now lets move our cursor to the beginning.\n\t\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\t\tnewrange.setStart(sc, 0);\n\t\t\t\t\t\t\tnewrange.setEnd(sc, sc.length);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tthis.selection.collapse(true);\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t_handleTextColorOrProperties: function(command, argument){\n\t\t\t// summary:\n\t\t\t//\t\tThis function handles applying text color as best it is\n\t\t\t//\t\table to do so when the selection is collapsed, making the\n\t\t\t//\t\tbehavior cross-browser consistent. It also handles the name\n\t\t\t//\t\tand size for IE.\n\t\t\t// command:\n\t\t\t//\t\tThe command.\n\t\t\t// argument:\n\t\t\t//\t\tAny additional arguments.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tvar selection = rangeapi.getSelection(this.window);\n\t\t\tvar doc = this.document;\n\t\t\tvar rs, ret, range, txt, startNode, endNode, breaker, sNode;\n\t\t\targument = argument || null;\n\t\t\tif(command && selection && selection.isCollapsed){\n\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\trs = range.startContainer;\n\t\t\t\t\tif(rs && rs.nodeType === 3){\n\t\t\t\t\t\t// Text node, we have to split it.\n\t\t\t\t\t\tvar offset = range.startOffset;\n\t\t\t\t\t\tif(rs.length < offset){\n\t\t\t\t\t\t\t//We are not splitting the right node, try to locate the correct one\n\t\t\t\t\t\t\tret = this._adjustNodeAndOffset(rs, offset);\n\t\t\t\t\t\t\trs = ret.node;\n\t\t\t\t\t\t\toffset = ret.offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttxt = rs.nodeValue;\n\t\t\t\t\t\tstartNode = doc.createTextNode(txt.substring(0, offset));\n\t\t\t\t\t\tvar endText = txt.substring(offset);\n\t\t\t\t\t\tif(endText !== \"\"){\n\t\t\t\t\t\t\tendNode = doc.createTextNode(txt.substring(offset));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Create a space, we'll select and bold it, so\n\t\t\t\t\t\t// the whole word doesn't get bolded\n\t\t\t\t\t\tbreaker = doc.createElement(\"span\");\n\t\t\t\t\t\tsNode = doc.createTextNode(\".\");\n\t\t\t\t\t\tbreaker.appendChild(sNode);\n\t\t\t\t\t\t// Create a junk node to avoid it trying to style the breaker.\n\t\t\t\t\t\t// This will get destroyed later.\n\t\t\t\t\t\tvar extraSpan = doc.createElement(\"span\");\n\t\t\t\t\t\tbreaker.appendChild(extraSpan);\n\t\t\t\t\t\tif(startNode.length){\n\t\t\t\t\t\t\tdomConstruct.place(startNode, rs, \"after\");\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstartNode = rs;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomConstruct.place(breaker, startNode, \"after\");\n\t\t\t\t\t\tif(endNode){\n\t\t\t\t\t\t\tdomConstruct.place(endNode, breaker, \"after\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomConstruct.destroy(rs);\n\t\t\t\t\t\tvar newrange = rangeapi.create(this.window);\n\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\tif(has(\"webkit\")){\n\t\t\t\t\t\t\t// WebKit is frustrating with positioning the cursor.\n\t\t\t\t\t\t\t// It stinks to have a selected space, but there really\n\t\t\t\t\t\t\t// isn't much choice here.\n\t\t\t\t\t\t\tvar style = \"color\";\n\t\t\t\t\t\t\tif(command === \"hilitecolor\" || command === \"backcolor\"){\n\t\t\t\t\t\t\t\tstyle = \"backgroundColor\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomStyle.set(breaker, style, argument);\n\t\t\t\t\t\t\tthis.selection.remove();\n\t\t\t\t\t\t\tdomConstruct.destroy(extraSpan);\n\t\t\t\t\t\t\tbreaker.innerHTML = \"&#160;\";\t// &nbsp;\n\t\t\t\t\t\t\tthis.selection.selectElement(breaker);\n\t\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthis.execCommand(command, argument);\n\t\t\t\t\t\t\tdomConstruct.place(breaker.firstChild, breaker, \"before\");\n\t\t\t\t\t\t\tdomConstruct.destroy(breaker);\n\t\t\t\t\t\t\tnewrange.setStart(sNode, 0);\n\t\t\t\t\t\t\tnewrange.setEnd(sNode, sNode.length);\n\t\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\t\tselection.addRange(newrange);\n\t\t\t\t\t\t\tthis.selection.collapse(false);\n\t\t\t\t\t\t\tsNode.parentNode.removeChild(sNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t_adjustNodeAndOffset: function(/*DomNode*/node, /*Int*/offset){\n\t\t\t// summary:\n\t\t\t//\t\tIn the case there are multiple text nodes in a row the offset may not be within the node.\n\t\t\t//\t\tIf the offset is larger than the node length, it will attempt to find\n\t\t\t//\t\tthe next text sibling until it locates the text node in which the offset refers to\n\t\t\t// node:\n\t\t\t//\t\tThe node to check.\n\t\t\t// offset:\n\t\t\t//\t\tThe position to find within the text node\n\t\t\t// tags:\n\t\t\t//\t\tprivate.\n\t\t\twhile(node.length < offset && node.nextSibling && node.nextSibling.nodeType === 3){\n\t\t\t\t//Adjust the offset and node in the case of multiple text nodes in a row\n\t\t\t\toffset = offset - node.length;\n\t\t\t\tnode = node.nextSibling;\n\t\t\t}\n\t\t\treturn {\"node\": node, \"offset\": offset};\n\t\t},\n\n\t\t_tagNamesForCommand: function(command){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to return the tab names that are associated\n\t\t\t//\t\twith a particular style.\n\t\t\t// command: String\n\t\t\t//\t\tThe command to return tags for.\n\t\t\t// tags:\n\t\t\t//\t\tprivate\n\t\t\tif(command === \"bold\"){\n\t\t\t\treturn [\"b\", \"strong\"];\n\t\t\t}else if(command === \"italic\"){\n\t\t\t\treturn [\"i\", \"em\"];\n\t\t\t}else if(command === \"strikethrough\"){\n\t\t\t\treturn [\"s\", \"strike\"];\n\t\t\t}else if(command === \"superscript\"){\n\t\t\t\treturn [\"sup\"];\n\t\t\t}else if(command === \"subscript\"){\n\t\t\t\treturn [\"sub\"];\n\t\t\t}else if(command === \"underline\"){\n\t\t\t\treturn [\"u\"];\n\t\t\t}\n\t\t\treturn [];\n\t\t},\n\n\t\t_stripBreakerNodes: function(/*DOMNode*/ node){\n\t\t\t// summary:\n\t\t\t//\t\tFunction for stripping out the breaker spans inserted by the formatting command.\n\t\t\t//\t\tRegistered as a filter for IE, handles the breaker spans needed to fix up\n\t\t\t//\t\tHow bold/italic/etc, work when selection is collapsed (single cursor).\n\t\t\tif(!this.isLoaded){\n\t\t\t\treturn;\n\t\t\t} // this method requires init to be complete\n\t\t\tquery(\".ieFormatBreakerSpan\", node).forEach(function(b){\n\t\t\t\twhile(b.firstChild){\n\t\t\t\t\tdomConstruct.place(b.firstChild, b, \"before\");\n\t\t\t\t}\n\t\t\t\tdomConstruct.destroy(b);\n\t\t\t});\n\t\t\treturn node;\n\t\t},\n\n\t\t_stripTrailingEmptyNodes: function(/*DOMNode*/ node){\n\t\t\t// summary:\n\t\t\t//\t\tFunction for stripping trailing nodes without any text, excluding trailing nodes\n\t\t\t//\t\tlike <img> or <div><img></div>, even though they don't have text either.\n\n\t\t\tfunction isEmpty(node){\n\t\t\t\t// If not for old IE we could check for Element children by node.firstElementChild\n\t\t\t\treturn (/^(p|div|br)$/i.test(node.nodeName) && node.children.length == 0 &&\n\t\t\t\t\t/^[\\s\\xA0]*$/.test(node.textContent || node.innerText || \"\")) ||\n\t\t\t\t\t(node.nodeType === 3/*text*/ && /^[\\s\\xA0]*$/.test(node.nodeValue));\n\t\t\t}\n\t\t\twhile(node.lastChild && isEmpty(node.lastChild)){\n\t\t\t\tdomConstruct.destroy(node.lastChild);\n\t\t\t}\n\n\t\t\treturn node;\n\t\t},\n\n\t\t// Needed to support ToggleDir plugin.  Intentionally not inside if(has(\"dojo-bidi\")) block\n\t\t// so that (for backwards compatibility) ToggleDir plugin works even when has(\"dojo-bidi\") is falsy.\n\t\t_setTextDirAttr: function(/*String*/ value){\n\t\t\t// summary:\n\t\t\t//\t\tSets textDir attribute.  Sets direction of editNode accordingly.\n\t\t\tthis._set(\"textDir\", value);\n\t\t\tthis.onLoadDeferred.then(lang.hitch(this, function(){\n\t\t\t\tthis.editNode.dir = value;\n\t\t\t}));\n\t\t}\n\t});\n\n\treturn RichText;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/RichText.js\n// module id = 154\n// module chunks = 3","define([\"./kernel\", \"./lang\", \"../on\"], function(dojo, lang, on){\r\n\r\n// module:\r\n//\t\tdojo/unload\r\n\r\nvar win = window;\r\n\r\nvar unload = {\r\n\t// summary:\r\n\t//\t\tThis module contains the document and window unload detection API.\r\n\t//\t\tThis module is deprecated.  Use on(window, \"unload\", func)\r\n\t//\t\tand on(window, \"beforeunload\", func) instead.\r\n\r\n\taddOnWindowUnload: function(/*Object|Function?*/ obj, /*String|Function?*/ functionName){\r\n\t\t// summary:\r\n\t\t//\t\tRegisters a function to be triggered when window.onunload fires.\r\n\t\t//\t\tDeprecated, use on(window, \"unload\", lang.hitch(obj, functionName)) instead.\r\n\t\t// description:\r\n\t\t//\t\tThe first time that addOnWindowUnload is called Dojo\r\n\t\t//\t\twill register a page listener to trigger your unload\r\n\t\t//\t\thandler with. Note that registering these handlers may\r\n\t\t//\t\tdestroy \"fastback\" page caching in browsers that support\r\n\t\t//\t\tit. Be careful trying to modify the DOM or access\r\n\t\t//\t\tJavaScript properties during this phase of page unloading:\r\n\t\t//\t\tthey may not always be available. Consider\r\n\t\t//\t\taddOnUnload() if you need to modify the DOM or do\r\n\t\t//\t\theavy JavaScript work since it fires at the equivalent of\r\n\t\t//\t\tthe page's \"onbeforeunload\" event.\r\n\t\t// example:\r\n\t\t//\t|\tvar afunc = function() {console.log(\"global function\");};\r\n\t\t//\t|\trequire([\"dojo/_base/unload\"], function(unload) {\r\n\t\t//\t|\t\tvar foo = {bar: function(){ console.log(\"bar unloading...\");}, \r\n\t\t//\t|\t\t           data: \"mydata\"};\r\n\t\t//\t|\t\tunload.addOnWindowUnload(afunc);\r\n\t\t//\t|\t\tunload.addOnWindowUnload(foo, \"bar\");\r\n\t\t//\t|\t\tunload.addOnWindowUnload(foo, function(){console.log(\"\", this.data);});\r\n\t\t//\t|\t});\r\n\r\n\t\tif (!dojo.windowUnloaded){\r\n\t\t\ton(win, \"unload\", (dojo.windowUnloaded = function(){\r\n\t\t\t\t// summary:\r\n\t\t\t\t//\t\tsignal fired by impending window destruction. You may use\r\n\t\t\t\t//\t\tdojo.addOnWindowUnload() to register a listener for this\r\n\t\t\t\t//\t\tevent. NOTE: if you wish to dojo.connect() to this method\r\n\t\t\t\t//\t\tto perform page/application cleanup, be aware that this\r\n\t\t\t\t//\t\tevent WILL NOT fire if no handler has been registered with\r\n\t\t\t\t//\t\taddOnWindowUnload(). This behavior started in Dojo 1.3.\r\n\t\t\t\t//\t\tPrevious versions always triggered windowUnloaded(). See\r\n\t\t\t\t//\t\taddOnWindowUnload for more info.\r\n\t\t\t}));\r\n\t\t}\r\n\t\ton(win, \"unload\", lang.hitch(obj, functionName));\r\n\t},\r\n\r\n\taddOnUnload: function(/*Object?|Function?*/ obj, /*String|Function?*/ functionName){\r\n\t\t// summary:\r\n\t\t//\t\tRegisters a function to be triggered when the page unloads.\r\n\t\t//\t\tDeprecated, use on(window, \"beforeunload\", lang.hitch(obj, functionName)) instead.\r\n\t\t// description:\r\n\t\t//\t\tThe first time that addOnUnload is called Dojo will\r\n\t\t//\t\tregister a page listener to trigger your unload handler\r\n\t\t//\t\twith.\r\n\t\t//\r\n\t\t//\t\tIn a browser environment, the functions will be triggered\r\n\t\t//\t\tduring the window.onbeforeunload event. Be careful of doing\r\n\t\t//\t\ttoo much work in an unload handler. onbeforeunload can be\r\n\t\t//\t\ttriggered if a link to download a file is clicked, or if\r\n\t\t//\t\tthe link is a javascript: link. In these cases, the\r\n\t\t//\t\tonbeforeunload event fires, but the document is not\r\n\t\t//\t\tactually destroyed. So be careful about doing destructive\r\n\t\t//\t\toperations in a dojo.addOnUnload callback.\r\n\t\t//\r\n\t\t//\t\tFurther note that calling dojo.addOnUnload will prevent\r\n\t\t//\t\tbrowsers from using a \"fast back\" cache to make page\r\n\t\t//\t\tloading via back button instantaneous.\r\n\t\t// example:\r\n\t\t//\t|\tvar afunc = function() {console.log(\"global function\");};\r\n\t\t//\t|\trequire([\"dojo/_base/unload\"], function(unload) {\r\n\t\t//\t|\t\tvar foo = {bar: function(){ console.log(\"bar unloading...\");}, \r\n\t\t//\t|\t\t           data: \"mydata\"};\r\n\t\t//\t|\t\tunload.addOnUnload(afunc);\r\n\t\t//\t|\t\tunload.addOnUnload(foo, \"bar\");\r\n\t\t//\t|\t\tunload.addOnUnload(foo, function(){console.log(\"\", this.data);});\r\n\t\t//\t|\t});\r\n\r\n\t\ton(win, \"beforeunload\", lang.hitch(obj, functionName));\r\n\t}\r\n};\r\n\r\ndojo.addOnWindowUnload = unload.addOnWindowUnload;\r\ndojo.addOnUnload = unload.addOnUnload;\r\n\r\nreturn unload;\r\n\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dojo/_base/unload.js\n// module id = 155\n// module chunks = 3","define([\n\t\"dojo/_base/array\",\n\t\"dojo/dom\", // dom.byId\n\t\"dojo/_base/lang\",\n\t\"dojo/sniff\", // has(\"ie\") has(\"opera\")\n\t\"dojo/_base/window\",\n\t\"dijit/focus\"\n], function(array, dom, lang, has, baseWindow, focus){\n\n\t// module:\n\t//\t\tdijit/selection\n\n\t// Note that this class is using feature detection, but doesn't use has() because sometimes on IE the outer window\n\t// may be running in standards mode (ie, IE9 mode) but an iframe may be in compatibility mode.   So the code path\n\t// used will vary based on the window.\n\n\tvar SelectionManager = function(win){\n\t\t// summary:\n\t\t//\t\tClass for monitoring / changing the selection (typically highlighted text) in a given window\n\t\t// win: Window\n\t\t//\t\tThe window to monitor/adjust the selection on.\n\n\t\tvar doc = win.document;\n\n\t\tthis.getType = function(){\n\t\t\t// summary:\n\t\t\t//\t\tGet the selection type (like doc.select.type in IE).\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tvar stype = \"text\";\n\n\t\t\t\t// Check if the actual selection is a CONTROL (IMG, TABLE, HR, etc...).\n\t\t\t\tvar oSel;\n\t\t\t\ttry{\n\t\t\t\t\toSel = win.getSelection();\n\t\t\t\t}catch(e){ /*squelch*/ }\n\n\t\t\t\tif(oSel && oSel.rangeCount == 1){\n\t\t\t\t\tvar oRange = oSel.getRangeAt(0);\n\t\t\t\t\tif(\t(oRange.startContainer == oRange.endContainer) &&\n\t\t\t\t\t\t((oRange.endOffset - oRange.startOffset) == 1) &&\n\t\t\t\t\t\t(oRange.startContainer.nodeType != 3 /* text node*/)\n\t\t\t\t\t\t){\n\t\t\t\t\t\tstype = \"control\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn stype; //String\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\treturn doc.selection.type.toLowerCase();\n\t\t\t}\n\t\t};\n\n\t\tthis.getSelectedText = function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturn the text (no html tags) included in the current selection or null if no text is selected\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tvar selection = win.getSelection();\n\t\t\t\treturn selection ? selection.toString() : \"\"; //String\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\tif(this.getType() == 'control'){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn doc.selection.createRange().text;\n\t\t\t}\n\t\t};\n\n\t\tthis.getSelectedHtml = function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturn the html text of the current selection or null if unavailable\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tvar selection = win.getSelection();\n\t\t\t\tif(selection && selection.rangeCount){\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar html = \"\";\n\t\t\t\t\tfor(i = 0; i < selection.rangeCount; i++){\n\t\t\t\t\t\t//Handle selections spanning ranges, such as Opera\n\t\t\t\t\t\tvar frag = selection.getRangeAt(i).cloneContents();\n\t\t\t\t\t\tvar div = doc.createElement(\"div\");\n\t\t\t\t\t\tdiv.appendChild(frag);\n\t\t\t\t\t\thtml += div.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t\treturn html; //String\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\tif(this.getType() == 'control'){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn doc.selection.createRange().htmlText;\n\t\t\t}\n\t\t};\n\n\t\tthis.getSelectedElement = function(){\n\t\t\t// summary:\n\t\t\t//\t\tRetrieves the selected element (if any), just in the case that\n\t\t\t//\t\ta single element (object like and image or a table) is\n\t\t\t//\t\tselected.\n\t\t\tif(this.getType() == \"control\"){\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C path\n\t\t\t\t\tvar selection = win.getSelection();\n\t\t\t\t\treturn selection.anchorNode.childNodes[ selection.anchorOffset ];\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8\n\t\t\t\t\tvar range = doc.selection.createRange();\n\t\t\t\t\tif(range && range.item){\n\t\t\t\t\t\treturn doc.selection.createRange().item(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.getParentElement = function(){\n\t\t\t// summary:\n\t\t\t//\t\tGet the parent element of the current selection\n\t\t\tif(this.getType() == \"control\"){\n\t\t\t\tvar p = this.getSelectedElement();\n\t\t\t\tif(p){ return p.parentNode; }\n\t\t\t}else{\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\tvar selection = doc.getSelection();\n\t\t\t\t\tif(selection){\n\t\t\t\t\t\tvar node = selection.anchorNode;\n\t\t\t\t\t\twhile(node && (node.nodeType != 1)){ // not an element\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tvar r = doc.selection.createRange();\n\t\t\t\t\tr.collapse(true);\n\t\t\t\t\treturn r.parentElement();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.hasAncestorElement = function(/*String*/ tagName /* ... */){\n\t\t\t// summary:\n\t\t\t//\t\tCheck whether current selection has a  parent element which is\n\t\t\t//\t\tof type tagName (or one of the other specified tagName)\n\t\t\t// tagName: String\n\t\t\t//\t\tThe tag name to determine if it has an ancestor of.\n\t\t\treturn this.getAncestorElement.apply(this, arguments) != null; //Boolean\n\t\t};\n\n\t\tthis.getAncestorElement = function(/*String*/ tagName /* ... */){\n\t\t\t// summary:\n\t\t\t//\t\tReturn the parent element of the current selection which is of\n\t\t\t//\t\ttype tagName (or one of the other specified tagName)\n\t\t\t// tagName: String\n\t\t\t//\t\tThe tag name to determine if it has an ancestor of.\n\t\t\tvar node = this.getSelectedElement() || this.getParentElement();\n\t\t\treturn this.getParentOfType(node, arguments); //DOMNode\n\t\t};\n\n\t\tthis.isTag = function(/*DomNode*/ node, /*String[]*/ tags){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to determine if a node is one of an array of tags.\n\t\t\t// node:\n\t\t\t//\t\tThe node to inspect.\n\t\t\t// tags:\n\t\t\t//\t\tAn array of tag name strings to check to see if the node matches.\n\t\t\tif(node && node.tagName){\n\t\t\t\tvar _nlc = node.tagName.toLowerCase();\n\t\t\t\tfor(var i=0; i<tags.length; i++){\n\t\t\t\t\tvar _tlc = String(tags[i]).toLowerCase();\n\t\t\t\t\tif(_nlc == _tlc){\n\t\t\t\t\t\treturn _tlc; // String\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t};\n\n\t\tthis.getParentOfType = function(/*DomNode*/ node, /*String[]*/ tags){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to locate a parent node that matches one of a set of tags\n\t\t\t// node:\n\t\t\t//\t\tThe node to inspect.\n\t\t\t// tags:\n\t\t\t//\t\tAn array of tag name strings to check to see if the node matches.\n\t\t\twhile(node){\n\t\t\t\tif(this.isTag(node, tags).length){\n\t\t\t\t\treturn node; // DOMNode\n\t\t\t\t}\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.collapse = function(/*Boolean*/ beginning){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to collapse (clear), the current selection\n\t\t\t// beginning: Boolean\n\t\t\t//\t\tIndicates whether to collapse the cursor to the beginning of the selection or end.\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tvar selection = win.getSelection();\n\t\t\t\tif(selection.removeAllRanges){ // Mozilla\n\t\t\t\t\tif(beginning){\n\t\t\t\t\t\tselection.collapseToStart();\n\t\t\t\t\t}else{\n\t\t\t\t\t\tselection.collapseToEnd();\n\t\t\t\t\t}\n\t\t\t\t}else{ // Safari\n\t\t\t\t\t// pulled from WebCore/ecma/kjs_window.cpp, line 2536\n\t\t\t\t\tselection.collapse(beginning);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\tvar range = doc.selection.createRange();\n\t\t\t\trange.collapse(beginning);\n\t\t\t\trange.select();\n\t\t\t}\n\t\t};\n\n\t\tthis.remove = function(){\n\t\t\t// summary:\n\t\t\t//\t\tFunction to delete the currently selected content from the document.\n\t\t\tvar sel = doc.selection;\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tsel = win.getSelection();\n\t\t\t\tsel.deleteFromDocument();\n\t\t\t\treturn sel; //Selection\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\tif(sel.type.toLowerCase() != \"none\"){\n\t\t\t\t\tsel.clear();\n\t\t\t\t}\n\t\t\t\treturn sel; //Selection\n\t\t\t}\n\t\t};\n\n\t\tthis.selectElementChildren = function(/*DomNode*/ element, /*Boolean?*/ nochangefocus){\n\t\t\t// summary:\n\t\t\t//\t\tclear previous selection and select the content of the node\n\t\t\t//\t\t(excluding the node itself)\n\t\t\t// element: DOMNode\n\t\t\t//\t\tThe element you wish to select the children content of.\n\t\t\t// nochangefocus: Boolean\n\t\t\t//\t\tIndicates if the focus should change or not.\n\n\t\t\tvar range;\n\t\t\telement = dom.byId(element);\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C\n\t\t\t\tvar selection = win.getSelection();\n\t\t\t\tif(has(\"opera\")){\n\t\t\t\t\t//Opera's selectAllChildren doesn't seem to work right\n\t\t\t\t\t//against <body> nodes and possibly others ... so\n\t\t\t\t\t//we use the W3C range API\n\t\t\t\t\tif(selection.rangeCount){\n\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trange = doc.createRange();\n\t\t\t\t\t}\n\t\t\t\t\trange.setStart(element, 0);\n\t\t\t\t\trange.setEnd(element,(element.nodeType == 3) ? element.length : element.childNodes.length);\n\t\t\t\t\tselection.addRange(range);\n\t\t\t\t}else{\n\t\t\t\t\tselection.selectAllChildren(element);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\trange = element.ownerDocument.body.createTextRange();\n\t\t\t\trange.moveToElementText(element);\n\t\t\t\tif(!nochangefocus){\n\t\t\t\t\ttry{\n\t\t\t\t\t\trange.select(); // IE throws an exception here if the widget is hidden.  See #5439\n\t\t\t\t\t}catch(e){ /* squelch */}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.selectElement = function(/*DomNode*/ element, /*Boolean?*/ nochangefocus){\n\t\t\t// summary:\n\t\t\t//\t\tclear previous selection and select element (including all its children)\n\t\t\t// element: DOMNode\n\t\t\t//\t\tThe element to select.\n\t\t\t// nochangefocus: Boolean\n\t\t\t//\t\tBoolean indicating if the focus should be changed.  IE only.\n\t\t\tvar range;\n\t\t\telement = dom.byId(element);\t// TODO: remove for 2.0 or sooner, spec listed above doesn't allow for string\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C path\n\t\t\t\tvar selection = doc.getSelection();\n\t\t\t\trange = doc.createRange();\n\t\t\t\tif(selection.removeAllRanges){ // Mozilla\n\t\t\t\t\t// FIXME: does this work on Safari?\n\t\t\t\t\tif(has(\"opera\")){\n\t\t\t\t\t\t//Opera works if you use the current range on\n\t\t\t\t\t\t//the selection if present.\n\t\t\t\t\t\tif(selection.getRangeAt(0)){\n\t\t\t\t\t\t\trange = selection.getRangeAt(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.selectNode(element);\n\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\tselection.addRange(range);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// IE6-8\n\t\t\t\ttry{\n\t\t\t\t\tvar tg = element.tagName ? element.tagName.toLowerCase() : \"\";\n\t\t\t\t\tif(tg === \"img\" || tg === \"table\"){\n\t\t\t\t\t\trange = baseWindow.body(doc).createControlRange();\n\t\t\t\t\t}else{\n\t\t\t\t\t\trange = baseWindow.body(doc).createRange();\n\t\t\t\t\t}\n\t\t\t\t\trange.addElement(element);\n\t\t\t\t\tif(!nochangefocus){\n\t\t\t\t\t\trange.select();\n\t\t\t\t\t}\n\t\t\t\t}catch(e){\n\t\t\t\t\tthis.selectElementChildren(element, nochangefocus);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.inSelection = function(node){\n\t\t\t// summary:\n\t\t\t//\t\tThis function determines if 'node' is\n\t\t\t//\t\tin the current selection.\n\t\t\t// tags:\n\t\t\t//\t\tpublic\n\t\t\tif(node){\n\t\t\t\tvar newRange;\n\t\t\t\tvar range;\n\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// WC3\n\t\t\t\t\tvar sel = win.getSelection();\n\t\t\t\t\tif(sel && sel.rangeCount > 0){\n\t\t\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\t\t}\n\t\t\t\t\tif(range && range.compareBoundaryPoints && doc.createRange){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\tnewRange = doc.createRange();\n\t\t\t\t\t\t\tnewRange.setStart(node, 0);\n\t\t\t\t\t\t\tif(range.compareBoundaryPoints(range.START_TO_END, newRange) === 1){\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}catch(e){ /* squelch */}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-8, so we can't use the range object as the pseudo\n\t\t\t\t\t// range doesn't implement the boundary checking, we have to\n\t\t\t\t\t// use IE specific crud.\n\t\t\t\t\trange = doc.selection.createRange();\n\t\t\t\t\ttry{\n\t\t\t\t\t\tnewRange = node.ownerDocument.body.createTextRange();\n\t\t\t\t\t\tnewRange.moveToElementText(node);\n\t\t\t\t\t}catch(e2){/* squelch */}\n\t\t\t\t\tif(range && newRange){\n\t\t\t\t\t\t// We can finally compare similar to W3C\n\t\t\t\t\t\tif(range.compareEndPoints(\"EndToStart\", newRange) === 1){\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false; // Boolean\n\t\t};\n\n\t\tthis.getBookmark = function(){\n\t\t\t// summary:\n\t\t\t//\t\tRetrieves a bookmark that can be used with moveToBookmark to reselect the currently selected range.\n\n\t\t\t// TODO: merge additional code from Editor._getBookmark into this method\n\n\t\t\tvar bm, rg, tg, sel = doc.selection, cf = focus.curNode;\n\n\t\t\tif(doc.getSelection){\n\t\t\t\t// W3C Range API for selections.\n\t\t\t\tsel = win.getSelection();\n\t\t\t\tif(sel){\n\t\t\t\t\tif(sel.isCollapsed){\n\t\t\t\t\t\ttg = cf? cf.tagName : \"\";\n\t\t\t\t\t\tif(tg){\n\t\t\t\t\t\t\t// Create a fake rangelike item to restore selections.\n\t\t\t\t\t\t\ttg = tg.toLowerCase();\n\t\t\t\t\t\t\tif(tg == \"textarea\" ||\n\t\t\t\t\t\t\t\t(tg == \"input\" && (!cf.type || cf.type.toLowerCase() == \"text\"))){\n\t\t\t\t\t\t\t\tsel = {\n\t\t\t\t\t\t\t\t\tstart: cf.selectionStart,\n\t\t\t\t\t\t\t\t\tend: cf.selectionEnd,\n\t\t\t\t\t\t\t\t\tnode: cf,\n\t\t\t\t\t\t\t\t\tpRange: true\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\treturn {isCollapsed: (sel.end <= sel.start), mark: sel}; //Object.\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbm = {isCollapsed:true};\n\t\t\t\t\t\tif(sel.rangeCount){\n\t\t\t\t\t\t\tbm.mark = sel.getRangeAt(0).cloneRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\trg = sel.getRangeAt(0);\n\t\t\t\t\t\tbm = {isCollapsed: false, mark: rg.cloneRange()};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if(sel){\n\t\t\t\t// If the current focus was a input of some sort and no selection, don't bother saving\n\t\t\t\t// a native bookmark.  This is because it causes issues with dialog/page selection restore.\n\t\t\t\t// So, we need to create pseudo bookmarks to work with.\n\t\t\t\ttg = cf ? cf.tagName : \"\";\n\t\t\t\ttg = tg.toLowerCase();\n\t\t\t\tif(cf && tg && (tg == \"button\" || tg == \"textarea\" || tg == \"input\")){\n\t\t\t\t\tif(sel.type && sel.type.toLowerCase() == \"none\"){\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tisCollapsed: true,\n\t\t\t\t\t\t\tmark: null\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\trg = sel.createRange();\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tisCollapsed: rg.text && rg.text.length?false:true,\n\t\t\t\t\t\t\tmark: {\n\t\t\t\t\t\t\t\trange: rg,\n\t\t\t\t\t\t\t\tpRange: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbm = {};\n\n\t\t\t\t//'IE' way for selections.\n\t\t\t\ttry{\n\t\t\t\t\t// createRange() throws exception when dojo in iframe\n\t\t\t\t\t// and nothing selected, see #9632\n\t\t\t\t\trg = sel.createRange();\n\t\t\t\t\tbm.isCollapsed = !(sel.type == 'Text' ? rg.htmlText.length : rg.length);\n\t\t\t\t}catch(e){\n\t\t\t\t\tbm.isCollapsed = true;\n\t\t\t\t\treturn bm;\n\t\t\t\t}\n\t\t\t\tif(sel.type.toUpperCase() == 'CONTROL'){\n\t\t\t\t\tif(rg.length){\n\t\t\t\t\t\tbm.mark=[];\n\t\t\t\t\t\tvar i=0,len=rg.length;\n\t\t\t\t\t\twhile(i<len){\n\t\t\t\t\t\t\tbm.mark.push(rg.item(i++));\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbm.isCollapsed = true;\n\t\t\t\t\t\tbm.mark = null;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tbm.mark = rg.getBookmark();\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tconsole.warn(\"No idea how to store the current selection for this browser!\");\n\t\t\t}\n\t\t\treturn bm; // Object\n\t\t};\n\n\t\tthis.moveToBookmark = function(/*Object*/ bookmark){\n\t\t\t// summary:\n\t\t\t//\t\tMoves current selection to a bookmark.\n\t\t\t// bookmark:\n\t\t\t//\t\tThis should be a returned object from getBookmark().\n\n\t\t\t// TODO: merge additional code from Editor._moveToBookmark into this method\n\n\t\t\tvar mark = bookmark.mark;\n\t\t\tif(mark){\n\t\t\t\tif(doc.getSelection){\n\t\t\t\t\t// W3C Range API (FF, WebKit, Opera, etc)\n\t\t\t\t\tvar sel = win.getSelection();\n\t\t\t\t\tif(sel && sel.removeAllRanges){\n\t\t\t\t\t\tif(mark.pRange){\n\t\t\t\t\t\t\tvar n = mark.node;\n\t\t\t\t\t\t\tn.selectionStart = mark.start;\n\t\t\t\t\t\t\tn.selectionEnd = mark.end;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\tsel.addRange(mark);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconsole.warn(\"No idea how to restore selection for this browser!\");\n\t\t\t\t\t}\n\t\t\t\t}else if(doc.selection && mark){\n\t\t\t\t\t//'IE' way.\n\t\t\t\t\tvar rg;\n\t\t\t\t\tif(mark.pRange){\n\t\t\t\t\t\trg = mark.range;\n\t\t\t\t\t}else if(lang.isArray(mark)){\n\t\t\t\t\t\trg = doc.body.createControlRange();\n\t\t\t\t\t\t//rg.addElement does not have call/apply method, so can not call it directly\n\t\t\t\t\t\t//rg is not available in \"range.addElement(item)\", so can't use that either\n\t\t\t\t\t\tarray.forEach(mark, function(n){\n\t\t\t\t\t\t\trg.addElement(n);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\trg = doc.body.createTextRange();\n\t\t\t\t\t\trg.moveToBookmark(mark);\n\t\t\t\t\t}\n\t\t\t\t\trg.select();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.isCollapsed = function(){\n\t\t\t// summary:\n\t\t\t//\t\tReturns true if there is no text selected\n\t\t\treturn this.getBookmark().isCollapsed;\n\t\t};\n\t};\n\n\t// singleton on the main window\n\tvar selection = new SelectionManager(window);\n\n\t// hook for editor to use class\n\tselection.SelectionManager = SelectionManager;\n\n\treturn selection;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/selection.js\n// module id = 156\n// module chunks = 3","define([\n\t\"dojo/_base/array\", // array.every\n\t\"dojo/_base/declare\", // declare\n\t\"dojo/_base/lang\" // lang.isArray\n], function(array, declare, lang){\n\n\t// module:\n\t//\t\tdijit/_editor/range\n\n\tvar rangeapi = {\n\t\t// summary:\n\t\t//\t\tW3C range API\n\n\t\tgetIndex: function(/*DomNode*/ node, /*DomNode*/ parent){\n\t\t\tvar ret = [], retR = [];\n\t\t\tvar onode = node;\n\n\t\t\tvar pnode, n;\n\t\t\twhile(node != parent){\n\t\t\t\tvar i = 0;\n\t\t\t\tpnode = node.parentNode;\n\t\t\t\twhile((n = pnode.childNodes[i++])){\n\t\t\t\t\tif(n === node){\n\t\t\t\t\t\t--i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//if(i>=pnode.childNodes.length){\n\t\t\t\t//console.debug(\"Error finding index of a node in dijit/range.getIndex()\");\n\t\t\t\t//}\n\t\t\t\tret.unshift(i);\n\t\t\t\tretR.unshift(i - pnode.childNodes.length);\n\t\t\t\tnode = pnode;\n\t\t\t}\n\n\t\t\t//normalized() can not be called so often to prevent\n\t\t\t//invalidating selection/range, so we have to detect\n\t\t\t//here that any text nodes in a row\n\t\t\tif(ret.length > 0 && onode.nodeType == 3){\n\t\t\t\tn = onode.previousSibling;\n\t\t\t\twhile(n && n.nodeType == 3){\n\t\t\t\t\tret[ret.length - 1]--;\n\t\t\t\t\tn = n.previousSibling;\n\t\t\t\t}\n\t\t\t\tn = onode.nextSibling;\n\t\t\t\twhile(n && n.nodeType == 3){\n\t\t\t\t\tretR[retR.length - 1]++;\n\t\t\t\t\tn = n.nextSibling;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {o: ret, r:retR};\n\t\t},\n\n\t\tgetNode: function(/*Array*/ index, /*DomNode*/ parent){\n\t\t\tif(!lang.isArray(index) || index.length == 0){\n\t\t\t\treturn parent;\n\t\t\t}\n\t\t\tvar node = parent;\n\t\t\t//\tif(!node)debugger\n\t\t\tarray.every(index, function(i){\n\t\t\t\tif(i >= 0 && i < node.childNodes.length){\n\t\t\t\t\tnode = node.childNodes[i];\n\t\t\t\t}else{\n\t\t\t\t\tnode = null;\n\t\t\t\t\t//console.debug('Error: can not find node with index',index,'under parent node',parent );\n\t\t\t\t\treturn false; //terminate array.every\n\t\t\t\t}\n\t\t\t\treturn true; //carry on the every loop\n\t\t\t});\n\n\t\t\treturn node;\n\t\t},\n\n\t\tgetCommonAncestor: function(n1, n2, root){\n\t\t\troot = root || n1.ownerDocument.body;\n\t\t\tvar getAncestors = function(n){\n\t\t\t\tvar as = [];\n\t\t\t\twhile(n){\n\t\t\t\t\tas.unshift(n);\n\t\t\t\t\tif(n !== root){\n\t\t\t\t\t\tn = n.parentNode;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn as;\n\t\t\t};\n\t\t\tvar n1as = getAncestors(n1);\n\t\t\tvar n2as = getAncestors(n2);\n\n\t\t\tvar m = Math.min(n1as.length, n2as.length);\n\t\t\tvar com = n1as[0]; //at least, one element should be in the array: the root (BODY by default)\n\t\t\tfor(var i = 1; i < m; i++){\n\t\t\t\tif(n1as[i] === n2as[i]){\n\t\t\t\t\tcom = n1as[i]\n\t\t\t\t}else{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn com;\n\t\t},\n\n\t\tgetAncestor: function(/*DomNode*/ node, /*RegEx?*/ regex, /*DomNode?*/ root){\n\t\t\troot = root || node.ownerDocument.body;\n\t\t\twhile(node && node !== root){\n\t\t\t\tvar name = node.nodeName.toUpperCase();\n\t\t\t\tif(regex.test(name)){\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tBlockTagNames: /^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,\n\n\t\tgetBlockAncestor: function(/*DomNode*/ node, /*RegEx?*/ regex, /*DomNode?*/ root){\n\t\t\troot = root || node.ownerDocument.body;\n\t\t\tregex = regex || rangeapi.BlockTagNames;\n\t\t\tvar block = null, blockContainer;\n\t\t\twhile(node && node !== root){\n\t\t\t\tvar name = node.nodeName.toUpperCase();\n\t\t\t\tif(!block && regex.test(name)){\n\t\t\t\t\tblock = node;\n\t\t\t\t}\n\t\t\t\tif(!blockContainer && (/^(?:BODY|TD|TH|CAPTION)$/).test(name)){\n\t\t\t\t\tblockContainer = node;\n\t\t\t\t}\n\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\treturn {blockNode:block, blockContainer:blockContainer || node.ownerDocument.body};\n\t\t},\n\n\t\tatBeginningOfContainer: function(/*DomNode*/ container, /*DomNode*/ node, /*Int*/ offset){\n\t\t\tvar atBeginning = false;\n\t\t\tvar offsetAtBeginning = (offset == 0);\n\t\t\tif(!offsetAtBeginning && node.nodeType == 3){ //if this is a text node, check whether the left part is all space\n\t\t\t\tif(/^[\\s\\xA0]+$/.test(node.nodeValue.substr(0, offset))){\n\t\t\t\t\toffsetAtBeginning = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(offsetAtBeginning){\n\t\t\t\tvar cnode = node;\n\t\t\t\tatBeginning = true;\n\t\t\t\twhile(cnode && cnode !== container){\n\t\t\t\t\tif(cnode.previousSibling){\n\t\t\t\t\t\tatBeginning = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcnode = cnode.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn atBeginning;\n\t\t},\n\n\t\tatEndOfContainer: function(/*DomNode*/ container, /*DomNode*/ node, /*Int*/ offset){\n\t\t\tvar atEnd = false;\n\t\t\tvar offsetAtEnd = (offset == (node.length || node.childNodes.length));\n\t\t\tif(!offsetAtEnd && node.nodeType == 3){ //if this is a text node, check whether the right part is all space\n\t\t\t\tif(/^[\\s\\xA0]+$/.test(node.nodeValue.substr(offset))){\n\t\t\t\t\toffsetAtEnd = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(offsetAtEnd){\n\t\t\t\tvar cnode = node;\n\t\t\t\tatEnd = true;\n\t\t\t\twhile(cnode && cnode !== container){\n\t\t\t\t\tif(cnode.nextSibling){\n\t\t\t\t\t\tatEnd = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcnode = cnode.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn atEnd;\n\t\t},\n\n\t\tadjacentNoneTextNode: function(startnode, next){\n\t\t\tvar node = startnode;\n\t\t\tvar len = (0 - startnode.length) || 0;\n\t\t\tvar prop = next ? 'nextSibling' : 'previousSibling';\n\t\t\twhile(node){\n\t\t\t\tif(node.nodeType != 3){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlen += node.length;\n\t\t\t\tnode = node[prop];\n\t\t\t}\n\t\t\treturn [node,len];\n\t\t},\n\n\t\tcreate: function(/*Window?*/ win){\t// TODO: for 2.0, replace optional window param w/mandatory window or document param\n\t\t\twin = win || window;\n\t\t\tif(win.getSelection){\n\t\t\t\treturn win.document.createRange();\n\t\t\t}else{//IE\n\t\t\t\treturn new W3CRange();\n\t\t\t}\n\t\t},\n\n\t\tgetSelection: function(/*Window*/ window, /*Boolean?*/ ignoreUpdate){\n\t\t\tif(window.getSelection){\n\t\t\t\treturn window.getSelection();\n\t\t\t}else{//IE\n\t\t\t\tvar s = new ie.selection(window);\n\t\t\t\tif(!ignoreUpdate){\n\t\t\t\t\ts._getCurrentSelection();\n\t\t\t\t}\n\t\t\t\treturn s;\n\t\t\t}\n\t\t}\n\t};\n\n\t// TODO: convert to has() test?   But remember IE9 issues with quirks vs. standards in main frame vs. iframe.\n\tif(!window.getSelection){\n\t\tvar ie = rangeapi.ie = {\n\t\t\tcachedSelection: {},\n\t\t\tselection: function(window){\n\t\t\t\tthis._ranges = [];\n\t\t\t\tthis.addRange = function(r, /*boolean*/ internal){\n\t\t\t\t\tthis._ranges.push(r);\n\t\t\t\t\tif(!internal){\n\t\t\t\t\t\tr._select();\n\t\t\t\t\t}\n\t\t\t\t\tthis.rangeCount = this._ranges.length;\n\t\t\t\t};\n\t\t\t\tthis.removeAllRanges = function(){\n\t\t\t\t\t//don't detach, the range may be used later\n\t\t\t\t\t//\t\t\t\tfor(var i=0;i<this._ranges.length;i++){\n\t\t\t\t\t//\t\t\t\t\tthis._ranges[i].detach();\n\t\t\t\t\t//\t\t\t\t}\n\t\t\t\t\tthis._ranges = [];\n\t\t\t\t\tthis.rangeCount = 0;\n\t\t\t\t};\n\t\t\t\tvar _initCurrentRange = function(){\n\t\t\t\t\tvar r = window.document.selection.createRange();\n\t\t\t\t\tvar type = window.document.selection.type.toUpperCase();\n\t\t\t\t\tif(type == \"CONTROL\"){\n\t\t\t\t\t\t//TODO: multiple range selection(?)\n\t\t\t\t\t\treturn new W3CRange(ie.decomposeControlRange(r));\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn new W3CRange(ie.decomposeTextRange(r));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.getRangeAt = function(i){\n\t\t\t\t\treturn this._ranges[i];\n\t\t\t\t};\n\t\t\t\tthis._getCurrentSelection = function(){\n\t\t\t\t\tthis.removeAllRanges();\n\t\t\t\t\tvar r = _initCurrentRange();\n\t\t\t\t\tif(r){\n\t\t\t\t\t\tthis.addRange(r, true);\n\t\t\t\t\t\tthis.isCollapsed = r.collapsed;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.isCollapsed = true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tdecomposeControlRange: function(range){\n\t\t\t\tvar firstnode = range.item(0), lastnode = range.item(range.length - 1);\n\t\t\t\tvar startContainer = firstnode.parentNode, endContainer = lastnode.parentNode;\n\t\t\t\tvar startOffset = rangeapi.getIndex(firstnode, startContainer).o[0];\n\t\t\t\tvar endOffset = rangeapi.getIndex(lastnode, endContainer).o[0] + 1;\n\t\t\t\treturn [startContainer, startOffset,endContainer, endOffset];\n\t\t\t},\n\t\t\tgetEndPoint: function(range, end){\n\t\t\t\tvar atmrange = range.duplicate();\n\t\t\t\tatmrange.collapse(!end);\n\t\t\t\tvar cmpstr = 'EndTo' + (end ? 'End' : 'Start');\n\t\t\t\tvar parentNode = atmrange.parentElement();\n\n\t\t\t\tvar startnode, startOffset, lastNode;\n\t\t\t\tif(parentNode.childNodes.length > 0){\n\t\t\t\t\tarray.every(parentNode.childNodes, function(node, i){\n\t\t\t\t\t\tvar calOffset;\n\t\t\t\t\t\tif(node.nodeType != 3){\n\t\t\t\t\t\t\tatmrange.moveToElementText(node);\n\n\t\t\t\t\t\t\tif(atmrange.compareEndPoints(cmpstr, range) > 0){\n\t\t\t\t\t\t\t\t//startnode = node.previousSibling;\n\t\t\t\t\t\t\t\tif(lastNode && lastNode.nodeType == 3){\n\t\t\t\t\t\t\t\t\t//where shall we put the start? in the text node or after?\n\t\t\t\t\t\t\t\t\tstartnode = lastNode;\n\t\t\t\t\t\t\t\t\tcalOffset = true;\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\t\t\t\t\tstartOffset = i;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tif(i == parentNode.childNodes.length - 1){\n\t\t\t\t\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\t\t\t\t\tstartOffset = parentNode.childNodes.length;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(i == parentNode.childNodes.length - 1){//at the end of this node\n\t\t\t\t\t\t\t\tstartnode = node;\n\t\t\t\t\t\t\t\tcalOffset = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//\t\t\ttry{\n\t\t\t\t\t\tif(calOffset && startnode){\n\t\t\t\t\t\t\tvar prevnode = rangeapi.adjacentNoneTextNode(startnode)[0];\n\t\t\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\t\t\tstartnode = prevnode.nextSibling;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tstartnode = parentNode.firstChild; //firstChild must be a text node\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar prevnodeobj = rangeapi.adjacentNoneTextNode(startnode);\n\t\t\t\t\t\t\tprevnode = prevnodeobj[0];\n\t\t\t\t\t\t\tvar lenoffset = prevnodeobj[1];\n\t\t\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\t\t\tatmrange.moveToElementText(prevnode);\n\t\t\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tatmrange.moveToElementText(parentNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tatmrange.setEndPoint(cmpstr, range);\n\t\t\t\t\t\t\tstartOffset = atmrange.text.length - lenoffset;\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//\t\t\t}catch(e){ debugger }\n\t\t\t\t\t\tlastNode = node;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tstartnode = parentNode;\n\t\t\t\t\tstartOffset = 0;\n\t\t\t\t}\n\n\t\t\t\t//if at the end of startnode and we are dealing with start container, then\n\t\t\t\t//move the startnode to nextSibling if it is a text node\n\t\t\t\t//TODO: do this for end container?\n\t\t\t\tif(!end && startnode.nodeType == 1 && startOffset == startnode.childNodes.length){\n\t\t\t\t\tvar nextnode = startnode.nextSibling;\n\t\t\t\t\tif(nextnode && nextnode.nodeType == 3){\n\t\t\t\t\t\tstartnode = nextnode;\n\t\t\t\t\t\tstartOffset = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn [startnode, startOffset];\n\t\t\t},\n\t\t\tsetEndPoint: function(range, container, offset){\n\t\t\t\t//text node\n\t\t\t\tvar atmrange = range.duplicate(), node, len;\n\t\t\t\tif(container.nodeType != 3){ //normal node\n\t\t\t\t\tif(offset > 0){\n\t\t\t\t\t\tnode = container.childNodes[offset - 1];\n\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\tif(node.nodeType == 3){\n\t\t\t\t\t\t\t\tcontainer = node;\n\t\t\t\t\t\t\t\toffset = node.length;\n\t\t\t\t\t\t\t\t//pass through\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tif(node.nextSibling && node.nextSibling.nodeType == 3){\n\t\t\t\t\t\t\t\t\tcontainer = node.nextSibling;\n\t\t\t\t\t\t\t\t\toffset = 0;\n\t\t\t\t\t\t\t\t\t//pass through\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tatmrange.moveToElementText(node.nextSibling ? node : container);\n\t\t\t\t\t\t\t\t\tvar parent = node.parentNode;\n\t\t\t\t\t\t\t\t\tvar tempNode = parent.insertBefore(node.ownerDocument.createTextNode(' '), node.nextSibling);\n\t\t\t\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t\t\t\tparent.removeChild(tempNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tatmrange.moveToElementText(container);\n\t\t\t\t\t\tatmrange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(container.nodeType == 3){\n\t\t\t\t\tvar prevnodeobj = rangeapi.adjacentNoneTextNode(container);\n\t\t\t\t\tvar prevnode = prevnodeobj[0];\n\t\t\t\t\tlen = prevnodeobj[1];\n\t\t\t\t\tif(prevnode){\n\t\t\t\t\t\tatmrange.moveToElementText(prevnode);\n\t\t\t\t\t\tatmrange.collapse(false);\n\t\t\t\t\t\t//if contentEditable is not inherit, the above collapse won't make the end point\n\t\t\t\t\t\t//in the correctly position: it always has a -1 offset, so compensate it\n\t\t\t\t\t\tif(prevnode.contentEditable != 'inherit'){\n\t\t\t\t\t\t\tlen++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tatmrange.moveToElementText(container.parentNode);\n\t\t\t\t\t\tatmrange.collapse(true);\n\n\t\t\t\t\t\t// Correct internal cursor position\n\t\t\t\t\t\t// http://bugs.dojotoolkit.org/ticket/15578\n\t\t\t\t\t\tatmrange.move('character', 1);\n\t\t\t\t\t\tatmrange.move('character', -1);\n\t\t\t\t\t}\n\n\t\t\t\t\toffset += len;\n\t\t\t\t\tif(offset > 0){\n\t\t\t\t\t\tif(atmrange.move('character', offset) != offset){\n\t\t\t\t\t\t\tconsole.error('Error when moving!');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn atmrange;\n\t\t\t},\n\t\t\tdecomposeTextRange: function(range){\n\t\t\t\tvar tmpary = ie.getEndPoint(range);\n\t\t\t\tvar startContainer = tmpary[0], startOffset = tmpary[1];\n\t\t\t\tvar endContainer = tmpary[0], endOffset = tmpary[1];\n\n\t\t\t\tif(range.htmlText.length){\n\t\t\t\t\tif(range.htmlText == range.text){ //in the same text node\n\t\t\t\t\t\tendOffset = startOffset + range.text.length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpary = ie.getEndPoint(range, true);\n\t\t\t\t\t\tendContainer = tmpary[0],endOffset = tmpary[1];\n\t\t\t\t\t\t//\t\t\t\t\tif(startContainer.tagName == \"BODY\"){\n\t\t\t\t\t\t//\t\t\t\t\t\tstartContainer = startContainer.firstChild;\n\t\t\t\t\t\t//\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn [startContainer, startOffset, endContainer, endOffset];\n\t\t\t},\n\t\t\tsetRange: function(range, startContainer, startOffset, endContainer, endOffset, collapsed){\n\t\t\t\tvar start = ie.setEndPoint(range, startContainer, startOffset);\n\n\t\t\t\trange.setEndPoint('StartToStart', start);\n\t\t\t\tif(!collapsed){\n\t\t\t\t\tvar end = ie.setEndPoint(range, endContainer, endOffset);\n\t\t\t\t}\n\t\t\t\trange.setEndPoint('EndToEnd', end || start);\n\n\t\t\t\treturn range;\n\t\t\t}\n\t\t};\n\n\t\tvar W3CRange = rangeapi.W3CRange = declare(null, {\n\t\t\tconstructor: function(){\n\t\t\t\tif(arguments.length>0){\n\t\t\t\t\tthis.setStart(arguments[0][0],arguments[0][1]);\n\t\t\t\t\tthis.setEnd(arguments[0][2],arguments[0][3]);\n\t\t\t\t}else{\n\t\t\t\t\tthis.commonAncestorContainer = null;\n\t\t\t\t\tthis.startContainer = null;\n\t\t\t\t\tthis.startOffset = 0;\n\t\t\t\t\tthis.endContainer = null;\n\t\t\t\t\tthis.endOffset = 0;\n\t\t\t\t\tthis.collapsed = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_updateInternal: function(){\n\t\t\t\tif(this.startContainer !== this.endContainer){\n\t\t\t\t\tthis.commonAncestorContainer = rangeapi.getCommonAncestor(this.startContainer, this.endContainer);\n\t\t\t\t}else{\n\t\t\t\t\tthis.commonAncestorContainer = this.startContainer;\n\t\t\t\t}\n\t\t\t\tthis.collapsed = (this.startContainer === this.endContainer) && (this.startOffset == this.endOffset);\n\t\t\t},\n\t\t\tsetStart: function(node, offset){\n\t\t\t\toffset=parseInt(offset);\n\t\t\t\tif(this.startContainer === node && this.startOffset == offset){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdelete this._cachedBookmark;\n\n\t\t\t\tthis.startContainer = node;\n\t\t\t\tthis.startOffset = offset;\n\t\t\t\tif(!this.endContainer){\n\t\t\t\t\tthis.setEnd(node, offset);\n\t\t\t\t}else{\n\t\t\t\t\tthis._updateInternal();\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetEnd: function(node, offset){\n\t\t\t\toffset=parseInt(offset);\n\t\t\t\tif(this.endContainer === node && this.endOffset == offset){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdelete this._cachedBookmark;\n\n\t\t\t\tthis.endContainer = node;\n\t\t\t\tthis.endOffset = offset;\n\t\t\t\tif(!this.startContainer){\n\t\t\t\t\tthis.setStart(node, offset);\n\t\t\t\t}else{\n\t\t\t\t\tthis._updateInternal();\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetStartAfter: function(node, offset){\n\t\t\t\tthis._setPoint('setStart', node, offset, 1);\n\t\t\t},\n\t\t\tsetStartBefore: function(node, offset){\n\t\t\t\tthis._setPoint('setStart', node, offset, 0);\n\t\t\t},\n\t\t\tsetEndAfter: function(node, offset){\n\t\t\t\tthis._setPoint('setEnd', node, offset, 1);\n\t\t\t},\n\t\t\tsetEndBefore: function(node, offset){\n\t\t\t\tthis._setPoint('setEnd', node, offset, 0);\n\t\t\t},\n\t\t\t_setPoint: function(what, node, offset, ext){\n\t\t\t\tvar index = rangeapi.getIndex(node, node.parentNode).o;\n\t\t\t\tthis[what](node.parentNode, index.pop()+ext);\n\t\t\t},\n\t\t\t_getIERange: function(){\n\t\t\t\tvar r = (this._body || this.endContainer.ownerDocument.body).createTextRange();\n\t\t\t\tie.setRange(r, this.startContainer, this.startOffset, this.endContainer, this.endOffset, this.collapsed);\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tgetBookmark: function(){\n\t\t\t\tthis._getIERange();\n\t\t\t\treturn this._cachedBookmark;\n\t\t\t},\n\t\t\t_select: function(){\n\t\t\t\tvar r = this._getIERange();\n\t\t\t\tr.select();\n\t\t\t},\n\t\t\tdeleteContents: function(){\n\t\t\t\tvar s = this.startContainer, r = this._getIERange();\n\t\t\t\tif(s.nodeType === 3 && !this.startOffset){\n\t\t\t\t\t//if the range starts at the beginning of a\n\t\t\t\t\t//text node, move it to before the textnode\n\t\t\t\t\t//to make sure the range is still valid\n\t\t\t\t\t//after deleteContents() finishes\n\t\t\t\t\tthis.setStartBefore(s);\n\t\t\t\t}\n\t\t\t\tr.pasteHTML('');\n\t\t\t\tthis.endContainer = this.startContainer;\n\t\t\t\tthis.endOffset = this.startOffset;\n\t\t\t\tthis.collapsed = true;\n\t\t\t},\n\t\t\tcloneRange: function(){\n\t\t\t\tvar r = new W3CRange([this.startContainer,this.startOffset,\n\t\t\t\t\tthis.endContainer,this.endOffset]);\n\t\t\t\tr._body = this._body;\n\t\t\t\treturn r;\n\t\t\t},\n\t\t\tdetach: function(){\n\t\t\t\tthis._body = null;\n\t\t\t\tthis.commonAncestorContainer = null;\n\t\t\t\tthis.startContainer = null;\n\t\t\t\tthis.startOffset = 0;\n\t\t\t\tthis.endContainer = null;\n\t\t\t\tthis.endOffset = 0;\n\t\t\t\tthis.collapsed = true;\n\t\t\t}\n\t\t});\n\t} //if(!window.getSelection)\n\n\t// remove for 2.0\n\tlang.setObject(\"dijit.range\", rangeapi);\n\n\treturn rangeapi;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/range.js\n// module id = 157\n// module chunks = 3","define([\n\t\"dojo/_base/array\",\n\t\"dojo/_base/lang\", // lang.setObject\n\t\"dojo/sniff\" // has(\"ie\")\n], function(array, lang, has){\n\n\t// module:\n\t//\t\tdijit/_editor/html\n\n\tvar exports = {\n\t\t// summary:\n\t\t//\t\tHTML serialization utility functions used by editor\n\t};\n\tlang.setObject(\"dijit._editor.html\", exports);\n\n\tvar escape = exports.escapeXml = function(/*String*/ str, /*Boolean?*/ noSingleQuotes){\n\t\t// summary:\n\t\t//\t\tAdds escape sequences for special characters in XML: `&<>\"'`.\n\t\t//\t\tOptionally skips escapes for single quotes.\n\t\tstr = str.replace(/&/gm, \"&amp;\").replace(/</gm, \"&lt;\").replace(/>/gm, \"&gt;\").replace(/\"/gm, \"&quot;\");\n\t\tif(!noSingleQuotes){\n\t\t\tstr = str.replace(/'/gm, \"&#39;\");\n\t\t}\n\t\treturn str; // string\n\t};\n\n\texports.getNodeHtml = function(/*DomNode*/ node){\n\t\t// summary:\n\t\t//\t\tReturn string representing HTML for node and it's children\n\t\tvar output = [];\n\t\texports.getNodeHtmlHelper(node, output);\n\t\treturn output.join(\"\");\n\t};\n\n\texports.getNodeHtmlHelper = function(/*DomNode*/ node, /*String[]*/ output){\n\t\t// summary:\n\t\t//\t\tPushes array of strings into output[] which represent HTML for node and it's children\n\t\tswitch(node.nodeType){\n\t\t\tcase 1: // element node\n\t\t\t\tvar lName = node.nodeName.toLowerCase();\n\t\t\t\tif(!lName || lName.charAt(0) == \"/\"){\n\t\t\t\t\t// IE does some strange things with malformed HTML input, like\n\t\t\t\t\t// treating a close tag </span> without an open tag <span>, as\n\t\t\t\t\t// a new tag with tagName of /span.  Corrupts output HTML, remove\n\t\t\t\t\t// them.  Other browsers don't prefix tags that way, so will\n\t\t\t\t\t// never show up.\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\toutput.push('<', lName);\n\n\t\t\t\t// store the list of attributes and sort it to have the\n\t\t\t\t// attributes appear in the dictionary order\n\t\t\t\tvar attrarray = [], attrhash = {};\n\t\t\t\tvar attr;\n\t\t\t\tif(has(\"dom-attributes-explicit\") || has(\"dom-attributes-specified-flag\")){\n\t\t\t\t\t// IE8+ and all other browsers.\n\t\t\t\t\tvar i = 0;\n\t\t\t\t\twhile((attr = node.attributes[i++])){\n\t\t\t\t\t\t// ignore all attributes starting with _dj which are\n\t\t\t\t\t\t// internal temporary attributes used by the editor\n\t\t\t\t\t\tvar n = attr.name;\n\t\t\t\t\t\tif(n.substr(0, 3) !== '_dj' &&\n\t\t\t\t\t\t\t(!has(\"dom-attributes-specified-flag\") || attr.specified) && !(n in attrhash)){    // workaround repeated attributes bug in IE8 (LinkDialog test)\n\t\t\t\t\t\t\tvar v = attr.value;\n\t\t\t\t\t\t\tif(n == 'src' || n == 'href'){\n\t\t\t\t\t\t\t\tif(node.getAttribute('_djrealurl')){\n\t\t\t\t\t\t\t\t\tv = node.getAttribute('_djrealurl');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(has(\"ie\") === 8 && n === \"style\"){\n\t\t\t\t\t\t\t\tv = v.replace(\"HEIGHT:\", \"height:\").replace(\"WIDTH:\", \"width:\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tattrarray.push([n, v]);\n\t\t\t\t\t\t\tattrhash[n] = v;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t// IE6-7 code path\n\t\t\t\t\tvar clone = /^input$|^img$/i.test(node.nodeName) ? node : node.cloneNode(false);\n\t\t\t\t\tvar s = clone.outerHTML;\n\t\t\t\t\t// Split up and manage the attrs via regexp\n\t\t\t\t\t// similar to prettyPrint attr logic.\n\t\t\t\t\tvar rgxp_attrsMatch = /[\\w-]+=(\"[^\"]*\"|'[^']*'|\\S*)/gi\n\t\t\t\t\tvar attrSplit = s.match(rgxp_attrsMatch);\n\t\t\t\t\ts = s.substr(0, s.indexOf('>'));\n\t\t\t\t\tarray.forEach(attrSplit, function(attr){\n\t\t\t\t\t\tif(attr){\n\t\t\t\t\t\t\tvar idx = attr.indexOf(\"=\");\n\t\t\t\t\t\t\tif(idx > 0){\n\t\t\t\t\t\t\t\tvar key = attr.substring(0, idx);\n\t\t\t\t\t\t\t\tif(key.substr(0, 3) != '_dj'){\n\t\t\t\t\t\t\t\t\tif(key == 'src' || key == 'href'){\n\t\t\t\t\t\t\t\t\t\tif(node.getAttribute('_djrealurl')){\n\t\t\t\t\t\t\t\t\t\t\tattrarray.push([key, node.getAttribute('_djrealurl')]);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar val, match;\n\t\t\t\t\t\t\t\t\tswitch(key){\n\t\t\t\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\t\t\t\tval = node.style.cssText.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t\t\t\t\tval = node.className;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\t\t\t\t\t\tif(lName === \"img\"){\n\t\t\t\t\t\t\t\t\t\t\t\t// This somehow gets lost on IE for IMG tags and the like\n\t\t\t\t\t\t\t\t\t\t\t\t// and we have to find it in outerHTML, known IE oddity.\n\t\t\t\t\t\t\t\t\t\t\t\tmatch = /width=(\\S+)/i.exec(s);\n\t\t\t\t\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = match[1];\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\t\t\t\t\t\tif(lName === \"img\"){\n\t\t\t\t\t\t\t\t\t\t\t\t// This somehow gets lost on IE for IMG tags and the like\n\t\t\t\t\t\t\t\t\t\t\t\t// and we have to find it in outerHTML, known IE oddity.\n\t\t\t\t\t\t\t\t\t\t\t\tmatch = /height=(\\S+)/i.exec(s);\n\t\t\t\t\t\t\t\t\t\t\t\tif(match){\n\t\t\t\t\t\t\t\t\t\t\t\t\tval = match[1];\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\tval = node.getAttribute(key);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(val != null){\n\t\t\t\t\t\t\t\t\t\tattrarray.push([key, val.toString()]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this);\n\t\t\t\t}\n\t\t\t\tattrarray.sort(function(a, b){\n\t\t\t\t\treturn a[0] < b[0] ? -1 : (a[0] == b[0] ? 0 : 1);\n\t\t\t\t});\n\t\t\t\tvar j = 0;\n\t\t\t\twhile((attr = attrarray[j++])){\n\t\t\t\t\toutput.push(' ', attr[0], '=\"',\n\t\t\t\t\t\t(typeof attr[1] === \"string\" ? escape(attr[1], true) : attr[1]), '\"');\n\t\t\t\t}\n\t\t\t\tswitch(lName){\n\t\t\t\t\tcase 'br':\n\t\t\t\t\tcase 'hr':\n\t\t\t\t\tcase 'img':\n\t\t\t\t\tcase 'input':\n\t\t\t\t\tcase 'base':\n\t\t\t\t\tcase 'meta':\n\t\t\t\t\tcase 'area':\n\t\t\t\t\tcase 'basefont':\n\t\t\t\t\t\t// These should all be singly closed\n\t\t\t\t\t\toutput.push(' />');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t// Browsers handle script tags differently in how you get content,\n\t\t\t\t\t\t// but innerHTML always seems to work, so insert its content that way\n\t\t\t\t\t\t// Yes, it's bad to allow script tags in the editor code, but some people\n\t\t\t\t\t\t// seem to want to do it, so we need to at least return them right.\n\t\t\t\t\t\t// other plugins/filters can strip them.\n\t\t\t\t\t\toutput.push('>', node.innerHTML, '</', lName, '>');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\toutput.push('>');\n\t\t\t\t\t\tif(node.hasChildNodes()){\n\t\t\t\t\t\t\texports.getChildrenHtmlHelper(node, output);\n\t\t\t\t\t\t}\n\t\t\t\t\t\toutput.push('</', lName, '>');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 4: // cdata\n\t\t\tcase 3: // text\n\t\t\t\t// FIXME:\n\t\t\t\toutput.push(escape(node.nodeValue, true));\n\t\t\t\tbreak;\n\t\t\tcase 8: // comment\n\t\t\t\t// FIXME:\n\t\t\t\toutput.push('<!--', escape(node.nodeValue, true), '-->');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\toutput.push(\"<!-- Element not recognized - Type: \", node.nodeType, \" Name: \", node.nodeName, \"-->\");\n\t\t}\n\t};\n\n\texports.getChildrenHtml = function(/*DomNode*/ node){\n\t\t// summary:\n\t\t//\t\tReturns the html content of a DomNode's children\n\t\tvar output = [];\n\t\texports.getChildrenHtmlHelper(node, output);\n\t\treturn output.join(\"\");\n\t};\n\n\texports.getChildrenHtmlHelper = function(/*DomNode*/ dom, /*String[]*/ output){\n\t\t// summary:\n\t\t//\t\tPushes the html content of a DomNode's children into out[]\n\n\t\tif(!dom){\n\t\t\treturn;\n\t\t}\n\t\tvar nodes = dom[\"childNodes\"] || dom;\n\n\t\t// IE issue.\n\t\t// If we have an actual node we can check parent relationships on for IE,\n\t\t// We should check, as IE sometimes builds invalid DOMS.  If no parent, we can't check\n\t\t// And should just process it and hope for the best.\n\t\tvar checkParent = !has(\"ie\") || nodes !== dom;\n\n\t\tvar node, i = 0;\n\t\twhile((node = nodes[i++])){\n\t\t\t// IE is broken.  DOMs are supposed to be a tree.  But in the case of malformed HTML, IE generates a graph\n\t\t\t// meaning one node ends up with multiple references (multiple parents).  This is totally wrong and invalid, but\n\t\t\t// such is what it is.  We have to keep track and check for this because otherwise the source output HTML will have dups.\n\t\t\t// No other browser generates a graph.  Leave it to IE to break a fundamental DOM rule.  So, we check the parent if we can\n\t\t\t// If we can't, nothing more we can do other than walk it.\n\t\t\tif(!checkParent || node.parentNode == dom){\n\t\t\t\texports.getNodeHtmlHelper(node, output);\n\t\t\t}\n\t\t}\n\t};\n\n\treturn exports;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/html.js\n// module id = 158\n// module chunks = 3","require(\"dijit/_editor/nls/commands?absMid=dijit/_editor/nls/commands\");\nmodule.exports = require(\"C:/temp/node_modules/dojo-webpack-plugin/loaders/dojo/i18n/runner.js\")(\"dijit/_editor/nls/commands\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../dojo-webpack-plugin/loaders/dojo/i18n!C:/Users/Chuck/git/dijit/_editor/nls/commands.js\n// module id = 159\n// module chunks = 3","define({ root:\n//begin v1.x content\n({\n\t'bold': 'Bold',\n\t'copy': 'Copy',\n\t'cut': 'Cut',\n\t'delete': 'Delete',\n\t'indent': 'Indent',\n\t'insertHorizontalRule': 'Horizontal Rule',\n\t'insertOrderedList': 'Numbered List',\n\t'insertUnorderedList': 'Bullet List',\n\t'italic': 'Italic',\n\t'justifyCenter': 'Align Center',\n\t'justifyFull': 'Justify',\n\t'justifyLeft': 'Align Left',\n\t'justifyRight': 'Align Right',\n\t'outdent': 'Outdent',\n\t'paste': 'Paste',\n\t'redo': 'Redo',\n\t'removeFormat': 'Remove Format',\n\t'selectAll': 'Select All',\n\t'strikethrough': 'Strikethrough',\n\t'subscript': 'Subscript',\n\t'superscript': 'Superscript',\n\t'underline': 'Underline',\n\t'undo': 'Undo',\n\t'unlink': 'Remove Link',\n\t'createLink': 'Create Link',\n\t'toggleDir': 'Toggle Direction',\n\t'insertImage': 'Insert Image',\n\t'insertTable': 'Insert/Edit Table',\n\t'toggleTableBorder': 'Toggle Table Border',\n\t'deleteTable': 'Delete Table',\n\t'tableProp': 'Table Property',\n\t'htmlToggle': 'HTML Source',\n\t'foreColor': 'Foreground Color',\n\t'hiliteColor': 'Background Color',\n\t'plainFormatBlock': 'Paragraph Style',\n\t'formatBlock': 'Paragraph Style',\n\t'fontSize': 'Font Size',\n\t'fontName': 'Font Name',\n\t'tabIndent': 'Tab Indent',\n\t\"fullScreen\": \"Toggle Full Screen\",\n\t\"viewSource\": \"View HTML Source\",\n\t\"print\": \"Print\",\n\t\"newPage\": \"New Page\",\n\t/* Error messages */\n\t'systemShortcut': 'The \"${0}\" action is only available in your browser using a keyboard shortcut. Use ${1}.',\n\t'ctrlKey':'ctrl+${0}',\n\t'appleKey':'\\u2318${0}' // \"command\" or open-apple key on Macintosh\n})\n//end v1.x content\n,\n\"zh\": true,\n\"zh-tw\": true,\n\"uk\": true,\n\"tr\": true,\n\"th\": true,\n\"sv\": true,\n\"sl\": true,\n\"sk\": true,\n\"ru\": true,\n\"ro\": true,\n\"pt\": true,\n\"pt-pt\": true,\n\"pl\": true,\n\"nl\": true,\n\"nb\": true,\n\"ko\": true,\n\"kk\": true,\n\"ja\": true,\n\"it\": true,\n\"id\": true,\n\"hu\": true,\n\"hr\": true,\n\"he\": true,\n\"fr\": true,\n\"fi\": true,\n\"es\": true,\n\"el\": true,\n\"de\": true,\n\"da\": true,\n\"cs\": true,\n\"ca\": true,\n\"bg\": true,\n\"az\": true,\n\"ar\": true\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/Chuck/git/dijit/_editor/nls/commands.js\n// module id = 160\n// module chunks = 3"],"sourceRoot":""}